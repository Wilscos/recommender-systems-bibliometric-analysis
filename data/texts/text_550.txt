Midwives have a profound impact on public health [16, 8, 17]. Most maternal and newborn deaths, and other negative health outcomes, occur in low- and middle-income countries and are preventable through timely management by a skilled health professional [24]. Access to quality midwifery could also improve the long-term health and welfare of mothers and babies [18]. Precision public health [5] seeks to prevent diseases, promote good habits, and reduce health inequalities by leveraging data and emerging technologies to develop personalized interventions and policies [3, 4]. The data can come from mobile devices and includes information about diseases, geographical location, behavior or susceptibility at the individual level. However, this approach had not been applied yet to midwifery. Maternity Foundation [15] aims to empower skilled birth attendants to provide a safer birth for mothers and newborns. To that end, they developed the Safe Delivery App [7], a digital learning tool to enhance the capacity of health practitioners. The App contents are organized into modules that address the main interventions to handle childbirth emergencies, as well as preventative procedures. Modules include videos, action cards, drug lists, practical procedures, and e-learning components. Applying data science to behavioral logs from the Safe Delivery App may help midwives improve their learning competencies [9]. In particular, it could serve to offer each midwife personalized content recommendations, with the ultimate goal of helping them to better assist mothers and new- 35th Conference on Neural Information Processing Systems (NeurIPS 2021), Sydney, Australia. benshi.aibenshi.aiMaternity Foundation ana@benshi.aiafrica@benshi.ailauren@maternity.dk Maternal and child mortality is a public health problem that disproportionately affects low- and middle-income countries. Every day, 800 women and 6,700 newborns die from complications related to pregnancy or childbirth. And for every maternal death, about 20 women suffer serious birth injuries. However, nearly all of these deaths and negative health outcomes are preventable. Midwives are key to revert this situation, and thus it is essential to strengthen their capacities and the quality of their education. This is the aim of the Safe Delivery App, a digital job aid and learning tool to enhance the knowledge, conﬁdence and skills of health practitioners. Here, we use the behavioral logs of the App to implement a recommendation system that presents each midwife with suitable contents to continue gaining expertise. We focus on predicting the click-through rate, the probability that a given user will click on a recommended content. We evaluate four deep learning models and show that all of them produce highly accurate predictions. borns. Recommendation systems have been used in many contexts [1], including healthcare applications [6], where the most typical approaches are collaborative ﬁltering or content-based ﬁltering. Here we explore such a recommendation system, focusing instead on the click-through rate (CTR) prediction, namely on estimating each user’s probability of clicking on a certain App content. Once identiﬁed, the content that each user is more likely to check in the near future can be made more accessible. This should improve the user experience and accelerate the acquisition of critical skills. Our strategy involves predictive modeling to foresee a user’s response to potential recommendations. For a certain content, the CTR is the rate at which a user presented with the opportunity to consume it will do so. We focus on predicting if a user will check some speciﬁc content the next day, a problem to which we can apply advanced CTR prediction models. The main challenges of these models are dealing with high-dimensional, very sparse feature spaces and capturing feature interactions. Next, we brieﬂy present the models compared in this work. Details concerning the implementation can be found in [21]. In all cases, categorical features are one-hot encoded, and features are followed by an embedding layer. The various models differ on the architecture connected to the embedding layer that yields the predicted CTR. They all use some combination of deep neural networks (DNNs, which naturally account for high-order bit-wise feature interactions) and factorization machine (FM) structures (which can efﬁciently learn low-order vector-wise interactions). Product-based neural networks (PNNs) were introduced in [19] as a deep learning approach to CTR prediction that uses product layers to explore feature interactions. A product layer is built through the pair-wise product of the embedding vectors, and then both the single embedded features and their products are used as the inputs to a multilayer perceptron (MLP). A deep factorization machine (DeepFM) [10] is a neural network architecture that integrates FMs [20] and an MLP. Both elements are directly connected to the embedding layer, and their outputs are fed to the ﬁnal output layer that yields the CTR prediction. Thus, the main difference between PNNs and DeepFMs is that the feature vector interaction layer is connected to the DNN in the former, and directly to the output in the latter. An extreme deep factorization machine (xDeepFM) [13] has a similar architecture to that of the DeepFM, but with the FM replaced by a compressed interaction network (CIN), which is an extension of the crossover network [23]. It receives as input a matrix with each row corresponding to the embedding of a feature, and each of its successive layers outputs a matrix representing interactions between the initial input matrix and the previous layer. This allows the model to measure explicitly high-order vector-wise feature interactions in a scalable manner. Each hidden layer is connected to the output, by ﬁrst sum pooling on each layer and then concatenating the pooling vectors. The dual input-aware factorization machine (DIFM) was introduced in [14], building on the success of other FM extensions [12, 25]. All these extensions try to overcome the main limitation of FM-based models, which assign the same weight to a given feature in all possible feature interaction combinations. In the case of DIFMs, the DNN used in [25] is replaced with a dual layer that contains an MLP-type structure to consider bit-wise interactions, and also a transformer-type architecture [22] that deals with vector-wise interactions when learning the input-aware factors used for reweighting. These are followed by combination, reweighing and prediction layers. Figure 1: Drug clicks. Total number of daily clicks by Ethiopia’s (left) and India’s (right) health professionals on 10 selected drugs covered in the Safe Delivery App. The dataset was extracted from the Maternity Foundation’s Safe Delivery App [7] and consisted of user behavioral logs collected between 2019-01-01 and 2021-09-01 (which included 21296 users from India and 1486 from Ethiopia). Each learning module from the App includes videos, organized in different chapters. The App also features a drugs section, which lists the most relevant medications for midwives. Those can be grouped in different drug families, such as antibiotics, analgesics or antihypertensives. Clicking on any medication displays all the information that health workers need to correctly administer and prescribe it. User behavioral logs contain a large amount of implicit feedback information on page views, clicks or sequences of checked items. We propose a personalized recommendation algorithm based on the predicted next-day user clicks on four types of contents: video chapters, drugs, video modules (i.e., the sets of videos belonging to the same module) and drug families. We constructed features related to the user (e.g. connection frequency), the content itself, or both (e.g. the total number of clicks on a certain content), and included external variables such as ‘day’ and ‘month’. Figure 1 depicts real data on the total number of daily clicks for a number of selected drugs. (The corresponding display for video modules is shown in Figures A.1 and A.2.) All historical records prior to 2021-03-01 were considered in the training. The dataset was randomly split into training (80% of the data) and validation (20%) sets for parameter-tuning purposes. To test the model, we used the 2021-03-01 records. The same process could be used in operational settings. Models were trained for 10, 20 or 35 epochs (depending on the dataset), using Adam optimization, the ReLu activation function and a batch size of 256. They consisted of 256, 128 and 64 hidden units in three layers. Additionally, the xDeepFM and DIFM models were trained with a 0.5 dropout rate. The latter used tanh instead of ReLu as the activation function and an attention head size of 32. The models predict the probability that a given user clicks on each speciﬁc content (either an individual drug, a drug family, a module video or one of its chapters). To evaluate model performance, we treated such prediction as a binary classiﬁcation problem and calculated the area under the curve (AUC) [11]. The results are shown in Table 1. Additionally, Table A.1 lists the root-mean-square error (RMSE) across users and contents; see e.g. [2]. This gives an idea of how close to 0 and 1 the predicted CTR probabilities were for negative and positive occurrences, respectively. Table 1: Area under the ROC curve (AUC) for each model (PNN, DeepFM, xDeepFM and DIFM) and each of the recommender targets (drug, drug family, video chapter and video module). The values were calculated using datasets from Ethiopia and India. All models performed very well for all types of content, with AUC values above 0.8 (and above 0.9 almost in all instances) and low RMSE (which in this case also ranges between 0 and 1). As expected, predictions are better for drug families than for individual drugs. However, the difference is not signiﬁcant. This means our models are able to foresee not only the type of health problem that will be encountered, but also the speciﬁc drugs that will be checked, which apparently suggests that midwives always tend to use the drugs they are already familiar with. The smaller training-sample sizes in the Ethiopian case foreseeably translated into less predictive power. However, the results are still very accurate, which leads us to conclude that our models can effectively learn from relatively small samples. The fact that the xDeepFM and DIFM models did not perform signiﬁcantly better than the simpler PNN and DeepFM ones suggests that high-order vector-wise feature interactions are not relevant in this problem for the selected features. The DIFM model produces the best AUC values when forecasting drug clicks, while consistently yielding the worst results (though not by much) for video prediction. This could mean that input-aware reweighting does have some importance in the drug case. However, the DIFM model is always among the worst choices in terms of the RMSE; see Table A.1. On the other hand, the DeepFM and xDeepFM errors are very similar and the lowest ones for all content types. This means they should perform better than the other two models, provided we tune the probability threshold above which we consider there is a predicted positive occurrence. The DeepFM architecture is simpler and can be trained more efﬁciently, and that makes it the preferred candidate to be implemented in an operational setting. This is further supported by Figures A.3 and A.4, which show the RMSE of the individual-drug predictions produced by each model for Ethiopia and India, respectively. These ﬁgures reveal that the error is far from being uniformly distributed, with the largest contributions coming from only a few drugs. They show, too, that there is a group of drugs for which all models present large errors (with the PNN and DIFM models exhibiting additional peaks). We have shown that state-of-the-art CTR prediction models can successfully foretell whether a user will check a certain video or drug content within the next day. Therefore, they can be used to make that content more accessible to the user. This could facilitate midwives’ everyday practice and skill acquisition, ultimately resulting in a better care for the mothers and babies they are assisting. While all tested models yielded highly accurate predictions, our results suggest that the simpler DeepFM architecture would sufﬁce to address this content recommendation problem in a production environment. This seems to indicate that explicitly considering high-order vector-wise feature interactions and feature-aware reweighting has no signiﬁcant effect in this particular problem. On the whole, in terms of overall performance and efﬁciency, the DeepFM model appears like the ideal candidate to be used in production. All the data used in this analysis comes from the Safe Delivery App logs and belongs to Maternity Foundation. For inquiries regarding its use, please contact them at mail@maternity.dk. The authors thank Javier Grande for his careful review of the manuscript.