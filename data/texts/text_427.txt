Zhaoyi Xu, Cong Shi, Tianfang Zhang, Shuping Li, Yichao Yuan, Student Member, IEEE, Chung-Tse Michael Wu, Senior Member, IEEE, Yingying Chen, Fellow, IEEE, Athina Petropulu, Fellow, IEEE Abstract—Vital sign monitoring plays a critical role in tracking the physiological state of people and enabling various health-related applications (e.g., recommending a change of lifestyle, examining the risk of diseases). Traditional approaches rely on hospitalization or body-attached instruments, which are costly and intrusive. Therefore, researchers have been exploring contact-less vital sign monitoring with radio frequency signals in recent years. Early studies with continuous wave radars/WiFi devices work on detecting vital signs of a single individual, but it still remains challenging to simultaneously monitor vital signs of multiple subjects, especially those who locate in proximity. In this paper, we design and implement a time-division multiplexing (TDM) phased-MIMO radar sensing scheme for high-precision vital sign monitoring of multiple people. Our phased-MIMO radar can steer the mmWave beam towards different directions with a micro-second delay, which enables capturing the vital signs of multiple individuals at the same radial distance to the radar. Furthermore, we develop a TDM-MIMO technique to fully utilize all transmitting antenna (TX)-receiving antenna (RX) pairs, thereby signiﬁcantly boosting the signal-to-noise ratio. Based on the designed TDM phased-MIMO radar, we develop a system to automatically localize multiple human subjects and estimate their vital signs. Extensive evaluations show that under two-subject scenarios, our system can achieve an error of less than 1 beat per minute (BPM) and 3 BPM for breathing rate (BR) and heartbeat rate (HR) estimations, respectively, at a subject-to-radar distance of 1.6 m. The minimal subject-to-subject angle separation is 40, corresponding to a close distance of 0.5 m between two subjects, which outperforms the state-of-the-art. Keywords—Contact-less Vital Sign Monitoring, Millimeter Wave, Phased Multiple-Input Multiple-Output Radar. RACKING of the physiological states of people can enable change of lifestyle recommendations from indoor sedentary activities and examine the risk of diseases. Vital signs, including breathing rate (BR) and heartbeat rate (HR), provide crucial insights into the physiological state of the individual. Traditional ways to monitor vital signs usually require hospitalization and involve body-attached instruments (e.g., PPG and ECG sensors), which are intrusive, costly, and require the cooperation of the person being monitored. To overcome these problems, research studies have been exploring contact-less vital sign monitoring via radio frequency (RF) signals [1]–[5]. Early studies have leveraged either continuouswave radar or a WiFi device to transmit RF signals towards a target individual, and then infer the chest movements caused by vital signs through analyzing the echo signals [6], [7]. However, these methods rely on RF signals operating at ﬁxed frequencies, and thus have limited ability to disentangle echo signals from multiple individuals, especially when those individuals are closely located with respect to each other. Such limitation precludes their use in practical scenarios that involve the health monitoring of multiple people. For example, in a classroom or a clinic, under the COVID-19 crisis, tracking the vital signs and health status of multiple people simultaneously in a contactless fashion would be very desirable. Powered by recent advancements in mmWave sensing, research studies have been exploring mmWave radars for vital sign monitoring [8]–[15]. By utilizing frequency-modulated continuous-waveform (FMCW) techniques, a mmWave radar can detect multiple people at different radial distances to the radar device, and further derive vital signs information of each individual. Compared to traditional approaches relying on lowfrequency RF signals, mmWave signals have much shorter wavelength (i.e., millimeter-level wavelength) and thus can enable more ﬁne-grained vital sign monitoring. Two main categories of techniques were explored, namely, analog beamforming based on phased antenna array and multiple-input and multiple-output (MIMO) approaches. The beamforming approach of [8], [11] uses a phased array to successively steer the mmWave beam towards different directions by changing the antenna weights in each slot. This approach enables the detection of people separated in the angle domain, while the allowable minimum angle separation (resolution) is limited by the phased array’s aperture. By processing the echoed signals of each beam separately, the vital signs of the person in each direction can be estimated. Speciﬁcally, Islam et al. [11] deploy analog beamforming on a singlechannel FMCW radar to measure vital signals of two subjects with a minimal 40 degree separation angle. However, this work only reported preliminary BR and HR estimation performance of a single subject (i.e., around 93% HR estimation and 96% BR estimation accuracy), while the multi-subject vital sign estimation precision and interference among subjects were not studied. MIMO approaches for vital sign monitoring [9], [12] transmit mmWave signals using multiple transmitting antenna (TX) - receiving antenna (RX) pairs, in a time-divisionmultiplexing (TDM) fashion, to realize MIMO and improve sensing precision. For example, Dai et al. [12] exploit a MIMO radar with 12 TXs and 16 RXs. In each time slot, only one of the available TX transmits. Over 12 slots, measurements corresponding to 192 TX-RX antenna pairs/channels can be collected and used for high-precision vital sign monitoring with low estimation error. However, the designed method was only evaluated with multiple people at different radial distances to the radar, while the more challenging scenario of multiple people at the same radial distance but different angles, was not studied. All these existing solutions consider either analog beamforming or MIMO techniques, but not both, thus missing the opportunity to fully explore the potential of radar-based mmWave sensing. In this paper, we propose a novel approach for highprecision vital sign monitoring of multiple people. In particular, we integrate MIMO and phased array by using a singlechip automotive mmWave transceiver and develop a phasedMIMO radar sensing scheme. The radar transmits orthogonal signals, each feeding a phase array structure. Orthogonality allows the transmitted signals to be separated at the receiver [16]. The contributions of the multiple waveforms offer independent views of the targets, which can be exploited to improve target estimation. In our work, orthogonality is achieved by time-division multiplexing (TDM) transmission of the same waveform after it has been weighted by different weights in each slot. The received signals over multiple time slots can be combined to obtained high precision target estimation. It is those different transmitted signals that makes our work different than that of [12], resulting in more transmittedreceived signal pairs for more accurate target estimation. Our phased-MIMO radar can steer the mmWave beam towards different directions with a micro-second delay, which enables simultaneously monitoring the vital signs of multiple individuals even when they are at the same radial distance to the radar. The phased-MIMO radar also allows one to construct a virtual array for enhanced angle resolution; this was veriﬁed in our preliminary experiments detecting stationary objects. By combining high angle resolution and high precision target estimation, the proposed system enables the detection of multiple people located close to each other, and also the precise estimation of the BR and HR of each individual. Our approach thus provides a promising solution to track the health status of multiple people in many indoor venues (e.g., classrooms, ofﬁces, and crowded hospital rooms). Based on the proposed radar, we develop a system to automatically localize multiple human subjects and estimate their vital signs. Our system ﬁrst leverages FMCW techniques to obtain the angle of each individual subject to the radar. Then, to separate the vital signs of different people, our system iteratively steers the beam towards each individual subject and obtains a set of mmWave signals. Each set of mmWave signals thus contain vital signals of only one single subject. For each subject, our system computes the phase of the mmWave signals, which encodes both the breathing and heartbeats of the subject. Two band-pass ﬁlters, which use normal human breathing and heartbeat frequency ranges as cut-off frequencies, are employed to separate the two types of vital signs. Our system then detects the BR and HR in the frequency domain by locating the frequency peaks. We implement the designed TDM phased-MIMO radar on an offthe-shelf mmWave device and conduct extensive experiments under various settings (e.g., different distances and angles between the radar and subjects). The results show that our system can provide high accuracy BR and HR estimation under various experimental settings. Phased-MIMO radar is the combination of MIMO radar with phased array, where the radar transmits orthogonal signals, each feeding a phase array structure. Orthogonality allows the transmitted signals to be separated at the receiver. The contributions of the multiple waveforms offer independent views of the targets, which can be exploited to improve target estimation. In our work, orthogonality is achieved by TDM transmission of the same waveform that is weighted by different weights in each slot. First, let us consider a transmitting array where we have N TXs spaced by d, and a receiving array with M RXs spaced by d. The transmitting array is partitioned into P overlapped subarrays where antennas can be shared between subarrays. In each time slot, the subarrays take turns to transmit the same waveform x(t) but using different subarray antenna weights. The weights are chosen so that all transmitted signals add up coherently in a speciﬁc direction, or equivalently, form a beam in a speciﬁc direction. By changing the weights in each slot we effectively create different channels that will provide diversity and improve target estimation. Considering the p-th subarray always contains the p-th TX, which is used as reference to form the beam, the corresponding beamforming weights are w= [se, . . . , 1, . . . , se](1) where α(θ) = d, λ is the wavelength of signal and sis 1 if the l-th antenna belongs to the p-th subarray, otherwise is 0. The signal transmitted by the p-th array towards direction θ can be written as z(t) = awx(t) = ex(t)s,(2) where a= [1, e, . . . , e]is the transmit steering vector. One can see that the transmitted signals from P subarrays are the same as those from a TDM-MIMO radar with the same array, except that each signal is ampliﬁed by the number of antennas in the corresponding subarray. Let us consider an FMCW radar waveform, i.e., where Ais the amplitude, fis the chirp starting frequency, B is the chirp bandwidth, Tis the chirp duration, and Φ(t) is the phase noise from transmitter. Note that the phase noise will be neglected in the following equations since it is slow varying and the propagation delay of mmWave is short. At the radar receiver, after mixing with the conjugate of the transmitted signal, the signal transmitted by the n-th subarray and received by the m-th RX can be written as Fig. 1: (a) DC-offset correction using least square method; (b) Phase drift calibration through interpolation where f=is the beat frequency, Ais the amplitude after beamforming and attenuation, R(t) is the radial range of an object, which is associated and changed with the chest displacements of the target subject, d= (n − 1)dand d= (m − 1)d, respectively. Since the propagation delay is very small, the phase term can be approximated as Φ(t, n, m) =− (d− d). Let the ADC sample interval be Tand the chirp interval T. The beat signal of the k-th ADC sample in the l-t chirp is y[n, m, k, l] = Ae. Provided that the range change due to vital sign is slow (< 2Hz) and the sampling interval is very short, if the target stays at a nominal range R, then the phase term of (5) will be Φ(l, n, m) =2λ[R+ R(lT)] − (d− d)sin(θ)λ and (5) can be expressed as On collecting Nsamples in each chirp, the signal y[n, m, k, l], k = 1, ..., Ncan be viewed as a complex sinusoid with frequency fTand complex amplitude e. Therefore, on applying an N-point Discrete Fourier Transform (DFT) on y[n, m, k, l] along k we see a peak at DFT sample h = NfT, indicating the radial range of the target. The phase of the peak value, equals Φ(l, n, m), which can be used to measure the frequency of chest displacement. In this paper, we will use the real and imaginary parts of the peak corresponding to the target in the l-th chirp, denoted as Y[l] and Y[l]. Our system ﬁrst works in TDM-MIMO mode to detect targeting subjects, leveraging the sparse asymptotic minimum variance (SAMV) algorithm [17], which is a super-resolution angle estimation algorithm. Upon detecting one or more target subjects, our system steers the mmWave beam towards the  Fig. 2: BR and HR estimation by applying frequency analysis on the phase of mmWave signals TABLE I: Chirp Parameters used in this work directions of the detected targets by applying analog beamforming at the Tx side. Our system then utilizes digital beamforming, phased calibration, and frequency analysis techniques as described below to estimate vital signs of the target subjects. To further enhance the directivity of the radar, we leverage digital beamforming (DBF) [18] at the receiver side to make the energy of the echoed mmWave signals focus on the target subject. With the designed TDM phased-MIMO radar, our system fully leverages all TX-RX pairs (i.e., N × M) to realize digital beamforming to improve the signal-to-noise ratio. Note that in our radar design, different sets of TX-RX pairs work in a TDM fashion, with only the TX-RX pairs in a subarray activated at one time. Speciﬁcally, we compute the beamforming weights at angle θ as: where d= (n − 1)dand d= (m − 1)d. With the beamforming weights, we can combine mmWave signals of k-th ADC sample in the l-th chirp from all Tx-Rx pairs as z[k, l] =w(n, m)y[n, m, k, l] Our system then leverages the combined signal z for BR and HR estimation. Upon applying range DFT upon the combined signal, our system detects the radial distance between the target and the radar [19]. In practical environments, the static objects in the environment may interfere with the detection of the target. To Fig. 3: Subframe implementation on AWR2243 (N=1) address this problem, we ﬁrst proﬁle the environmental reﬂections (i.e., outputs of range DFT without subjects), and then subtract the noises to cancel the impacts of the environment. Such a noise cancellation mechanism renders reliable target detection, even the target is far from the radar device. After the noise cancellation, we select the range bin with the highest range DFT output to represent the distance between the target and the radar. Our system then computes the phase of the range DFT outputs for vital sign estimation, which reﬂects the distance variations caused by human chest displacements. Due to the strong coupling effects and interference in the measurement environment, the range DFT outputs usually contain DC offsets, which distort the phase information at the target’s range bin. It is thus necessary to remove the dc offset to derive reliable vital sign information. Given a Tx-Rx pair, i, the phase at a selected range bin h can be formulated as where DCand DCdenote the imaginary and real parts of the complex DC offset, respectively. t denotes the time index, and r(t) shows the range DFT output at the range bin h. The formulation indicates that the DC offset will shift the origin to (DC, DC). To compensate such a shift, we leverage leastsquares algorithm to estimate and cancel (DC, DC) [9]. Existing work [20] found that the human chest displacement can exceed the wavelength of mmWave signals (i.e., < 4mm for 77GHz). Therefore, the phase of the range DFT can be over the range [−π, π], which can lead to false detections of vital signs. To tackle this issue, we utilize differential and cross-multiply algorithm (DACM) to calculate phase. Instead of directly applying arctangent demodulation, DACM converts complex range DFT outputs of l − th chirp into phases leveraging the derivative of arctangent function φ(l) = φ(l − 1) + ∆φ(l), l = 2, 3, . . . , N where Nis the number of frames and ∆φ(l) =Y[l]{Y[l] − Y[l − 1]} − {Y[l] − Y[l − 1]}Y[l]Y[l]+ Y[l]. The DACM algorithm mainly corrects the phase distortions caused by breathing. In contrast, small-scale heartbeat motions are less likely to exceed the range of phase. Fig. 4: Setup for multi-target vital sign monitoring. Signal phase drifts in transmission are mainly caused by the impacts of temperature and humidity variations on the hardware, which make the range of phase ﬂuctuations exceed the normal ranges of human breathing and heartbeat. The phase drifts cannot be removed leveraging DACM, since these drifts can be close to but not exceeding the unwrapping threshold of ±π. Furthermore, the harmonics of breathing [21] (i.e., multiple of breathing frequency range 0.2 − 0.33Hz) can also distort the phase patterns at the heartbeat frequency range (e.g., 0.8 − 2.0Hz). It is thus necessary to remove the impacts of such harmonic for reliable HR estimation. Particularly, we realize phase drift calibration [8] by computing the phase difference ∆φ(l) = φ(l) − φ(l − 1) for each φ(l). If the absolute value of the phase difference exceeds a certain threshold, φ(l) will be replaced by a new value computed by the Lagrange interpolation using previous three phases φ(l − 3), φ(l − 2), φ(l − 1). We apply frequency analysis upon the calibrated phase within a sliding window to estimate BR and HR. Since the periods of human breathing and heartbeat are close to each other, we need to separate the BR and HR for reliable estimations. Particularly, we apply a 4-th order Butterworth bandpass ﬁlter with a cut-off frequency range of 0.8 − 2.0Hz to extract heartbeats, which removes the impacts of human breathing and its harmonics. Similarly, we use a bandpass ﬁlter of 0.1 − 0.5Hz to extract human breaths. Then, our system applies DFT on the extracted breathing signals, with the highest peak of the DFT magnitude as the detected BR. To extract heartbeat, which involves subtler displacement, we ﬁrst calculate phase difference: ∆φ(l) = φ(l) − φ(l − 1), which reveals minor phase changes [22]. Our system then applies DFT upon the phase differences to calculate the HR. Examples of BR and HR estimation results are shown in Fig. 2. As a proof of concept, we implement the proposed TDM phased-MIMO radar on an off-the-shelf Texas Instrument (TI) AWR 2243 mmWave device [23], [24], which transmits and receives FMCW waveforms within 76GHz ∼ 81GHz frequency range. The mmWave device consists of three TXs with the spacing of λ and four RXs with the spacing of λ/2, respectively. An evaluation board TI DCA 1000 [25]is adopted in the streaming mode to acquire raw baseband I/Q Fig. 5: (a),(b) accuracy on single-target BR estimation; (c)(d) corresponding errors. X-axis: subject-to-radar distance. signals down-converted from received signals. It is worth mentioning that when leveraging TXs to realize the analog beamforming, there will be grating lobes pointing to other directions because of the large spacing between TXs, λ > λ/2, which may introduce interference on the multi-target scenario. Nevertheless, RXs are spaced by λ/2 which means there is no grating lobes at the receiver side. By leveraging the DBF at receiver side, we can alleviate the grating lobe problem since the energy is focused to a certain direction. In multiplesubject scenarios, our TDM phased-MIMO radar can changes the beam direction towards two different subjects within one frame periodicity of 50 ms. Each frame is equally divided into four sub frames [26] for multi-target detection, which block diagram is shown in Fig.3. Particularly, the direction 1 can be illuminated using subframe 1 with TX0 as the reference and subframe 2 with TX2 as the reference, while the direction 2 can be illuminated using subframe 3 with TX0 as the reference and subframe 4 with TX2 as the reference. We evaluate the performance of our vital sign monitoring system under single-subject and two-subject scenarios. For both scenarios, we conduct experiments to study the impacts of various factors, including the distance between the radar and the subject and the separation angle between two subjects. Each experiment lasts 2 minutes. We use breathing and heartbeat signals collected with a Neulog NUL236 respiration belt and a Neulog NUL208 Heart Rate sensor as the ground truth. A 60-second sliding window, with a step size of 1 second, is applied upon the breathing and heartbeat signals to obtain the ground-truth BR and HR. We compare the HR and BR estimated with our system based on the same sliding window with the ground truth for error analysis. To quantify the vital sign estimation performance, we use statistical metrics including standard derivation (STD), root-mean-square error (RMSE), and estimation accuracy, which are also exploited in prior work [9]. Speciﬁcally, STD indicates the consistency of the estimations, and a lower STD means higher consistency and better performance. RMSE measures the average errors between the estimations of our system and the ground truth. Besides these two statistical metrics, we use estimation accuracy for evaluation, which is deﬁned as the percentage of the estimation with < 3 bpm errors. Fig. 6: (a),(b) accuracy on single-target HR estimation; (c)(d) corresponding errors. X-axis: subject-to-radar distance. In the scenario of single-target vital sign monitoring, the subject is requested to sit in front of the radar, which is placed 1m, 2m and 4m away from the subject with a direction of 20.1. The estimation accuracy and statistic results of singletarget BR are shown in Fig. 5. For the single-target BR estimation on 1m and 2m, the estimation accuracy for phasedarray can reach 97%. However, under a far radar-to-subject distance of 4m, the accuracy drops to 80% for predictions of < 3bpm errors. In contrast, the phased-MIMO not only maintains high accuracy on BR estimation on 1m (99%) and 2m (100%), but achieve much higher accuracy at 4m, with 100% for predictions of < 3bpm errors. For the statistic results, the STD and RMSE of both phased-array and phasedMIMO will experience a severe increasing when the distance between subjects and radar changes to 4m, which can attribute to the instability of long distance data collection from radar. Compared to phased-array, phased-MIMO has much lower STD and RMSE on all three different distances, demonstrating the superior performance on BR estimation. In Fig. 6, we compare the performance of phased array and proposed phased-MIMO HR estimations. For the phased-array, the accuracies are only 67.9%, 86.3%, and 78.0%, on 1m, 2m, and 4m. In contrast, the system with phased-MIMO has much better HR estimation performance, with over 95% accuracy on three different distances. We note that phased array has the best performance on the setup of 2m, with the STD of 3.63 and RMSE of 3.98. The possible reason of this result is that the Radar Cross-Section is low due to the shorter distance between the subject and radar, and data collection on radar’s side is not stable if the distance is longer. For phased-MIMO, even in longer distance, it still have lower STD and RMSE, which proves the stability and robustness using phase-MIMO to make single-target heartbeat estimation. Multi-target vital signs detection is more challenging, especially when the targets are in the same range bin since FMCW signal only tells the range information [9]. For that case, we propose to use analog and digital beamforming to separate different targets in angle domain. By transmitting beams towards each of the target, we can isolate the targets at the same distance; by DBF, we can further focus the energy Fig. 7: (a)(b) accuracy on multi-target BR estimation; (c)(d) accuracy on multi-target HR estimation; (e)(f) errors for multitarget BR estimation; (g)(h) errors for multi-target HR estimation. X-axis: subject-to-radar distance. The angle separation between subjects is 40. of received signal towards the desired target and thus reduce the interference from other targets. In the ﬁrst multi-target detection experiment, two targets are sitting along the direction of −30and 30with the distance of 1m away from the radar sensor. In this case, the phase angles provided by phase shifters for TX0, TX1 and TX2 are 0, 180and 0, respectively. Due to the large spacing between TXs, the grating lobe issue appears along the direction of −30with the maximum gain of main beam along the direction of 30and vice versa. Fortunately, we can use DBF to address this problem. The statistic result comparison between phased array and phased-MIMO are shown in Fig. 7 when two targets located at different distances with the same angle separation of 60. In Fig. 7(a) and (b), for BR measurement, both the accuracy rates for phased-MIMO and phased array are 100 %. At the distance of 1 m, the STD and RMSE for phased array are 0.14 and 0.2, respectively, while the STD and RMSE for phased-MIMO are 0.06 and 0.15, respectively. At the distance of 1.6 m, the STD and RMSE for phased array are 0.6 and 0.71, respectively, while the STD and RMSE for phased-MIMO are 0.55 and 0.66, respectively. For HR measurement in Fig. 7(c) and (d), the accuracy rates between phased array and phased-MIMO are 40.68 % and 87.29 %, At the distance of 1 m, the STD and RMSE for phased array are 4.2 and 5.83, respectively, while the STD and RMSE for phased-MIMO are 1.48 and 2.99, respectively.At the distance of 1.6 m, the STD and RMSE for phased array are 9.88 and 14.17, respectively, while the STD Fig. 8: (a)(b) accuracy on multi-target BR estimation; (c)(d) accuracy on multi-target HR estimation; (e)(f) errors for multitarget BR estimation; (g)(h) errors for multi-target HR estimation. X-axis: angle between two targets. The radar-to-target distances are all 1.6m. and RMSE for phased-MIMO are 1.31 and 1.53, respectively. When two targets located at the distance of 1.6 m with different angle separations of 40, 45and 60, the performance of phased array and phased-MIMO are summarized in Fig. 8. In Fig. 8(a) and (b), for BR measurement, the accuracy rate for phased array is larger than 82.79 % while the accuracy rate for phased-MIMO is larger than 98.06 % when the angle separation is changed from 40to 60. As shown in Fig. 8 (e) and (f), the STD and RMSE results for phased-MIMO are smaller than those for phased array. Similar results can be seen in Fig. 8(g) and (h). For HR measurement, the accuracy rates for phased-MIMO are larger than those for phased array under different angle separations. We designed a TDM phased-MIMO radar to realize highprecision multi-people vital sign monitoring. The designed radar can successively steer the mmWave beam towards different directions, which enables the separation of vital signals of multiple people at the same range bin and integrates the MIMO technique into our design to boost the SNR. Furthermore, we developed a system to localize multiple target subjects and extract echoed mmWave signals of each individual subject. Our system then computes the phases of the echoed signals and applies a set of calibration and processing techniques for reliable BR and HR estimation. As compared to the phased array, our TDM-phased MIMO can more accurately estimate the BR and the HR of multiple subjects.