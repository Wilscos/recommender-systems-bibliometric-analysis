<title>Evaluating Efﬁcacy of Indoor Non-Pharmaceutical Interventions against COVID-19 Outbreaks with a Coupled Spatial-SIR Agent-Based Simulation Framework.</title> <title>Chathika Gunaratne , Rene Reyes , Erik Hemberg , and Una-May O’Reilly</title> <title>ABSTRACT Introduction</title> <title>arXiv:2108.11025v1  [q-bio.PE]  25 Aug 2021</title> break durations, may restrict certain contacts from occurring while amplifying others, and spatial agent-based models are able to simulate such effects. Modeling these spatial effects provides a more accurate representation of the plausible patterns of prolonged exposures that may occur within a workplace and help in the generation of contact networks that can then be studied on their resilience to disease outbreaks. We demonstrate how spatial agent-based modeling can be used to predetermine contact networks under varying intervention strategies, under constraints speciﬁed by the CDC deﬁnition of a prolonged contact for SARS-CoV-2 transmission . We generated prolonged-contact networks using a spatial-agent based model implemented in AnyLogic, which incorporates room and corridor locations, entrances and exits, arrival schedules, restroom locations, and break areas. We investigate the effects of intervention strategies based on three dimensions, forms of movement restriction, population size, and frequency of leaving designated ofﬁce for breaks. The generated networks were then subjected to an agent-based SIR model to compare the resilience of the simulated intervention strategies against diseases with different transmissibilities. Finally, we used known secondary attack rates for four respiratory diseases, MERS, SARS, COVID-19, and Measles, in order to approximate ﬁnal infection ratios expected for each disease under the simulated intervention strategies. <title>Methodology</title> We coupled two agent-based models to assess operational efﬁcacy of COVID-19 intervention strategies on the STATA building at MIT by assessing resulting risks of infection. First, a data-informed spatial agent-based model was used to simulate individual movement within a ﬂoor of the building under varying intervention constraints, to generate high-risk contact networks. Second, a SIR model was simulated on the resulting high-risk contact networks to obtain ﬁnal infection ratios of the population. Fig. 1. Spatial Agent-Based Model The spatial agent-based model was implemented to mimic the movement of personnel under restrictions imposed by constraints of the varying intervention strategies. The model was implemented with the AnyLogic simulation software, which allowed for accurate representation of physical spaces including ofﬁces, stairwells, and restrooms within the simulated area. The second ﬂoor of the STATA building was used for this purpose, which hosts several CSAIL research ofﬁces and labs, conference rooms, rest areas, two restrooms, utility space, and pantry area. The blueprint image of the building ﬂoor under consideration was loaded into AnyLogic and AnyLogic’s wall construct from the pedestrian library was used to designate areas impassable by agents, forming ofﬁce spaces and rooms. Stairwells and elevators were identiﬁed from the blueprints and targetlines from the pedestrian library were allocated at these points within the model from which agents could enter or exit the ﬂoor. Ofﬁce spaces were demarcated with their real-world identiﬁers and assigned capacities according to the current ofﬁce capacities set by building administration. Agent behavior was controlled using a state machine implemented with components from AnyLogic’s pedestrian library as shown in Fig. 2. Individuals were generated from a pedestrian source, at which they were randomly assigned to an available ofﬁce. We used an approximation of a daily schedule for the ﬂoors as shown in Tab. 1. Individuals began entering the ﬂoor from around 6am at a very low rate, followed by a gradual increase in rate towards 9am, ending with a gradual decrease in rate towards 11am. We assumed that individuals would work a complete 8 hour shift after which they would exit the ﬂoor. This meant that departure times would follow a symmetrical distribution to that of entrance times. The agent would then enter the simulation from a designated stairwell or elevator according to the intervention strategy’s movement restriction as detailed below. Once on the ﬂoor, the agent would move towards its ofﬁce location along the hallways created by the wall objects. Collision detection and path-ﬁnding algorithms were handled by AnyLogic and comfortable walking speed was selected for each individual from a uniform distribution between 0.5 and 1 meters per second. Once at the ofﬁce, individuals remained at a chosen location within the ofﬁce space, unless they were interrupted to take a break at an hourly probability of . There was a 0.5 probability that they would remain on the ﬂoor in designated break locations and a 0.5 probability that they would exit the ﬂoor during this time. Break locations included the restrooms and common areas on the ﬂoor and the time agents would spend at a break location followed a uniform distribution between 5 and 20 minutes. Individuals that exit the ﬂoor during their break would use designated exits and entrances according to the movement restriction in place and the time spent outside was chosen from a triangular distribution of minimum, maximum, and mode of 20, 60, and 30 minutes, respectively. Intervention strategies were decomposed into three dimensions, namely movement restriction, population capacity, hourly break probability. Two movement restrictions were simulated: 1) unrestricted movement, where individuals were able to enter and Figure 2. State machine driving agent behavior within the simulated environment of the spatial agent-based model, implemented using AnyLogic’s Pedestrian library. Table 1. Schedule used for controlling agent entrance to the ﬂoor over time. Each hour, the speciﬁed proportion of the population enters the ﬂoor from the designated entrances and heads to their respective ofﬁce spaces. Agents spend 8 hours within the simulation and then exit for the day, implicitly making the exit schedule symmetrically distributed. exit the ﬂoor from any of the available stairwells and elevators, and 2) one-way movement, where entrance and exits to the ﬂoor were only allowed at separate, designated locations as shown in the map in Fig. 3. Population capacities were controlled using a population multiplier parameter, β , applied to the recommended capacities of each ofﬁce. For each ofﬁce, o, the population capacity, was calculated as = β c , where was the capacity for recommended by the administration. Thus the total population for the simulation was β c , where is the complete collection of ofﬁces. Hourly probability of taking a break, , determined whether agents would leave their ofﬁces for a break as described above and utilize the break locations or exit the ﬂoor temporarily, controlling the rate at which agents may contact one another in the hallways or common areas. was varied in the range [0.25, 2.0] in increments of 0.25 and was varied in the range [0.05, 0.45] in increments of 0.05 , and along with the two forms of movement restriction resulted in 128 separate strategies. Each strategy simulation was replicated 10 time to account for stochasticity. Contacts leading to high infection risk were measured from simulations of the spatial ABM by considering CDC deﬁnition of a prolonged contact between an infected individual and a susceptible individual leading to a high risk of transmission of the SARS-CoV-2 virus . According to CDC guidelines, a prolonged contact occurs when a susceptible individual and infected individual come within 6 feet of one another for over a 15 minute duration with minimal PPE usage. We used this deﬁnition to track agents in our model that came into prolonged contact by recording instances in the spatial ABM simulations when two agents spend 15 minutes or more within 6 feet of one another. These contacts are are edges to construct an undirected prolonged contact network for each simulation. Epidemic Simulation on Prolonged Contact Networks An SIR model was used to simulate the viral spread over the contact networks generated from the spatial ABM. The goal of the SIR model was to assess the infection risk posed by the intervention strategies that produced the contact networks being simulated, when a single infected individual would arrive during a workday. The SIR model was executed as follows on each contact network. We assume a parameter to represent the transmissability of the disease, where equals the proportion of susceptible neighbors of an infected agent that will be infected. Say, that agent state is represented by the function θ : M− > {S, I, R} , where is the set of all agents in the contact network and {S, I, R} are the susceptible, infectious, and recovered states that any agent m ∈ M may exist in. All agents but one were set to a susceptible state ( θ(m ) = S 3 m ∈ M ), except a single agent ∈ M that was chosen at random from the contact network and set to an infectious state ( θ(m ) = I ). A proportion, , of the neighbors of 3 N ⊂ M, |N | = ρ|M| , was then chosen and changed to infectious ( θ(N ) = I ). The infecting agent was then changed to a recovered state ( θ(m ) = R ) and could no longer infect other agents. The process was then repeated for the newly infected agents and continued until no further infected agents remained ( θ(M) = /0 ). Each contact network and conﬁguration, was replicated 10 times to account for stochasticity and heterogeneity in node degree centrality. Figure 3. Example run of the spatial agent-based model with one-way movement restriction enabled. A heatmap depicting agent movement through the simulated ﬂoor is overlayed (lighter colors showing where agents have recently spent more time at). The designated entrance is marked with a yellow plus symbol and the designated exist is marked with an orange diamond symbol. In unrestricted movement, both these locations can be used for both entrance and exit to the space. The ﬁnal infected ratio of the entire population, , was measured from each SIR simulation as the proportion of recovered agents Φ at the end of the simulation: Finally, we use secondary attack rate (SAR) in order to assess the efﬁcacy of the simulated interventions at minimizing for the respiratory diseases, MERS, SARS, COVID-19, and Measles. SAR, also known as secondary infection risk, is an epidemiological measurement of the proportion of susceptible individuals that are infected due to close contact with an infected individual . SAR is especially useful for quantifying household infectivness as it considers contacts that occur among individuals within close conﬁnes, and is applicable to our study, where individuals spend most of their workday in the same shared space. Assuming SAR to be a good approximation of in our model, we use empirically estimated 95% conﬁdence intervals of mean SAR for the four diseases from the literature to deﬁne ranges of as follows, MERS: [0.009, 0.107] SARS [0.048, 0.107] , COVID-19 [0.14, 0.20] , and Measles [0.520, 0.846] . Thus, by running the SIR model with within the respective range for the simulated disease, we are able to provide predicted ﬁnal infection ratios for each disease under the simulated intervention strategies. <title>Results</title> Fig. 4 displays, , the mean of maximum degree centralities of the prolonged-contact networks generated by the spatial ABM for each intervention strategy. has the greatest effect on , with α = 0.45 being sufﬁcient to produce at least one hub, connected to nearly half of the network. There is no change in with movement restriction (Figure 4a and 4b). is seen to have a signiﬁcantly positive correlation with (Spearman rank correlation: = 0.8674 p-value = 0.0 and a signiﬁcant, yet weaker, positive correlation is seen between and (Spearman rank correlation: = 0.08771 p-value = 1.7781 × 10 ). Fig. 5 displays the proportion of agents in each simulation with at least one contact, , against the three dimensions of intervention. Since the total population of each simulation was known, K was calculated as: |M| K = (2) β c Figure 4. Mean maximum centrality, C , of prolonged-contact networks generated under varying α, β , and form of movement restriction. Again, it is seen that α has the strongest effect on K, (Spearman rank correlation: r = 0.8952, p-value = 0.0). When α > 0.1, at least more than half the population was expected to have at least one prolonged contact. had a slight positive correlation with (Spearman rank correlation: r = 0.0989 p-value = 0.0 ) , which diminished at higher values of . Once more, the two forms of movement have restriction have no apparent effect on K. Fig. 6, displays outbreak size as ﬁnal infected ratio, , by and for both forms of movement. Both forms of movement show similar behaviors under varying and . There is a signiﬁcant positive correlation between and (Spearman rank correlation: r = 0.7954 p-value = 0.0 ) and a weaker positive correlation between and (Spearman rank correlation r = 0.1916 p-value = 0.0 ). At the recommended population capacity ( β = 1 ), can be maintained under 0.5 , if α < 0.1 while more than half the population is at risk when α > 0.1 . At α = 0.05 , it is possible to keep the ﬁnal infection ratio below a complete contagion even when double the recommended population capacity is present, i.e. β = 2. Fig. 7 displays the relationship between maximum degree centrality per contact network, , and , for varying and The correlation between and is intensiﬁed with increasing . At high , a non-linear relationship between and can be seen. In other words, for sufﬁciently large population sizes, higher hourly break probability can cause networks with higher maximum centrality, leading to larger networks with highly connected hubs that allow for higher ﬁnal infection ratios. Fig. 8, shows the effects of on under different and conditions. Under varying and , the effect that has on can be separated into thee classes. Class I (blue) where gradually larger ranges of can be expected with higher , but stays generally less than 1; Class II (orange) where there is an initial gradual increase in possible range of with , followed by a bifurcation into an oscillation of period 2, i.e. either very low or higher ranges of > 0.5 ), which eventually transitions into φ ≈ 1 for ρ > 0.5 ; and Class III (green) where the ﬁnal states exist in an oscillation of period 2 for ρ <= 0.5 , at φ > 0.75 and φ ≈ 0, and for ρ > 0.5 only φ > 0.75 is observed. Fig. 9 displays distributions and example networks for all three classes of intervention. The normalized frequency of infection for each node in the example networks, over all simulations, is also shown. It can be seen that Class III networks tend to have hubs that are connected to between 20% to 50% of the network. This number is less for Class II and least for Class I. Furthermore, the example networks show how these hubs in Class III networks are nearly always likely to be infected, which in turn exposes the many nodes they are connected to (nearly half of the network). This effect is less in Class II, while in Class I the hubs have approximately the same (or even less) likelihood of infection in comparisons to other nodes. Finally, we compare the predicted efﬁcacy of Class I, II, and III interventions on by relating to SAR for MERS, SARS, COVID-19, and Measles. Fig. 10 displays the predicted these diseases would have in the simulated environment under the three classes of intervention. The strictest Class I interventions are likely to prevent large outbreaks of MERS, SARS, and COVID-19, yet, Measles being an extremely transmissible disease, can result in moderate outbreaks even under the strictest conditions. Class II interventions are likely to prevent MERS and SARS outbreaks, but are ineffective against Measles, and likely to allow signiﬁcant outbreaks of COVID-19. Class III interventions are likely to allow signiﬁcantly large outbreaks of all four diseases with nearly the entire population at risk of infection. For each disease, Mann Whitney U tests were performed to conﬁrm whether there was a statistically signiﬁcant improvement by having Class I interventions over Class II interventions : Class I φ >= Class II φ ) and Class II interventions over Class III interventions ( : Class II φ >= Class III φ ). The Figure 5. Proportion of agents with at least one prolonged contact K under varying α, β , and form of movement restriction. Table 2. Results from Mann-Whitney U tests for the null hypotheses H : Class I φ >= Class II φ and : Class II φ >= Class III φ. results for the Mann Whitney U tests, shown in tab. 2 show that in all four cases, Class I interventions were likely to have a signiﬁcant reduction in ﬁnal infected ratios over Class II interventions, as did Class II interventions over Class III interventions. <title>Discussion</title> We present a simulation framework that couples a spatial agent-based model with an SIR epidemiological agent-based model to evaluate the relative risk reduction of intervention strategies towards the prevention of outbreaks of contagious respiratory diseases such as COVID-19. The spatial agent-based model, implemented in AnyLogic, used blueprints and building data to provide a high-ﬁdelity representation of the room and hallway allotments of the modeled space, including constraints such as dedicated entrances and exits, restrooms, break areas, and arrival schedules. The spatial agent-based model was run under varying intervention strategies to generate contact networks. These intervention strategies included movement restrictions (one-way vs unrestricted), hourly break probability, and population size (relative to current recommended capacity). The resulting contact networks were in turn for simulations of the SIR model. Additionally, this two-stage modeling approach allowed us to cache the generated contact networks, which could then be used for further analysis through models other than the SIR model we have used in this study. This is especially important as the higher ﬁdelity of the spatial agent-based model demands more computational resources and time. Our experiments providing insights into which intervention strategies are more successful at mitigating outbreaks and why. Firstly, there is no signiﬁcant reduction in risk by enforcing one-way movement (i.e. designating dedicated entrances or exits) over allowing for unrestricted movement. Instead, hourly break probability and population size have signiﬁcant impacts on the risk of an outbreak, with the former having a much stronger effect. We conﬁrm that this is due to the generation of contact networks with highly centralized hubs. The strongest impact on hub formation is seen with when individuals leave for breaks more often, followed by a lower, yet signiﬁcant impact by population size. We identify three classes of interventions based on the possible ﬁnal outbreak sizes (ﬁnal infected ratios) produced by these two parameters, over all possible contagiousness values: Class I interventions with very strict restrictions on the frequency of Figure 6. Final ratio infected by the number of times larger the population is by recommended capacity, by hourly break probability, for one-way and unrestricted movement. leaving for breaks paired with very low population size, Class II interventions with a trade off between high (or low) break frequencies and low (or high) population size, and Class III interventions with both higher break frequencies and population size. We ﬁnd that Class I restrictions lead to a signiﬁcant decrease in outbreak size over Class II restrictions, for MERS, SARS, COVID-19, and Measles. Similarly, Class II restrictions lead to a signiﬁcant decrease in outbreak size over Class III restrictions for all four diseases. Despite this advantage of Class I restrictions, it is important to consider the feasibility and ergonomic costs such recommendations have on personnel. When the hourly likelihood of leaving one’s workstation is 0.05 ≥ α ≤ 0.1 this translates to an overall probability between 0.34 and 0.57 of taking at least one break during the whole 8 hour work day. Although individuals could still take breaks in between work inside their ofﬁce spaces, this can lead to work-induced fatigue and isolation. In contrast, under Class II recommendations 0.25 ≥ α ≤ 0.45 , leading to a probability between 0.90 and 0.99 that individuals leave their ofﬁce space to take at least one 15 minute break within the ﬂoor or .. minutes outside the ﬂoor. However, Class II recommendations with α > 0.35 require a population of β = 0.25 , a quarter of the recommended ofﬁce capacity. In other words, despite the high efﬁcacy of strict, Class I recommendations, a slightly more lenient Class II recommendation might be more feasible by reducing the population present below capacity and allowing individuals a much more generous ﬂexibility of movement outside their designated workstations. This work provides a basis for future simulation studies that may beneﬁt from the two-stage simulation approach presented in this paper. By modularizing the spatial and epidemiological aspects of contagious disease, we allow administrators and operations personnel to evaluate effects of spatial interventions independent of epidemiological model speciﬁcs made by computational epidemiologists. In other words, the spatial agent-based model may be thought of as a contact network generator for epidemiological models. Although, we have considered CDC deﬁnitions of prolonged contacts in this study, minimal duration and distance of prolonged contacts can be treated as parameters to generate the respective contact networks. Extensions to the current spatial model could also include factors such as air-ﬂow and ventilation to produce airborne transmission networks. <title>References</title> 1. Hertzberg, V. S. et al. Behaviors, movements, and transmission of droplet-mediated respiratory diseases during transcontinental airline ﬂights. Proc. Natl. Acad. Sci. 115, 3623–3627 (2018). 2. Jarvis, M. C. Aerosol transmission of sars-cov-2: physical principles and implications. Front. Public Heal. , 813 (2020). 3. Kohanski, M. A., Lo, L. J. & Waring, M. S. Review of indoor aerosol generation, transport, and control in the context of covid-19. In International forum of allergy & rhinology, vol. 10, 1173–1179 (Wiley Online Library, 2020). 4. Smith, S. H. et al. Aerosol persistence in relation to possible transmission of sars-cov-2. Phys. Fluids 32 , 107108 (2020). Figure 7. Density plot of φ by maximal network centrality, C , under varying α and β. 5. Kojaku, S., Hébert-Dufresne, L., Mones, E., Lehmann, S. & Ahn, Y.-Y. The effectiveness of backward contact tracing in networks. Nat. Phys. 17, 652–658 (2021). 6. Bedson, J. et al. A review and agenda for integrated disease models including social and behavioural factors. Nat. Hum. Behav. 1–13 (2021). 7. Cliff, O. M. et al. Investigating spatiotemporal dynamics and synchrony of inﬂuenza epidemics in australia: an agent-based modelling approach. Simul. Model. Pract. Theory 87, 412–431 (2018). 8. Gharakhanlou, N. M. & Hooshangi, N. Spatio-temporal simulation of the novel coronavirus (covid-19) outbreak using the agent-based modeling approach (case study: Urmia, iran). Informatics Medicine Unlocked 20, 100403 (2020). 9. Zhou, S., Zhou, S., Zheng, Z. & Lu, J. Optimizing spatial allocation of covid-19 vaccine by agent-based spatiotemporal simulations. GeoHealth 5, e2021GH000427 (2021). 10. Hackl, J. & Dubernet, T. Epidemic spreading in urban areas using agent-based transportation models. Futur. internet 11, 92 (2019). 11. Hunter, E., Mac Namee, B. & Kelleher, J. D. A taxonomy for agent-based models in human infectious disease epidemiology. J. Artif. Soc. Soc. Simul. 20 (2017). 12. Abdulkareem, S. A., Augustijn, E.-W., Mustafa, Y. T. & Filatova, T. Intelligent judgements over health risks in a spatial agent-based model. Int. journal health geographics 17, 1–19 (2018). 13. Public health guidance for community-related exposure (2021). 14. Leung, N. H. Transmissibility and transmission of respiratory viruses. Nat. Rev. Microbiol. 1–18 (2021). 15. Madewell, Z. J., Yang, Y., Longini, I. M., Halloran, M. E. & Dean, N. E. Household transmission of sars-cov-2: A systematic review and meta-analysis. JAMA network open 3, e2031756–e2031756 (2020). <title>Author contributions statement</title> All authors assisted with data acquisition, and conceiving experiments, CG and RR conducted experiments, CG analyzed the results, and all authors reviewed the manuscript. <title>Additional information</title> Competing interests The authors declare no competing interests. Figure 8. The effect of ρ on φ under different α and β . Three classes of behavior can be seen. Figure 9. Maximum centrality distributions of contact networks for each intervention class, along with sample networks from all three classes. Colors of each node in the sample networks depict the normalized frequency of infection per node over 10 SIR simulation on the example network (darker colors represent higher risk). Figure 10. Effectiveness of Class I, II, and III strategies on outbreak size measured as ﬁnal infected ratio, φ, for different contagious respiratory diseases compared by secondary attack rate.