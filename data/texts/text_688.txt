ADAPTIVE MESH METHODS ON COMPACT MANIFOLDS VIA sciences. Classical methods consist of positive scalar image functions composed from the right by transformations [33]. That is, given a source probability density function f compute f pings. Furthermore, this formulation is not appropriate for moving mesh methods. Non-classical methods, like Optimal Transport and Optimal Information Transport, allow the transformation to act as a pushforward or pullback on the density, that is f has particular beneﬁt in that it allows for proving the existence of a diﬀeomorphic mapping over a much wider range of densities f that this is the formulation of diﬀeomorphic density matching that is appropriate for moving mesh methods, since it allows one to change the local density of mesh points. The diﬀeomorphic density matching problem has a long history in the imaging = |DT |f◦ T or |DT |f◦ T = f, respectively. This generalization in medical image registration see, for example, [13, 14, 7, 28], random sampling from a probability measure see, for example, [2, 25] and adaptive moving mesh methods, for example, in meteorology see the line of work in [3, 32, 4], among other applications. These applications are necessarily more challenging from a theoretical perspective as well as a computational perspective when the geometry is non-Euclidean. In this manuscript, we perform the ﬁrst comparison of Optimal Transport versus Optimal Information Transport for the moving mesh problem in the non-Euclidean case. study in which much progress on the theoretical side has been made recently, see the following for examples of this large line of work [23, 19, 20, 9, 30, 21]. Recently, the authors in [15, 16] introduced a numerical convergence framework and convergent numerical scheme for the PDE formulation of the optimal transport problem on the sphere which included, as one application, the traditional squared geodesic cost c(x, y) = solutions u of the PDE formulation are known to be a priori smooth (that is, at least the numerical schemes were consistent, stable in the average value, and monotone and achieved compactness via a Lipschitz constraint imposed on the PDE level. Preliminary results in [16] showed the success of using Optimal Transport on the sphere for moving mesh methods. In this manuscript, we demonstrate the results in cases where the provably convergent numerical scheme for Optimal Transport on the sphere in [16] is successful and unsuccessful for applications. both exact and inexact diﬀeomorphic density matching based on a principal ﬁber bundle structure and the particularly nice way that horizontal geodesics in an information metric are pulled down to geodesics with respect to the Fisher-Rao metric. This allows for the exact diﬀeomorphic map between two smooth densities to be computed via solving a Poisson equation. Limitations to this approach are addressed as well, such as its apparent inappropriateness for image interpolation problems, by introducing computations with a non-compatible metric (which allows for the source density to vanish) [1] in Euclidean space. Optimal Information Transport methods have subsequently found applications in image registration for medical applications, for example in [7, 28] and also random sampling [2], also in subsets of Euclidean space. In this manuscript, we use a provably convergent scheme for the Optimal Information Transport problem on the sphere and show its success for the moving mesh problem in challenging cases. convergence rate guarantees) for computing the Optimal Information Transport on smooth, compact, and connected 2D manifolds M . We then provide, for the ﬁrst time, a comparison of the adaptive mesh methods on these manifolds via Optimal Transport and Optimal Information Transport. In Section 1 we introduce the applied problem of adaptive moving mesh methods. These have speciﬁc applications in the context of meteorology for the spherical geometry, but have applications also in medical image registration and computer graphics beyond the case of the sphere. In Section 2 we review brieﬂy the problem of Optimal Transport on the sphere (and beyond) and highlight the regularity issues that arise which complicate Non-classical diﬀeomorphic density matching has found widespread applications Optimal Transport density matching in non-Euclidean geometries is a ﬁeld of d(x, y). The convergence framework addressed situations where the ) as well as nonsmooth (but still C). This convergence framework required that Optimal Information Transport was developed in the papers [1, 24], which treat In this manuscript, we establish a class of provably convergent methods (with the numerical convergence guarantees. In Section 3 we outline how the Optimal Information Transport PDE is derived.s In Section 4, we show the grid setup and how consistent, monotone, and stable discrete operators are constructed for the PDE in Optimal Transport and Optimal Information Transport on the sphere. In Section 5 we show computations for both problems on the sphere, highlighting the success of both in some cases and the failure of the Optimal Transport discretization in more challenging examples. feldt for fruitful discussions and for encouraging me to write this manuscript on my own. type of adaptive mesh method that has found special usage in computational PDE techniques. The resulting computed mesh is then often used in high-resolution PDE computations, such as the Eady problem, which is a 2D vertical cross-section of an incompressible Bousinnesq ﬂuid, which was treated in [3]. Fixing the number of grid points leads to simpler data structures (than some other adaptive mesh techniques) in the PDE solving step, as was stressed in the manuscripts [3, 32, 6]. target domain Ω domain Ω space). In non-Euclidean geometries, one would like to use any simple oﬀ-theshelf mesh generator for the computational mesh. Then, one would like to ﬁnd a diﬀeomorphic mapping T : Ω of grid points in the physical domain Ω scales involved in the solution of a ﬂuid mechanics PDE. For example, in an evolving front or shock, it is desirable for the density of points in Ω the relatively unchanging parts of the solution, as in meteorological applications where it is desirable to have high resolution in areas of high precipitation [32]. This process could be done iteratively to get a very accurate solution of the PDE, by solving the shock on more and more resolved grids as one iterates. The way this is done is by feeding the information from the PDE (desired density) into a scalar monitor function M(y, t) > 0 and then solving the change of variables formula: where J is the Jacobian of the diﬀeomorphic mapping T and Moving mesh methods require that the mapping be a diﬀeomorphism, which means that the Jacobian of the mapping T satisﬁes 0 < J(T ) < ∞ in the strong sense. This condition will prevent the mesh from tangling. An example of a monitor function constructed from information from a function f(y, t) is the scaled arclength function: where S is a normalization factor, see [3]. Acknowledgement: I would like to express my gratitude to Brittany Froese Ham- For this manuscript, our major application will be moving mesh methods, a In the Euclidean setup, the moving mesh problem setup requires the “physical” tration and sampling techniques, which require computing diﬀeomorphic mapping between possibly very diﬀerent density functions. Thus, we need to solve the problem with a broad variety of applications in mind. equation, which is the change of variables. The existence of any such map is quite general, see [31]. Theorem 1 (Jacobian). Let M be an n-dimensional Riemannian manifold. Let function such that T assume that µ distributional derivative of the mapping DT is a locally integrable function (this can be relaxed slightly). Then, µ where J is the Jacobian determinant of T at x, deﬁned weakly by: butional solution of the monitor equation (1), it does not state that such a mapping T is unique or when it is diﬀeomorphic. It does show that, however, for the same source and target mass distributions, there can be multiple solutions T . What we will ﬁnd is that under fairly general assumptions on the source and target masses, we can ﬁnd diﬀeomorphic mappings using the techniques of Optimal Transport and Optimal Information Transport, which both satisfy the Jacobian equation and give us diﬀeomorphic mappings, appropriate for our moving mesh methods. the map T minimize the following integral: that is: T (x) = ∇ the underlying manifold is R (see the summary in [29]) shows us that if f timal Transport problem with squared geodesic cost is given by T (x) = exp (as long as the manifold is geodesically complete), see [23], where u is as a c-convex function, a technical deﬁnition that is common in the Optimal Transport literature, see [19] for a discussion of this condition and more about the general case of manifolds. For the n-sphere, fairly general conditions on the source and target masses are given in [20], which show that mass transports to a distance bounded strictly below the injectivity radius and gives us diﬀerentiability. Like the case of R Applications of adaptive mesh techniques are also found in medical image regis- The diﬀeomorphic density matching problem can be solved via the Jacobian and µbe two probability measures on M, and let T : M → M be a measurable vol(dx), where V is continuous and vol is the volume measure on M . Further While the above theorem 1 stipulates the conditions for which we have a distri- The mapping arising from Optimal Transport is elected by further requiring that It can be shown that such a mapping is the gradient of a convex function u, < ∞, then we are guaranteed that the mapping is, in fact, a diﬀeomorphism. In the more general manifold setting, we have that the mapping solving the Opalso need 0 < f Transport problem will be shown in 2. The more general manifold case fails quite spectacularly in terms of diﬀerentiability, see the result in [9] for a simple example where diﬀerentiability fails to hold. ping for moving mesh methods as a change of variables between two probability measures. We will provide much more detail on the Optimal Information Transport problem in Section 3, but we summarize the relevant details here. In this case, given a geodesic (in the space of probability measures endowed with the inﬁnitedimensional Fisher-Rao metric) between smooth source and target probability measures bounded away from zero, there exists a unique path T where Diﬀ(M ) denotes the space of diﬀeomorphisms over a manifold M . The key here is the manifold M can be any compact, connected and complete manifold. the corresponding result for Optimal Transport. In the case of the latter, (in the space of probability measures endowed with the Wasserstein metric) between smooth source and target probability measures bounded away from zero, there exists a unique path T M = R by the results in Figalli, et al [9], this does not hold. Optimal Information Transport to be versatile and useful in R these cases, Optimal Information Transport is preferable. compact, connected manifolds M without boundary. Optimal Transport allows for a wide variety of cost functions to be chosen. In fact, the convergence framework in [15] allows for a range of important cost functions. However, in this manuscript we will focus on the squared geodesic cost, that is c(x, y) = source and target probability densities µ have density functions f ferential equation given some additional assumptions. The squared geodesic cost function satisﬁes the following hypotheses 1, which are derived from the hypotheses given in [22]: Hypothesis 1 (Conditions on cost function). The squared geodesic cost function c(x, y) = Optimal Information Transport provides another option for computing a map- The result for Optimal Information Transport is geometrically more general than . For some compact, connected and complete manifolds, again, as shown For the moving mesh problem, then, we expect both Optimal Transport and In this section, we consider the Monge problem of Optimal Transport on smooth (x) = f(y)dvol(y), ﬁnd a mapping T : M → M such that Tµ= µ, that is is the pushforward measure of µvia the mapping T such that: The Monge problem of Optimal Transport can be formulated as a partial difd(x, y) satisﬁes the following conditions: (a) The function ∇c(x, y) is Lipschitz for all x, y ∈ M and invertible in y (b) For any x, y ∈ M, we have det Dc(x, y) 6= 0 determined from the condition (7) where T problem is then given by the fully nonlinear partial diﬀerential equation where subject to the c-convexity condition, which requires Here and the PDE now describes a nonlinear relationship between the surface gradient and Hessian on the manifold. For the case of the sphere, we have the simple formula derived in [16] 2.1. Regularity. We consider the optimal transport problem (8) under the following hypothesis. Hypothesis 2 (Conditions on data (smooth)). We require problem data to satisfy the following conditions: Theorem 3 (Regularity). The optimal transport problem (8) with data satisfying Hypothesis 2 has a classical solution u ∈ C sometimes we will ﬁx a point x At other times, it may be more convenient to choose the mean-zero solution, that is to impose the constraint As ﬁrst shown in [23], the optimal map corresponding to this cost function is denotes the tangent plane at x. The solution to the optimal transport (a) There exists some m > 0 such that f(x) ≥ m for all x ∈ S.RR (b) The mass balance condition holds,f(x) dx =f(y) dy. (d) The data satisﬁes the regularity requirements f, f∈ C(S). (f) The geometry is the n-sphere S We thus get the following regularity result, from Loeper [20] The solution to (8) is unique only up to additive constants. In this manuscript, 2.2. Beyond the Sphere. In some cases, manifolds M with non-positive costsectional curvature at any point x ∈ M can have positive measures µ Ma, Trudinger, Wang tensor [22, 19]: The cost-sectional curvature is negative at a point (x, y) if there exist ξ, ν such that G looks at the squared geodesic cost c(x, y) = non-positivity of the cost-sectional curvature is equivalent to the negativity of the sectional curvature of M at any point x ∈ M due to the equality: (15) the Ma, Trudinger, Wang tensor G (x, y) s.t x 6= y. This was shown true even for some ellipsoids of revolution in the paper [9]. This suggests that computing Optimal Transport for such cases is more diﬃcult and is not guaranteed to result in a diﬀeomorphic mapping T . space of probability distributions and the mappings between probability measures. We have seen in section 2 that for the squared geodesic cost c(x, y) = there exists a unique mapping T of the Monge problem which is then used in computing the total cost of transporting the probability measure µ for the squared geodesic cost, this total cost deﬁnes a Riemannian distance between probability measures, see [29, 31], usually referred to as the Wasserstein distance. Furthermore, a Wasserstein interpolation between the source mass µ get mass µ of the identity map and the Optimal Transport map from µ deﬁning the path of maps T (t) = (1 − t)Id + tT we can construct an interpolation of measures µ(t) = T (t) applications is the Fisher-Rao distance. This distance is deﬁned as the Riemannian distance arising from the Fisher-Rao metric on the space of probability measures. The Fisher-Rao metric, in turn, is the Hessian of the Kullback-Liebler divergence between the probability measures µ and ν, that is the quantity which measures the relative entropy between one probability measure µ and another ν. Here, the Fisher-Rao metric is the inﬁnite-dimensional version, ﬁrst studied in [10]. Typically in statistics it is given in the ﬁnite-dimensional setting where the probability measures can be parametrized by a ﬁnite parameter space which is a subset of k-dimensional Euclidean space R (M), but T is not even guaranteed to be continuous [19]. We introduce the (x, y)(ξ, ν) = D[(x, p) 7→ −c (x, T(p))] | (x, y)(ξ, ν) < C|ξ||ν|. The idea is more perhaps transparent if one G(x, x)(ν, ξ)=2· sectional curvature of M at x in the plane (ξ, ν) |ξ||ν|− (ξ ·ν)3 But even if the underlying manifold has strictly positive curvature everywhere, The Monge problem of Optimal Transport hints at a deeper relation between the A diﬀerent distance between probability measures arising primarily in statistical metric, one may ask the question if there is a mapping T which characterizes the Fisher-Rao distance in the same way that the Optimal Transport mapping T characterizes the Wasserstein distance and interpolation. The short answer is yes, and one can derive it by analyzing the geometric connection between the space of diﬀeomorphisms Diﬀ(M) and the space of positive smooth probability measures (volume forms) Dens(M) on the underlying manifold M. That is, one can deﬁne a projection map π : Diﬀ(M) → Dens(M) providing a principle bundle structure, introduced by Moser [26]. This structure is then analyzed to show that, sure enough, a unique Optimal Information Transport map T can be associated with the FisherRao distance between µ and a simple system of PDE that can solved for T . and more detail presented in [1, 24]. Here we present a brief summary of the derivation of the Optimal Information Transport PDE presented in the manuscript [1]. For all the discussion in this section, we will assume that the underlying manifold M is compact and connected and is equipped with the standard volume form vol. We introduce the Fr´echet Manifold of smooth volume forms over M with total volume vol(M): where the notation Ω induced by the Sobolev seminorms. The inﬁnite-dimensional Fisher-Rao metric: is weak in the Fr´echet topology, but the geodesics have explicit formulas! Furthermore, there is an explicit formula for the distance which is simply given by an integral: on M is denoted Diﬀ(M ) with topology induced by the Sobolev seminorms. We have assumed M compact, which makes the set Diﬀ(M) is a Fr´echet Lie group under the composition of maps. The Lie algebra of Diﬀ(M) is given by the space X(M) of smooth vector ﬁelds. We equip this manifold with the information metric on Diﬀ(M ), deﬁned by: where λ > 0, u = U ◦ϕ ∆ is the Laplace-de Rham operator on the space of vector ﬁelds, deﬁned by ∆u = Given the space of probability measures then equipped with the Fisher-Rao For more information about Optimal Information Transport, see the background We introduce another manifold with rich structure. The set of diﬀeomorphisms δdu+ dδu, where ] and [ are the usual musical isomorphisms, d : Ω(M) → (M) is the exterior diﬀerential and δ : Ω(M) → Ω(M) is the codiﬀerential, and {ξ vector ﬁelds ξ for which ∆ξ = 0. This metric (20) is also weak in the Fr´echet topology, but its geodesics are well-posed. the pullback ϕ isotropy group: morphism ϕ such that ϕ isomorphic to the space of right cosets Diﬀ(M)/Diﬀ µ ∈ Diﬀ(M) parametrizes a partition of the space of densities. Furthermore, by deﬁning the projection map: we can deﬁne the following principal bundle structure: using (18) and (20). The upshot is that although π is a submersion it is actually also a Riemannian submersion with respect to G descends to G Descending metrics “descend” horizontal geodesics, that is if ϕ(t) is a horizontal geodesic curve in Diﬀ(M), then µ(t) := π(ϕ(t)) is a geodesic curve in Dens(M). µ(t), we desire to ﬁnd the horizontal path of diﬀeomorphisms ϕ(t) which project onto µ(t), that are also of minimal length with respect to G exact density matching problem, that is ﬁnd a ϕ(t) such that: }is an orthonormal basis of the harmonic vector ﬁelds on M , that is those Now, the diﬀeomorphic maps deﬁne a group action on the space of densities, via This group action is transitive, that is, given µ and ν, there exists a diﬀeo- The goal is now to give a Riemannian structure to the principal ﬁber bundle The problem of diﬀeomorphic density matching is that given a path of densities From now on, we assume that vol = µ, i.e. µis the canonical volume form. by writing v = gradf + w. It turns out that the Hodge-Helmholtz composition is orthogonal with respect to the information metric G is minimal for w = 0. Therefore, we must solve the following Poisson equation for the curl-free term f: (30) where ϕ the diﬀeomorphic mapping T , is then given by T = ϕ Equation (27). We also have a solution for the inexact problem, where the object is to ﬁnd ϕ that minimizes: where and the ﬁrst term in (32) is a regularity term and the second term penalizes ϕ if the pushforward of µ then let s = M. The convergence framework and schemes we describe here are inspired by a numerical scheme recently designed by the authors for the 2-sphere, which is equipped with a proof of convergence to the physically meaningful solution of the Optimal Transport problem, see [15, 16] for details and analysis. The adaptation From here we perform the Hodge-Helmholz decomposition for the vector ﬁeld v, As noted before, the geodesics for the Fisher-Rao metric have explicit forms! (M) by µ 7→, then the geodesics are given by: = W (µ). The Optimal Information Transport problem is then given by µdenotes the pushforward of µ. The solution of this problem (30), ¯d denotes the distance function on Dens(M) with Riemannian metric¯G. Thus, We assume that we are on a compact, connected two-dimensional Cmanifold of the convergence framework from the sphere to M requires little modiﬁcation provided that the solution to the elliptic PDE in question is merely a priori know to be at least Lipschitz. We note that, of course, there exist other numerical schemes for computing the Poisson solver on the sphere or on compact, connected, complete manifolds M. We are presenting our provably convergent schemes to compare the results of applying Optimal Transport and Optimal Information Transport to problems on the sphere, the results of which will be shown in 5. compactness from Lipschitz stability. We will have in mind that we are using ﬁnitediﬀerence schemes, but actually the convergence framework is more general than this. For the sphere, in the manuscript [16] ﬁnite-diﬀerence schemes were, in fact, constructed which satisﬁed the hypotheses of the convergence framework. We have in mind that, similarly, ﬁnite-diﬀerence schemes can be constructed which satisfy the hypotheses for more general manifolds M , but defer the explicit construction of such schemes to later work. The properties of consistency, monotonicity, and Lipschitz stability are suﬃcient to guarantee convergence in nonsmooth cases and can be used to build explicit convergence rates, an avenue of research that is being pursued in a more general case (for the Optimal Transport PDE) in another manuscript by the author. 4.1. Modiﬁcation of PDE. The Optimal Transport problem involves solving a fully nonlinear elliptic PDE. The Optimal Information Transport problem involves solving a Poisson equation. Due to the fact that we are solving on a compact manifold, the convergence framework we present here hinges ﬁrst on the reformulation of each PDE to include some control on its Lipschitz constant. Given the underlying elliptic PDE that we wish to solve (such as a Monge-Amp´ere-type PDE for the Optimal Transport problem or a Poisson PDE for the Optimal Information Transport problem) denoted by we instead discretize the following modiﬁed PDE: where R is chosen to be strictly greater than the a priori Lipschitz bound. After discretization, the Lipschitz bound imparts suﬃcient stability on the solution to prove overall uniform convergence of the discrete solution u u, provided that we have constructed a consistent, monotone scheme. The equivalence of the solution of (34) to (33) for the Optimal Transport case was presented in the manuscript [15]. Here we present the argument for the Poisson equation. pactness arguments are very clean. The arguments for uniform convergence for elliptic PDE also are more naturally extended to weaker cases using the notion of viscosity solutions. Deﬁnition 4 (Continuous Viscosity Solutions). An upper (lower) semicontinuous function u : M → R is a viscosity sub-(super)- solution of the PDE (33) if for every The discretizations presented here must be consistent and monotone. We also get First, we introduce the notion of a continuous viscosity solution, since the comwe have: A continuous function u : M → R is a viscosity solution of (33) if it is both a suband super-solution. port PDE, as deﬁned in [15]. Note also that, critically, the condition (35) can hold vacuously. We modify the Poisson equation by deﬁning the operator The function f(x) satisﬁes the compatibility condition: state the equivalence theorem that shows that adding a term to the modiﬁed Poisson equation (36) does not change the solution. The proof of this theorem is given in Appendix A. Theorem 2. For any sequence  Lipschitz viscosity solution w where f(x) satisﬁes solution u of the Poisson equation: timal Transport problem. 4.2. Grid, Computational Neighborhoods, & Discrete Derivatives. Now, we describe the grid and discretization on the manifold M . We start with a ﬁnite set of N grid points G ⊂ M that lie on the manifold. We let d usual geodesic distance between points x, y on the manifold M . To the grid G, we associate a number h which serves as a parameter indicating the overall spacing of grid points. More precisely, In particular, this guarantees that any ball of radius h on the sphere will contain at least one discretization point. The grid must suﬃciently resolve the manifold and satisfy some technical regularity requirements which are not diﬃcult in practice to achieve, as detailed in [15]. These regularity requirements ensure that the grid is more or less isotropic with respect to direction. Now we seek an approximation of the form diﬀerence scheme in the case of the sphere S compact surfaces M to future work. We now consider a ﬁxed grid point x and a grid function u : G → R. To perform the computation at x ∈ M and φ ∈ C(M) such that u − φ has a local maximum (minimum) at x The notion of test functions is slightly diﬀerent in the case of the Optimal Trans- This now allows us to instead discretize the PDE (36) and likewise for the Op- At this point, we will begin to more explicitly state the construction of the ﬁniteprojecting grid points close to x the set of relevant neighboring discretization points In order to minimize the consistency error of the overall scheme, the choice of the radius of the neighborhood is derivatives to eventually resolve every direction in the computational neighborhood. coordinates, which are chosen to preserve the distance from x manifold necessarily introduces to second-order derivatives. This allows for monotone approximation schemes to be more easily constructed. Beyond the case of the sphere, it is necessary to merely have a consistent approximation for local geodesic coordinates, since explicit formulas for geodesic normal coordinates do not exist in general. Hessian matrices. In order to compute the gradient, for example, we need to search various directions ν in the neighborhood. Therefore, we will consider the following ﬁnite set of possible directions, where the angular resolution dθ = select four grid points x the directional derivatives in this direction. To accomplish this, we let ν unit vector orthogonal to ν and represent points in x ∈ Z(x coordinates (r, θ) centred at x Then we select four points, each in a diﬀerent quadrant (Q aligned with the direction of ν and approximately symmetric about the axis ν via where cos θ ≥ 0 for points in Q Figure 1. ond directional derivatives for the usual coordinate directions (1, 0) and (0, 1)) of the form The projection onto local tangent planes is accomplished using geodesic normal − Proj(x; x)k). This prevents any distortions that a non-zero curvature of a The Optimal Transport PDE requires computing gradients and eigenvalues of In order to build approximations for derivatives in each direction ν ∈ V , we will From here, we construct approximations of ﬁrst directional derivatives (and secschemes for computing Optimal Transport and Optimal Information Transport. It can be built from approximations of second-order directional derivatives. Because the Laplacian is the trace of the Hessian, we take a geodesic normal coordinate system (x is to add or subtract a Laplacian regularizing term in order to build monotonicity into the discretization, more details of which can be found in [16]. 4.3. Discretization of Optimal Transport and Optimal Information Transport PDE. The full discretization for the discrete operator F Transport problem on the sphere is: (46) F where g on the sphere is: Figure 1. The computational points are chosen so as to ensure that they are within 2dθ of the axis of computation, but also stay at least dθ away from the axis to ensure monotonicity of the scheme After performing a Taylor expansion of the sums in (44) we get explicit values for and b, which can be found in [16, 17]. The discrete Laplacian is used in both our )and deﬁne: In the case where the underlying PDE contains functions of the gradient, the goal (p; ν) = −Dc(x, y)|and g(p; ν) =and g∇u(x)= And the full discretization for the discrete operator Fsolving a Poisson equation where  discretization of the Lipschitz constraint is: and we deﬁne: using a parabolic scheme presented in Algorithm 1: Algorithm 1 Computing the solution to elliptic PDE F [u] = 0 solve the linear system (47) via standard linear algebra techniques. Remark 5. The discretization (49) in principal involves verifying that the solution satisﬁes required Lipschitz bounds, then if necessary solving a second discrete problem to enforce the Lipschitz condition. However, we do not see the veriﬁcation step fail in practice, and hence never actually need to solve using the full operator 4.4. Uniform Convergence Framework for the Poisson Equation for Compact Surfaces without Boundary. The key properties in the discretization of the elliptic PDE without boundary for both the Optimal Transport and Optimal Information Transport PDE are consistency, monotonicity, and Lipschitz stability. Now, we show that with these properties we can derive a uniform convergence result for the Poisson equation on a compact 2D manifold without boundary. We use the auxiliary numerical scheme to prove boundedness: Choose the solution u(x) such that u(x by eﬀecting the choice u Lemma 6 (Boundedness of Solution to Auxiliary Numerical Scheme). The solution Proof. The discretization comparison principle, from the results in [27]. Then, we plug in v and apply the discrete comparison principle. The uniform bound follows from an → 0 is chosen to be the consistency error of the operator ∆. The Then, the procedure for solving the discrete Optimal Transport PDE (46) is by In the case of the Poisson equation when the Lipschitz constraint is inactive, we , but instead simply use the operator F. Let the formal consistency error of the scheme be O(h). Fix a point x∈ M . is bounded if β ≤ α. identical argument for both the smooth and nonsmooth cases as shown in [15] for to choose β = α. We assume this choice from now on. We also assume that we can talk about u the interpolation to the manifold M. PDE (36) being the same as the solution of the Poisson equation. This was shown in 4, while a similar result for the Optimal Transport PDE is in the paper [15]. Thus, we have: Theorem 3 (Uniform Convergence in Nonsmooth Cases). Assuming that we have a consistent and monotone discretization of ∆ discretization, then the solution u solution u of the Poisson equation on the manifold M where u(x Proof. Techniques are identical to those used in [15]. Uniform convergence can be proved for nonsmooth cases (C Remark 7. The compactness arguments given in this section naturally do not lead to explicit convergence rates. However, forthcoming work will establish the guaranteed convergence rate Poisson equation. 4.5. Algorithm for Optimal Information Transport. In order to solve the Optimal Information Transport problem on M, we must solve the system of equations (27). First, we must perform some pre-computations involving the geometry and the mass densities. Then, we iterate an Euler scheme where each step involves one iteration of a Poisson solver. Here are the steps to compute the approximation to the diﬀeomorphic mapping ϕ(1). The forward map at a time step n will be denoted by T by S manifolds require some ﬁne-tuning, introduced in 5. The algorithm requires two important functions: Proj a projection map consistent with the exponential map and Interp, a consistent interpolation map. For the case of the sphere, with an explicit formula for the exponential map, the function Proj is simple to execute. However, the interpolation function is perhaps more challenging. A robust interpolation is that described in [15], where the values are consistently interpolated over the Delaunay triangles. 4.6. Adaptive Mesh Methods for compact, connected, and complete manifolds M . Suppose, for example, that we have a mesh generated on an oblate sphere (ellipsoid of revolution with eccentricity e = 0.25), see 2 not guaranteed to be even continuous. Further diﬃculty in building a discretization comes again from the geometry regarding the computation of geodesics. However, From the details of the proof in [15] we choose β ≤ α. It turns out that it is best on the sphere detailed in [15], with modiﬁcations, mutatis mutandis, to apply The uniform convergence critically depends on the solution of the modiﬁed . We will outline the algorithm for the sphere, see Algorithm 2. More general For the Optimal Transport problem, the result from [9] asserts that there exist source and target mass density functions fand fsuch that the mapping T is Algorithm 2 Computing the diﬀeomorphic mapping ϕ = S(1) given a local coordinate chart (x second order ordinary diﬀerential equation for the geodesics: where Γ sented, however, exploits an explicit representation formula for the mixed Hessian term, as derived in [16]. This required an explicit formula for the exponential map as a surjective map from local tangent planes onto the sphere. This is no longer possible in more general geometries. Thus, a direct discretization of D be necessary. We, similarly, do not have a representation formula for geodesic normal coordinates. This means that they must be approximated. This is possible in practice, however, with any method of ﬁnding geodesic normal coordinates that is consistent. of (36); Figure 2. A N = 5048-point cube mesh for the ellipsoid from the side (a) and diagonally above looking down (b) are the Christoﬀel symbols. The Optimal Transport scheme we have pretion Transport are those concerning local geodesics. That means that this method is more easily generalizable than that of Optimal Transport. Furthermore, any provably convergent scheme for computing the solution of the Poisson equation on compact manifolds M would lead to the same conclusions as we have presented here. original mesh will be assumed to be given by some oﬀ-the-shelf mesh generator which is simple to implement. Here we will be using a mesh deﬁned on a cube which is then projected onto the sphere. The original mesh, therefore, does not have constant density. However, in the moving mesh problem, we will be performing computations that produce diﬀeomorphic maps from a constant source density to a variable target density. This allows us to redistribute the mesh as desired. 5.1. Successful Moving Mesh Method Implementation via Optimal Transport and Optimal Information Transport. First, we demonstrate that the computation of mesh redistribution using Optimal Transport and Optimal Information Transport can be both successful in produce meshes which do not exhibit tangling. We select density functions with the goal of producing a transport map T that will concentrate mesh points around the equator, see (52). (52) the sphere, see 3 The only diﬃculties that exist with the method described for Optimal Informa- Our objective is to perform adaptive mesh computations on the sphere. The The original mesh is generated from the cube mesh that is then projected onto Figure 3. A N = 5048-point cube mesh from the top (a) and diagonally above looking down (b) to (52), see the visual representation in the ﬁgure 4 in Figure 5. see 6: 5.2. Optimal Information Transport is More Successful in Singular Examples. Another example serves to demonstrate the versatility and desirability of using Optimal Information Transport for moving mesh problems. We take a constant source density f of the world, where a higher density of grid points is required over the oceans and lower density over the continents, see Figure 7. Transport. The result is shown in Figure 8. ical computation via Optimal Transport. First, the necessity of using an interpolation function for the target mass density g onto the mesh deﬁned by T (x) leads to instabilities in the scheme due to the very nonlinear nature of the equation we We then require that the density concentrates about the equator according Figure 4. Density in the original mesh (left) and the modiﬁed density (right) The resulting mesh restructuring computed using Optimal Transport is pictured Now we perform the same computation using Optimal Information Transport, As before, we use the cube mesh 3 and transform it via Optimal Information Some diﬃculties are encountered when attempting to perform the same numer- Figure 5. (a) 3D view of the mesh obtained via Optimal Transport map, (b) top view, and a detailed view of the equator (c) showing that the grid lines do not tangle are trying to solve. Compensating for this, by using an inverted image for the Figure 6. (a) 3D view of the mesh obtained via Optimal Information Transport, (b) top view, and a detailed view of the equator (c) showing that the grid lines do not tangle source mass f and a constant for the target mass g will run, but exhibits signiﬁcant tangling for very complicated images like the world map, see Figure 9 will be explored in further work where the computation of the mapping T is slightly modiﬁed to gain convergence guarantees and greater stability. formation Transport on the sphere for the diﬀeomorphic density matching problem with applications to adaptive mesh methods by using convergent ﬁnite-diﬀerence schemes. We also introduced the issues concerning their generalization to more general closed, compact surfaces M. In this more general case, there appear to be more merits to using Optimal Information Transport. These merits include speed of implementation, generalizability in computational terms but also in terms of a priori regularity results. Nevertheless, it could be that a particular application requires the computation of Optimal Transport with the squared geodesic cost on the sphere and more general surfaces. Figure 7. Constant density in the source density (right) and the target globe density (left) One potential solution to this issue exhibited by the Optimal Transport problem We have provided the ﬁrst comparison of Optimal Transport and Optimal In- Figure 8. Entire spherical mesh transformed by Optimal Information Transport (a) in 3D view. The view is of Africa, Europe and Asia, but the other side of the sphere mesh is also visible. Shown on the right is detail on North America with other side of sphere hidden from view in order to show the mesh more clearly (b). The outlines of North and South America can be discerned and tangling is minimized. Figure 9. Entire spherical mesh transformed by Optimal Information Transport (a) in 3D view. Shown on the right is detail on Africa, the Middle East, and Asia with other side of sphere hidden from view in order to show the mesh more clearly (b). One can observe some tangling here. putationally eﬃcient than direct computation via discretization of the probability measures via Dirac measures. Many of the numerical techniques presented here apply more generally to elliptic PDE on compact closed surfaces, potentially solving a wide variety of problems. As an additional beneﬁt, the numerical techniques presented here are more com-