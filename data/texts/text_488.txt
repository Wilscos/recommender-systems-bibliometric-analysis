Mechanism Design has found important a pplications in the design of oﬄine and online markets. One of its main applications is the design of auctions, where a common goal is to maximize the seller’s revenue from the sale of one or multiple items to one or multiple bidders. This is challenging because bidders are strategic and interact with the auction in a way that beneﬁts themselves rather than the seller. Thus, without any information about the bidders’ willingness to pay for diﬀerent bundles of items, there is no meaningful way to optimize revenue. As such, a classical approach in Economics is to assume that bidders’ types – which determine their values for diﬀerent bundles and thus their willingness to pay for diﬀerent bundles – are not arbitrary but randomly drawn from a joint Machine learning has developed a variety of tools for learning and representing high-dimensional distributions with structure. Recent years have also seen big advances in designing multi-item mechanisms. Akin to overﬁtting, however, these mechanisms can be extremely sensitive to the Bayesian prior that they target, which becomes problematic when that prior is only approximately known. We consider a multi-item mechanism design problem where the bidders’ value distributions can be approximated by a topic model. Our solution builds on a recent robustiﬁcation framework by Brustle et al., which disentangles the statistical challenge of estimating a multi-dimensional prior from the task of designing a good mechanism for it, robustifying the performance of the latter against the estimation error of the former. We provide an extension of the framework that allows us to exploit the expressive p ower of topic mo dels to reduce the eﬀective dimensionality of the mechanism design problem. distribution D that is c ommon knowledge, i.e. known to all bidders and the auctioneer. With such a Bayesian prior, the revenue of diﬀerent mechanisms is compared on the basis of what revenue they achieve in expectation with respect to bidder type vectors drawn from D, and assuming that bidders play according to some (Bayesian) Nash equilibrium strategies, or some other type of rational behavior. Even with a Bayesian prior, however, revenue maximization is quite a challenging task. While Myerson’s celebrated work showed that a re latively simple mechanism is optimal in single-item settings [ ture of optimal multi-item mechanisms has been notor iously diﬃcult both analytically a nd computationally. Indeed, it is known that (even approximately) optimal multi-item mechanisms may requir e des cription complexity that scales exponentially in the number of items, even when there is a single buyer [ DHN14, DDT17, BGN21], they might be computationally intractable, even in simple settings [CDW12b, DDT14, CDO counter-intuitive properties which do not arise in single-item settings [ Nevertheless, recent years have seen substantial progress o n various fronts: analytical characterizations of optimal multi-item mechanisms [DDT13, GK14, KF16, DDT17]; co mputational frameworks for computing optimal multi-item mechanisms [AFH multi-item revenue optimization via simple mechanisms [CHK07, CHMS1 0, Ala11, HN12, KW12, CH13, B I LW14, Yao15, RW15, CDW16, CM16, CZ, DFL and (approximate) multi-item revenue optimization using sample access to the type distribution [ the use of deep lear ning [FNP18 , STZ19, DFN The afore-desc ribed progress on multi-item re venue o ptimization provides a diversity of tools tha t can be combined to allev iate the analytical and computational intractability of optimal mechanisms. Yet, there still remains a n impo rtant challenge in applying those tools, which is that they typically r e quire that the type distribution D is either known or can be sa mpled. However, this is too s trong an assumption. It is common that D is estimated through market research or econometric analysis in related settings, invo lv ing similar items or a subset of the items. In this case, we would o nly hope to k now some approximate distribution to the true distribution D but there might be errors in measuring o r recording those samples. Again, we might ho pe to estimate an approximate distribution ˆD that is close to D. Unfortunately, it is well understood that designing a mechanism fo r nisms tend to overﬁt the details of the type distribution. This has motivated a strand of recent literature to study how to robustify mechanisms to error s in the distribution [ There is, indeed, another important reason why one might want to desig n mechanisms for some approximate type distribution. Multi-dimensional data is complex and one would want to lever age the extensive statistical and machine learning toolkit that allows approximating such high-dimensional distributions with more structured models. Indeed, while the true type distribution D might ˆD that is close to D. In other settings , we may have sample access not conform to a simple model, it might be close to a distribution We would like to leverage the simple structure in tational intractability of multi-item mechanisms, and (ii) reduce the amount of communication that the bidders and the auctioneer need to exchange. While the structured model enue of our mechanism will b e robust when we apply it to the true distribution Motivated by the discus sion above, in this work we build a multi-item mechanism design fra mework that combines recommendation engines with mechanism design. In particular, we assume that each bidder draws their type – specifying their values for a large universe of N items – from a distr ibution D to a Matrix Factorized model these approximate distributions ality of bidder types to k, which has huge advantages in terms of the computational/repre sentation/communication/sample complexity of mechanism design. We develop tools that allow us to (a) use the mechanism co nstructed for the approximate interact with the bidders who are unaware o f the latent codes (they only understand their values for the N items and a re oblivious to the matrix factorized model) yet exploit the factorized model for eﬃciently communicating with them. In sum, our results are as follows: • With a query protocol Q that lea rns an approximate latent representation • We show that if the valuations ar e constrained-additive (Deﬁnition willing to purchase a n item at a given price. In the ﬁrst setting, the design ˆD’s under the true D’s without sacriﬁcing much revenue; and (b) of a bidder’s type, Theorem1 shows how to combine it with any mechanism cM that is designed only for the Matrix Factorization model to produce a mechanism that generates comparable revenue but with respect to the true distribution. The result is obtained via a r e ﬁnement of the robustiﬁcation result in [BCD20], where the loss in revenue, as well as the violation in incentive compatibility now only depend on the eﬀective dimension of the Matrix Factorization model, k, but not the total number of items, N can obtain communication-eﬃcient query protocols in several na tural settings (Theorem 2). The queries we consider ask a bidder whether they are matrix of the Matrix Factorization model contains a diagonally dominant matrix – a generalization of the well-known separability assumption by Donoho and Stodden [DS03]. In two other settings, we assume that the design matrix is gener ated from a pr obablistic model and show that a simple query protocol succeeds with high pr obability. that is designed only for the Matrix Factorization model, we can design a mechanism that a chieves comparable revenue and only requires the bidders to answer a small number of simple queries. In particular, for several natural settings, we show that the number of queries scales linearly in the We provide a brief introduction to mechanism design. To avoid a very long introduction, we only deﬁne the concepts in the context of multi-item auctions, which will be the focus of this paper. See Chapter 9 of [ references therein for a more detailed intro ductio n to mechanism design. Multi-item Auctions. The seller is selling N heterogenous items to m bidders. Each bidder i is assumed to have a private type t their preference over the items and bundles of items. We assume that t the d-dimensional Euclidean s pace. For each bidder, there is a publicly known valuation function v S ⊆ [N] when i’s private type is t setting with private types, that is, each bidder’s type t independently from a publicly known distribution D Mechanism. The seller designs a mechanism to sell the items to bidders. A mechanism consists of an allocation rule and a payment rule, where the allocation rule decides a way to allocate the items to the bidders, and the payment rule decides how much to charge each bidder. Direct Mechanism: In a direct mechanism, the mechanism directly solicits types from the bidders and apply the allocation and payment rules on the reported types. More speciﬁca lly, for any reported type proﬁle b = (b a direct mechanism M := (x(·), p(·)) selects x(b) ∈ {0, 1} and charges each bidder i payment p the allocation rule to be randomized, s o x(b) ∈ ∆ bidders have quasi-linear utilities. If bidder i’s private type is t under reported bid proﬁle b is u expectation is over the r andomness of the allocation and payment rule. Expected Revenue: In this paper, our goa l is to design mechanisms with high expected revenue. For a dire c t mechanism M , we use Rev(M, D) to denote Incentive Compatibility and Individual Rationality Since the bidders’ types are private, unless the mechanism incentivizes the bidders to report truthfully, there is no r e ason to expect tha t the reported types correspond to the true types. The notion of incentive compatibility is deﬁne to capture this. eﬀective dimension o f the Matrix Factorization model and independent of the total number of items (Proposition 1). Pp(t)], where t = (t, . . . , t) is the type proﬁle and is drawn from • ε-Bayesian Incentive Compatible (ε-BIC): if bidders draw their types with respect to D if for each bidder i ∈ [m] A mechanism is BIC if it is 0 -BIC. • Individually Rational (IR): A dir e c t mechanism M is IR if for all type Indirect Mechanism: For indirect mechanisms, the mechanism does no t directly solicit the bidders’ types. After interacting with the bidders, the mechanism selects an allocation and payments. The notion of ε-Bayesian Incentive Compatibility (or Individual Rationality) can be extended to indirect mechanisms using the solution concept of ε-Bayes Nash equilibrium. Deﬁnition 1. Let (U, d) be a metric space and B be a σ-algebra on U. For A ∈ B, let A Q on B have Pro khorov distance We consider distributions supported on some Euclidean Space, and we choose d to be the ℓ F ,bF by d We w ill also make use of the following characterizatio n of the Prokhorov metric by [ Lemma 1 (Character iz ation of the Prokhorov Metric [Str65]). Let F and be two distributions supported on R coupling γ of F and Deﬁnition 2 (Inﬂuence Matrix and Weak Dependence). For any d-dimensional random vector X = (X able i as where F Also, let α dependent if kInf(X)k from some distribution D =D, then a direct mechanism M is ε-BIC E[u(t, M(t, t))] ≥ E[u(t, M(t, t))] − ε, for all potential misreports t, in expectation over all other bidders bid t. proﬁles t = (t, . . . , t), for all bidders i ∈ [m]. = {x : ∃y ∈ A s.t d(x, y) < ε}. Two probability measure P and inf {ε > 0 : P (A) ≤ Q(A) + ε and Q(A) ≤ P (A) + ε, ∀A ∈ B}. -distance. We denote the ℓ-Prokhorov distance between distributions Str65]. := 0 for each i, and we use Inf(X) to denote the d × d matrix . In this paper, we consider the coordinates of X t o be weakly Setting and Goal: We consider a classical mechanism design problem, wherein a seller is selling N items to m buyers, where buyer i’s type t distribution D maximizes the seller’s revenue. In this paper, we operate in a setting where D is unknown, but we are given access to the following components: (I) For each bidder i, we are given a machine learning model tion type as described below, which approximates D mechanism nism can exploit the low eﬀective dimensionality, k, of types in the approximate model. Our goal is (III) to use (I) and (I I) to obtain a good mechanism for the true type distributions. (I) The ML Compo nent: We assume that ea ch bidder’s type distribution D can be well-approximated by a known Matrix Factorization (MF) model particular: • We assume that, for each bidder, the MF model is not far away from the Remark 1. In the above description we assumed that all design matrix A. This is done to avoid overloading notation but all our results would hold if each (II) The MD Component: We ass ume that we are given a direct mechanism cM for types drawn from the ML model. In particular, we assume that this mechanism makes use of the eﬀective dimension k of the ML model, accepting “latent types” (of dimension k) as input from the bidders. Speciﬁcally: • Recall that, for each bidder i, their valuation function v cM for the approximate type distributions; in its design this mechacolumn can be viewed as the type (over N items) of an “archetype.” As described in the following two bullets, types are sampled by eachbDas linear combinations over archetypes. bDto denote a distribution over [0, 1]. The subscript z is not a parameter of the distribution — it se rves to remind us that this distribution samples in the latent space [0, 1]and distinguish it from the distributionbDdeﬁned next. the random var iable Az, where z ∼ F . With this notation, we usebDto denote A ◦bD. true type distribution, that is, fo r some ε> 0 we have that d(D,bD) ≤ εfor all i ∈ [m]. R is common knowledge. (Recall that vtakes as input the bidder’s type • With the above as setup, we assume that the designer designs a mechanism (III) The New Component: We consider the regime where N ≫ k, and our goal is to combine the ML component with the MD component to produce a mechanism which generates revenue comparable to Rev( bidders whose types are drawn from D = (i)cM ta kes as input the latent r e presentation of a bidder’s type under ever under D a bidder is simply ignorant about any latent repres entation of their type so they cannot be asked about it; (ii) anism whose revenue is similar under D and valuation functions {v We show how to use a communication eﬃcient query protocol together with a robustiﬁcation procedure to combine the ML and MD components. To state our results, we ﬁrst need to formally deﬁne query protocols and some of their pro perties. Deﬁnition 3 ((ε, δ)-query protocol). Let Q be a query protocol, i.e., some communication protocol that exchanges messages with a bidder over possibly several rounds and output s a vector in R query protocol truthfully, if whenever the protocol asks the bidder to evaluate some function on their type the bidder evaluates the function and returns the resu lt truthfully. We use Q(t) ∈ R with a truthful bidder whose type is t ∈ R col, if for any t ∈ R kz − Q(t)k We a lso nee d the notion of Lipschitz valuations to formally state our result. Deﬁnition 4 (Lipschitz Valuations). v(·, ·) : R valuation, if for any two types t, t v(t, S)| ≤ Lkt − t This includes familiar settings, for example if the bidder is c-demand, the Lipschitz constant L = c. and a subset of items so how the bidder values diﬀerent subsets of items depends on their pr ivate type.) type as drawn frombD, i.e. in the latent space [0, 1]. With respect to such “latent types,” there is an induced valuation function. In particular, for each bidder i, we use v: R× 2→ R to denote the valuation function deﬁned as follows v(z, S) := v(Az, S), where z∈ R. cM that is BIC and IR w.r.t.bD=bDand valuation functions {v(·, ·)}. and valuation functions {v(·, ·)}and our goal is to obtain a mech- We a re now ready to state our ﬁrst main result. Theorem 1. Let D = 2→ R be a L-Lipschitz valuation for each bidder i ∈ [m]. Also, let A ∈ R be a design matrix and Suppose we are given query access to a mechanism w.r.t. of the MD component above), and there exists ε εfor all i ∈ [m]. Given any (ε mechanism M using only query access to such that for any possible D that satisﬁes the above conditions of Prokhorov distance closeness the following hold: 1. M only interacts with every bidder using Q once; 3. The expected revenue of M is at least Rev( To prove Theorem sp eciﬁcally, the le mma states that given an approximate distribution latent space and a BIC and IR mechanism with negligible revenue loss so that it is an approximately BIC and exactly IR mechanism w.r.t. F for any distribution F that is within the ε-Prokhorov ball around namely Theorem 3 in that paper. In particular, we exploit the eﬀective dimension of the MF model to replace the depe ndence on N with kAk violation of the incentive compatibility constraints and the revenue loss. Note that kAk value an archetype can have for a single item and is independent of N. We postpone the proof of Lemma Lemma 2. Let A ∈ R tion of distributions over latent types { lies in [0, 1] ations {v be any distribution such that d sampling algorithm S the conditional distribution of we can construct a randomized mechanism obliviously with respect to F , such that for any F satisfying the above conditions of Prokhorov distance closeness the following hold: bD=bDand valuations {v}(as deﬁned in the second bullet bF . This r e sult is a r e ﬁnement of the robustiﬁcation result in [BCD20], , and a BIC and IR mechanismcM w.r.t.bF =bFand valu}, where each vis an L-Lipschitz valuation. Let F =F Mechanism 1 Query-based Indirect Mechanism each i ∈ [m] and δ to be bidder i. (For any possible output pr oduced by Q, there exists a type b ∈ R so this is w.l.o.g..) Azsuch that their ℓ ε. As Q is a (ε kQ(t) − z their ℓ The statements follow from Lemma In Theorem We further a ssume that the bidders’ valuations are all co nstrained-additive. Deﬁnition 5 (Co ns trained-Additive valuation). A valuation function v : R 2→ R is constrained additive if v(t, S) = max I is a downward-closed set system, and µ = (µ example, unit-demand valuation is when I includes all subsets with size no more than 1. If all elements of I have size no more than L, then v is a L-Lipschitz valuation. Theorem 2. Let all bidders’ valuations be constrained-additive. We consider queries of the form: e The query simply asks whether the bidder is willing to pay at least p + µ winning item j. The bidder provides a Yes/No answer. We obtain communicationally eﬃcient protocols in the following settings: OkAkLmε + kAkLδ +; be bidder i’s type a nd zbe a random variable distributed acco rding . Since d(D,bD) ≤ ε, Lemma1 guarantees a coupling between tand k≤ ε. Hence, there exists a coupling between Q(t) and zso that distance is more than ε with probability no more than ε (recall ε≤ ε). bFto bebD, and δ to bemε. ✷ Π∈ Ris a permutation matrix, H is an arbitrary (N −k) ×k m atrix , α = min|C| −|C|and β = min|C| −|C|. We have a queries for any ε > 0. • Ex-ante Analysis: If A is generated from a distribution, where each archetype is an independent copy of a N -dimensional random vector θ. Remark 2. In the ex-ante analysis, the success probabilities depend on the parameters of the distributions, but note that they are both at least 1 −2 exp(−4k). Before we prove Theo rem for a few concrete settings. Proposition 1. Under the same set ting as in Theorem 1 with t he extra assumption that every valuation v M using only query access to the given mechanism type distribution D, such that for any possible D, M is O BIC and IR, and has revenue at least Rev( Recall that ε function f(·) and the number of queries for the following three concrete settings (one for each of the three assumptions in Theorem 1. Deterministic Structure: Separability. If the design matrix A satisis, A matrix, f(ε needs to answer is O – Multivariate Gaussian Distributions: θ is distributed according to a multivariate Gaussian distribution N(0, Σ). If there exists a subset S ⊆ [N] such that> 64k, where Σ= E[θθ] is the covariance matrix for items in S and ρ(Σ) is the largest eigenvalue of Σ,then with probability at least 1 −2 exp−, we have aε,√·ε-query protocol using O|S| · logqueries for any ε > 0. – Bounded Distributions with Weak Dependence: Let θbe supported on [−c, c] and has mean 0 for each i ∈ [N]. If there ex-P ists a su bset S ⊆ [N] such that kInf(θ)k< 1, andv>√ 2 exp−(), we have aε,√·ε-query protocol using O|S| · logqueries for any ε > 0. ﬁes the separabili ty assumption by Donoho and Stodden [DS03], that can be expressed as [IH]Π, where Π∈ Ris a permutation 2. Multivariate Gaussian Distributions: Well-Conditioned Σ. Let A be generated from a distribution, where each archetype is an independent draw from a N-dimensional normal distribution N(0, Σ). Let κ(Σ) be the condition number of Σ. bidder about items in S, with probability at least 1 − 2 ex p(−4k), f (ε queries. 3. Weak Dependence: Suﬃcient Variance per Item. Let A be generated from a distribution, where each archetype is an independent copy of an N-dimensional random vector θ . Assuming (i) kInf(θ)k lies in [−c, c], and (iii) Var[θ with size needs to answer O Proof. The results in the ﬁrst and las t setting follows directly from Theorem 2. For the second setting, notice that by the eige nvalue interlacing theorem, κ(Σ κ(Σ), as Σ Now, the result follows from Theorem Proof of Theorem 2: Instead of directly studying the query complexity under our query model. We ﬁrst consider the query complexity under a seemingly stronger query model, where we directly quer y the bidder about their value of et, and their answer will b e within e type of q ueries as noisy value querie s. Since for each item j, |e for all z ∈ [0, 1] we can use our queries to perform binary search on p to simulate noisy value queries. I n particular, we only need log kAk to simulate one noisy value q ueries. From now on, the plan is to ﬁrst investigate the query complexity for noisy value queries, then convert the r e sult to quer y complexity in the original model. We ﬁrst ﬁx the notation. Let ℓ be the number of noisy value queries, and Q ∈ R We use ˆy ∈ R true answers to the quer ie s. Note that kˆy − yk following least squares problem: min The problem has a closed form solution: ˆz = B := QA, and z(t) ∈ R O√· ε, and each bidder needs to answer Oκ(Σ)k · log probability at least 1 − 2 exp(−4k), f(ε) = O· εand each bidder is a principal submatrix of Σ. Therefore,≥≥ 64k. be the query matrix, where, each row of Q is a standard unit vector. interested in upper bounding kˆz − z(t)k Since the rows of Q are all standa rd unit vectors, kQk kˆz − z(t)k Deterministic Structure: We choose ℓ = k and Q so that QA = B = C. Since C is diagonally dominant, C is non-s ingular, and (C Lemma 3 (Adapted from Theorem 1 and Corollary 1 of [ trix U ∈ R α = min By Lemma 2 max columns. To sum up, if we choose Q so that QA = C, Multivariate Gaussian distribution: When θ is distributed according to a multivariate Gaussian distribution, we choose ℓ = |S| and Q so that each row corresponding to an e each column is an independent copy of θ and σ Lemma 4. [Concentration of Singular Values under multivariate Gaussian distributions] Let U = [X is an independent copy of a m-dimensional random vector X distributed according to a multivariate Gaussian distribution N(0, Λ Λ ∈ R ˆz − z(t) =(BB)B(ˆy − Bz(t)) ≤ 1/α and(U)≤ 1/β. C. The last inequality is beca use C is diago nally dominant by kˆz − z(t)k≤αβ≤2(ε + η) · maxCαβ. (B). The proof of Lemma 4 is postponed to Appendix A.1. , . . . , X] be a m × n random matrix, where each column of U is an orthonormal matrix, and D ∈ Ris a diagonal matrix. Weakly Dependent Distributions: When the coordinates of θ dependent, i.e., kInf(θ corresponding to an e each column is an independent copy of θ and σ Lemma 5. [Concentration of Singular Values under Weak Depen dence] Let U = [X U is an independent copy of a m-dimensional random vector X. We assu m e that t he coordinates of X are weakly dependent, i.e., kInf(X)k each coordinate of X lies in [−c, c] and has mean 0 and variance vq v = least 1 − 2 exp 1 − 2 exp(−4k). Therefore, with probability at least 1 − 2 exp Query Complexity in Diﬀ erent Models: We set η to be ε. (U) ≤ 2Tr(D) and σ(U) ≥, with probability at least −+ 4n, where dis the largest entry in D. )/4 with probability at least 1 − 2 exp−≥ 1 − 2 exp(− 4k). (B). The proof of Lemma5 is postpo ned to Appendix A.2. v. We have σ(U) ≤ 2v and σ(U) ≥, with probability at (B) ≥Pv/4 with probability at least 1−2 exp−()≥ using k(log kAk+ 2 log(1/ε)) queries. • Multivariate Gaussian dis tri butions: with probability at least 1 − • Weakly dependent distributions: w ith probability at least 1−2 exp we have a 2 exp−, we have aε,√· ε-query protocol using |S|(log kAk+ 2 log(1/ε)) queries. queries.