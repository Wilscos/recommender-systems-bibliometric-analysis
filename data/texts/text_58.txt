( (1) University of Rochester, Department of Biostatistics and Computational Biology, Rochester, NY) While the importance of prior selection is well understood, establishing guidelines for selecting priors in hierarchical models has remained an active, and sometimes contentious, area of Bayesian methodology research. Choices of hyperparameters for individual families of priors are often discussed in the literature, but rarely are diﬀerent families of priors compared under similar models and hyperparameters. Using simulated data, we evaluate the performance of inverse gamma and half-t priors for estimating the standard deviation of random eﬀects in three hierarchical models: the 8-schools model, a random intercepts longitudinal model, and a simple multiple outcomes model. We compare the performance of the two prior families using a range of prior hyperparameters, some of which have been suggested in the literature, and others that allow for a direct comparison of pairs of half-t and inverse-gamma priors. Estimation of very small values of the random eﬀect standard deviation led to convergence issues especially for the half-t priors. For most settings, we found that the posterior distribution of the standard deviation had smaller bias under half-t priors than under their inverse-gamma counterparts. Inverse gamma priors generally gave similar coverage but had smaller interval lengths than their half-t prior counterparts. Our results for these two prior families will inform prior speciﬁcation for hierarchical models, allowing practitioners to better align their priors with their respective models and goals. Keywords: half-t, hierarchical models, hyperparameters, informative priors, inverse gamma, random eﬀects variance, simulation In some Bayesian models, it may not be clear how to choose reasonable prior distributions for model parameters. Often, conjugate priors are chosen so that the posterior can be derived in closed form, or so that Gibbs sampling can be used to obtain samples from the posterior. Regardless of whether a conjugate prior is selected, one must also specify values for the prior hyperparameters. In many cases, these values can be selected so the prior has little inﬂuence on the posterior. Although this is not necessarily the goal of prior speciﬁcation, it is often of interest to be able choose relatively uninformative hyperparameters as long as their choice gives a proper posterior distribution. Hierarchical models are often used for models with random eﬀects when it is appropriate to share information across diﬀerent subjects or units, a situation called “borrowing strength”. An example of such a model is The model in (1) and (2) is used for the well-known eight schools example (Gelman et al., 2013), in which eight schools carried out randomized experiments to estimate the eﬀect of short term coaching on subsequent Scholastic Aptitude Test-Verbal (SAT-V) scores. In that situation individual students’ SAT-V scores were regressed on whether or not they had coaching (yes/no), and their prior PSAT-Verbal and PSAT-Math scores. In (1), ¯y school-speciﬁc regression ﬁt to the n where σ Weisenthal (1), Martin Cole (1), Yiping Pang (1), and Sally W. Thurston(1) is the estimated coaching eﬀect in school j, estimated by the slope for coaching from the is assumed to be known. The choice of priors and their associated hyperparameters for the between-unit variability, τ unit standard deviation, τ, in a hierarchical model has been discussed in a number of papers. A uniform prior on the shrinkage parameter, S = in similar models under certain conditions (Strawderman, 1971). Implementation of the uniform shrinkage prior (Daniels, 1999) leads to proper posterior distributions while providing desirable frequentist properties for testing and estimation. However, the uniform distribution on the shrinkage weight implies that σ τare of the same order of magnitude, a strong assumption that is not feasible in all data situations. Some prior choices can lead to improper posteriors, such as log(τ) ∼ Uniform(−∞, ∞) (Gelman et al., 2013). The prior τ ∼ Uniform(0, A) yields a proper posterior, but results are sensitive to A (Gelman et al., 2013). The property of conditional conjugacy makes the inverse gamma (IG) prior for τ IG(, ) with small  is often used (Gelman, 2006). However, the posterior can be sensitive to the choice of , and as  → 0 the posterior becomes improper. The use of an IG(, ) prior has become contentious in part due to its presence in the examples for the manual in the widely used software, BUGS (Spiegelhalter et al., 2003), where  = 0.001 is the parameter used in the examples in the BUGS manual. In Bayesian inference for generalized linear mixed models (GLMM) the choice of IG(, ) with small  can be shown to place the majority of the prior mass away from zero (Fong et al., 2010), leading to a marginal prior for the random eﬀects that is Student’s t with 2 degrees of freedom. When  is very small, the resulting t prior distribution has heavy tails. An alternative strategy is to choose a conservative prior that deliberately gives more weight to smaller values of τ advantageous when the consequences of inferring substantial variability of the random eﬀects are costly or otherwise undesirable. Gelman (2006) recommend a folded half-t(ν, s) prior for the standard deviation, τ , with ν degrees of freedom and scale s. In particular, they recommend ν = 1 (a half-Cauchy prior), and suggest that s be chosen to be a bit larger than the expected standard deviation of the random eﬀects. Polson and Scott (2012) also suggest the half-Cauchy as a default prior for τ . These authors provide additional justiﬁcation for this choice from a classical risk perspective, and show that this prior leads to excellent quadratic risk properties for high-dimensional sparse data. More recently, in his blog https://github.com/stan-dev/stan/wiki/ Prior-Choice-Recommendations (edited 4/17/20, accessed 7/12/20), Gelman suggests using a half-t (HT) prior for τ with s not too large, such as s = 1 and with ν = 4 degrees of freedom, or a half-normal prior with ν very large. It is clear from the literature that the choice of “default” priors is not a settled issue. Debates about prior choices for noniformative priors center around the meaning and acceptance of noninformativity. A number of researchers acknowledge the impossibility of truly noninformative priors, but this is not without controversy. Although the use of half-t (HT) or half-Cauchy priors for τ is becoming more widespread, a half-Cauchy prior has been criticized for poor behavior during MCMC sampling, due to it’s heavy tails (Piironen and Vehtari, 2015). While one school of thought suggests using default hyperparameter values for the prior of τ such as HT(4, 1), others suggest using prior information or the data to help inform this choice. For example, Wakeﬁeld (2007, 2009) suggests choosing hyperparameters based on an assumed range of the residual odds ratio. In this approach the prior degrees of freedom is selected, and the scale parameter is then obtained under the assumed range with an IG prior for τ Gelman et al. (2017) emphasized that a prior can only be understood and evaluated as it relates to a particular measurement process, i.e., a likelihood. They discourage reliance on default principles such as maximum entropy or weak informativeness, supporting the abandonment of one-size-ﬁts-all priors. The authors argue that it is a false paradox that prior knowledge must exist without reference to the likelihood, but that the form of the prior itself must make sense with the likelihood. This apparent paradox is resolved by considering the choice of prior in a broader context of the entire analysis. There, the prior must be valid in terms of a priori data generation (i.e., via the prior predictive distribution) and in terms of data prediction (i.e., via the posterior predictive distribution). Simpson et al. (2017) developed Penalized Complexity priors that follow a number of principles, including that the prior must not be noninformative. Using the concept of a base model, which here would correspond to the model without random eﬀects, they argue that the prior must place a suﬃcient mass at the base model, but also suﬃcient mass in the tails so that a more complex model is not over-penalized. These principles would favor a HT prior over an IG prior, because the latter has insuﬃcient mass at τ Simpson et al. (2017) noted that priors with a Gaussian tail can perform badly, suggesting that a HT prior with very large ν could have poor performance. Their recommendation is for a prior with exponential tails. There is a diﬀerence of opinion in the literature as to whether a more simple or more complex model should be favored a priori. Barr et al. (2013) argue for retaining all random eﬀects that can be justiﬁed by the data in the context of conﬁrmatory analyses when testing hypotheses about ﬁxed eﬀects. In contrast, Simpson et al. (2017), Gustafson et al. (2006) and others suggest selecting a prior that favors the simpler model. Bates et al. (2018) show the problems that can occur if a model is ﬁt that is too complex for the data, including convergence to the boundary and singular covariance matrices. Bates et al. (2018) illustrate these issues in models that have multiple random eﬀects that can potentially be correlated with each other. In this paper we consider models with either a single random eﬀect, or with two random eﬀects that are independent due to the data structure. Here we focus on making inference about τ, but not testing whether τ = 0. The focus of this work is on evaluating the performance of prior family and hyperparameter choice. We consider IG(a, b) priors for τ hierarchical models using simulated data. Our evaluation is based on coverage of the true value of τ in simulated data, as well as average bias and length of the 95% posterior interval. Browne et al. (2006) used similar criteria to evaluate IG(, ) and Unif(0, 1/) priors for τ models, arguing for the importance of priors that lead to well-calibrated inference. In our evaluation we consider several sets of hyperparameters recommended in the recent Bayesian literature for both the IG and HT priors. We also evaluate the performance of IG and HT priors using values that are determined in the context of the scale of the data. We consider the following three models: Model 1: Our ﬁrst model is the eight-schools model, given in (1) and (2). We assume that σ are known, and use the values of σ mean is not of interest here, in our simulated data each ¯y has mean 0 and we do not estimate µ. Simulated data using τ = 2.61 approximately reproduces the variability of the ¯y’s in the original eight-schools data. In our simulations we use three values of τ : τ = 0.4, 2, and 10. In all three models, the model speciﬁcation is complete upon choosing the prior (IG or HT) for τ Model 2: Our second model is a longitudinal model in which we allow subject-speciﬁc intercepts but assume a common slope across all subjects. We chose not to allow subject-speciﬁc slopes so that we retain our focus on evaluating priors for scalar random eﬀects, rather than considering an inverse-Wishart prior for covariance matrices. Model 2 is where y model we assume that all subjects are measured at the same J ages. We also center x on average. As in the previous model, interest focuses on the prior for τ β= 0.2, σ = 1, J = 4, n = 10 or 30, and again use three values of τ: τ = 0.1, 1, or 10. In Model 2 we also use the following priors for the other model parameters is the outcome at the jth age of the ith subject, and xdenotes the corresponding age. In this Model 3: Our ﬁnal model is a multiple outcomes model with two scalar random eﬀects. In this model we assume that each of n subjects has measurements of J outcomes, and that the outcomes can be inﬂuenced by a single covariate. We allow the slope of the covariate to diﬀer across the J outcomes, and treat the slope deviations as random eﬀects with standard deviation τ rwith scalar standard deviation τ measured on the same subjects. The model is: In simulations for Model 3 we use β yhas mean 0 on average. All simulations use n = 700 and J = 7. We simulate data using τ two values of τ outcomes models that are based on models in (5), see Thurston et al. (2009). Inverse gamma prior for τ in Gelman et al. (2013). The IG(a, b) distribution is equivalent to a scaled inverse χ ν degrees of freedom and we can write the IG(a, b) prior as IG(ν/2, s an example for which τ Since ν = 2a adds to the total number of random eﬀects (J) to give the posterior sample size, ν is the prior degrees of freedom, which is also the prior sample size for the number of random eﬀects. Also νs adds to θ squares. Under a goal of choosing a prior that does not overwhelm the information from the data, it would be reasonable to choose values of the hyperparameters that are somewhat small relative to the data. We consider several choices of ν (or equivalently a) to evaluate the eﬀect of changing only the prior degrees of freedom. Our smallest value is ν = 1 (i.e. a = 0.5), so that the information in the prior is equivalent to a prior sample size of 1 random eﬀect. Due to known convergence issues with very small degrees of freedom, our intermediate choice is ν = 4, which corresponds to a = 2. Our ﬁnal choice is ν = 10 (e.g. a = 5). In terms of choosing reasonable values for b, we see no reason to set b = a. Instead, it is important to avoid picking s by others (Crainiceanu et al., 2008). Since the posterior mean of τ be chosen independently, while changing a would result in changing b to b = as consider choosing s Half-t prior for τ : As shown by Wand et al. (2011) and Huang et al. (2013), if τ and a ∼ IG(1/2, 1/s τ with ν = 2a and s = τ. Like the IG prior, ν in the HT prior is the a priori degrees of freedom, or prior number of random eﬀects, and s HT distributions, any values of a and b that we choose for an IG prior for τ into values of ν and s for a HT prior for τ. We argue that for a given ν and s, the HT (ν, s) prior for τ in some sense has equivalent information regarding the prior degrees of freedom and prior scale parameter as the IG(a = ν/2, b = νs consider IG and HT priors in pairs as deﬁned here. In what follows when referring to prior hyperparameters we use ν to denote the prior degrees of freedom (which is 2a for the IG prior), and use the term ”prior scale hyperparameter” to refer to s for the both the HT prior and IG prior for which s = Prior hyperparameters used here: Several sets of our prior hyperparameters for s and b are based on the true value of τ . Since τ is unknown in real situations, we also choose s and b to be larger or smaller than the : τ= 0.04 or 0.16. The values of τand τwere chosen to be representative of multiple θ to give the posterior sum of squares, so sis the prior variance and νsis the prior sum of (or equivalently, b) that is too large relative to the unknown value of τin the data, a point noted true τ, by a factor of c = 1.5. We use the IG(a, b) notation convention to specify IG prior hyperparameters. We evaluate each of the three models under the following 14 sets of priors and hyperparameter values: (1) IG(1, 1); (2) IG(0.001, 0.001); (3) half-Cauchy(1.2 τ ) = HT(1, 1.2τ); (4) HT(4, 1); (5) IG(0.5, τ HT(1, τ); (7) IG(2, 2τ (13) IG(2, 2(τ /c) Priors 1–4 are suggested by the literature. Priors 5–10 use the true value of τ in determining s and b, and compare results due to varying ν from the small (prior 5–6), intermediate (priors 7–8) and larger (priors 9–10) values that we considered. Finally, priors 11–14 evaluate the impact of choosing s and b to be larger (priors 11–12) or smaller (priors 13–14) than the true τ under the intermediate ν = 4. By choosing c = 1.5 as the under- and over-estimation factor for τ , c For each model and each true value of τ, we are primarily interested in comparing the IG and HT prior “pairs” as deﬁned earlier, in particular; (i) the eﬀect of increasing the prior degrees of freedom (ν or a) when the true τ is used to determine s or b; and (ii) the eﬀect of taking the prior scale hyperparameter (a function of s or b) to be larger or smaller than τ, under the intermediate value of ν = 4, e.g. a = 2. We often refer to priors by their numbers, P-1, . . ., P-14. Our focus in (i) compares priors P-5, P-7 and P-9, with P-6, P-8, and P-10, and focus (ii) compares P-7, P-11, and P-13, with P-8, P-12, and P-14. We simulated 100 datasets for each model under each value of τ (or τ Rstan Stan Development Team (2020) in R R Core Team (2020) for MCMC sampling using Stan Stan Development Team (2018) to ﬁt the models using each of the 14 priors for all 100 datasets for each true parameter value(s). Our MCMC samplers used 4 chains each with a warmup of 250 iterations followed by 2500 draws per chain, resulting in 10, 000 posterior draws per dataset. Although in some situations a larger warmup could be justiﬁable, 200 iterations is generally considered a minimum adequate warmup period (see https:// statmodeling.stat.columbia.edu/2017/12/15/burn-vs-warm-iterative-simulation-algorithms/ (accessed 9/30/20). Preliminary simulations for Model 2 (not shown) also showed no beneﬁt of using a 2500 iteration warmup instead of a 250 iteration warmup per chain. The value of adapt delta used in running Stan models can be set by the user and impacts the step size of the MCMC sampler, with larger values corresponding to smaller steps. Larger values can result in slower exploration of the parameter space, whereas smaller values closer to 0.8 may cause divergent transitions whereby the sampler diverges from the intended path (Betancourt, 2016). We initially considered the default value of adapt delta=0.8, but this resulted in a large number of divergent transitions for many priors over all three models. Ultimately we chose adapt delta=0.99 for all models and all priors, to reduce to reduce the number of divergent transitions and make the results as comparable as possible across all conditions. For each simulation we report several convergence diagnostics, speciﬁcally the minimum eﬀective sample size (ESS), median ESS, mean et al., 1992) that compares between chain and within chain variability, where smaller values close to 1 are desirable. We also report the mean number of divergent transitions (DT), the percentage of datasets with zero DT, and the maximum number of DTs. Our evaluation of the priors and hyperparameters is based on the following, where τ indicates the true value and ¯τ indicates the mean over all MCMC draws for a given dataset: the bias (¯τ −τ), the relative bias (¯τ −τ)/τ, the root mean squared error (RMSE) Except for the RMSE, all quantities were calculated for each dataset and the stated summary statistics were calculated by averaging the results across all datasets. The RMSE was calculated by averaging the mean squared error (MSE) (¯τ − τ ) https://cran.r-project.org/web/packages/simhelpers/vignettes/MCSE.html (accessed 3/28/21). )); (14) HT(4, τ/c). For each model and true τ we start by commenting on convergence diagnostics. In then discussing the performance of the priors, we ﬁrst discuss the priors suggested by the literature (priors 1–4), then the eﬀects of increasing the prior degrees of freedom, ν (priors 5–10), and ﬁnally the eﬀects of over or underestimating the scale hyperparameter (priors 5-6 and 11-14). Small τ = 0.4: With τ = 0.4, DTs occurred under two priors. 28% of the datasets had at least one DT under the IG(0.001, 0.001) (P-2) prior and a single dataset had one DT under the IG(0.5, τ all priors the mean priors by a factor of 1.4 to 2.4 compared to their IG counterparts. With the exception of the IG(1, 1) (P-1), the remaining priors had a coverage of 1.00. The four priors recommended in the literature (priors 1–4) did not perform well. In addition to coverage of 0%, the IG(1, 1) (P-1) and especially the IG(0.001, 0.001) (P-2) were very badly biased (Table 2). Although the two HT priors recommended in the literature (P-3 and P-4) had better performance than P-1 and P-2, both the HT(1, 1.2τ) (P-3) and HT(4, 1) (P-4) badly overestimated τ , with a mean bias of 0.66 and 0.59 respectively. Among priors using the true τ as the scale hyperparameter (priors 5-10), the two with the smallest ν = 1 had a very large bias of 0.785 for the IG (P-5) and 0.534 for the HT (P-6). Bias generally decreased with increasing ν, for both IG and HT priors. For these six priors the HT had smaller RMSE than their IG counterparts, and a shorter interval length for small ν (P-6 versus P-5) but a longer interval length with both the medium (P-8 vs P-7) and large ν (P-10 vs P-9). These relationships are shown in the top left panel of Figure 1. The priors that used an inﬂated scale hyperparameter overestimated the posterior mean, where the bias for the IG prior (P-11) was substantially larger than its HT counterpart (P-12), while having a shorter interval length. When the prior scale hyperparameter underestimates τ, both priors had negative bias, but the IG (P-13) was less biased than its HT counterpart (P-14), as well as having a smaller RMSE and smaller interval length (Figure 2, top left panel). Medium τ = 2: All convergence diagnostics were reasonable except the IG(0.001, 0.001) (P-2) for which 32% of the datasets had a small number of DTs. Among priors 5–14 ESS was larger for the HT priors than their IG counterparts, by a factor of 1.19 to 1.93. All priors for τ = 2 had a coverage of 1.00 in this simulation. Among the four priors suggested by the literature, the IG(1, 1) (P-1) and HT(4, 1) (P-4) both underestimated τ , whereas the IG(0.001, 0.001) (P-2) and HT(1, 1.2τ) (P-3) overestimated τ , where the absolute bias was larger for the HT than the IG priors. Among priors using τ as the scale hyperparameter (priors 5–10), the IG priors had larger absolute bias and larger RMSE than their HT counterparts, except for the largest ν (P-9, P-10). Priors using the smallest ν (P-5, P-6), were particularly biased, especially the IG(0.5, τ ν = 1 had a similar interval length, as ν increased the interval length for the IG prior became substantially shorter relative to its HT counterpart. Both priors that used an inﬂated scale parameter had a positive bias that was larger for the IG(2, 2(cτ ) a small scale hyperparameter had a negative bias that was larger in absolute value for the HT(4, τ/c), P-14, than its IG counterpart, P-13. Large τ = 10: Only the IG(1, 1) (P-1) had DTs, aﬀecting 25% of the datasets. All priors had a mean 1.001 or less and ESS > 2500, which was generally smaller than for small or medium true values (τ = 0.4 or τ = 2). In contrast to small or medium τ, with τ = 10 ESS for the IG priors were larger by a factor of 1.13 to 1.68 than their HT counterparts. Three of the four priors suggested by the literature performed very poorly. The IG(1, 1) prior (P-1) had 20% coverage and a bias of −7.64, the HT(4, 1) prior (P-4) had 5% coverage and a bias of −8.86, and the 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(0.5, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) Figure 1: Inﬂuence of a priori degrees of freedom, ν, on posterior means and 95% posterior intervals for τ under inverse gamma and half-t priors. All priors shown use the true value of τ as the scale hyperparameter. Results are organized by smallest or largest values of true τ (rows) and by model number (columns). Vertical dashed lines indicate the true values of τ. Figure 2: Inﬂuence of choosing an a priori scale parameter that is smaller, equal, or larger to the true τ on posterior means and 95% posterior intervals for τ under inverse gamma and half-t priors. All priors shown use an a priori degrees of freedom of ν = 4. Results are organized by smallest or largest true τ (rows) and by model number (columns). Vertical dashed lines indicate the true values of τ. IG(0.001, 0.001) (P-2) prior had 88% coverage and a bias of −4.75. The six priors using τ as the scale hyperparameter (priors 5–10) all had a coverage of 1.00, but the three IG priors had better performance in all aspects than their HT counterparts. The three IG priors overestimated τ, but by a smaller degree than the three HT priors underestimated it. For example, the bias for the IG(2, 2τ interval length was larger for the HT than the IG priors with a widening gap in interval length as ν increased, reaching a doubling in interval length with ν = 10 (P-10 vs P-9) (Figure 1, lower left). When the prior scale hyperparameter was overestimated, the IG prior (P-11) substantially overestimated τ on average while still maintaining 95% coverage, whereas the HT prior (P-12) had relatively small bias and 100% coverage. When the prior scale hyperparameter was underestimated, both priors underestimated τ , but the HT prior (P-14) had larger absolute bias, larger RMSE, and longer interval length than its IG counterpart (P-13) (Figure 2, lower left). Although τ is the parameter of primary interest, we also calculated performance diagnostics for the overall slope, β. For each of the six combinations of τ = 0.1, 1, or 10 and data with n = 10 or 30 subjects, all 14 priors gave nearly identical estimates of β coverage. For each data set we also estimated τ from a random eﬀects model using lme4 with the formula Y ∼ X + (1 | Subject). When τ = 0.1, lme4 had diﬃculty estimating τ, where 51% (37%) of the models estimated ˆτ = 0 when n = 10 (n = 30), and τ was overestimated on average (Supplemental Table 7). For τ = 1 and τ = 10, ˆτ was never zero, and tau was slightly underestimated. We now focus on estimating τ in our Bayesian models. Small τ = 0.1: Convergence diagnostics with τ = 0.1 indicated that Stan had diﬃculty sampling from the posterior especially for the HT priors. For the smaller n = 10 datasets all HT priors had DTs for 79% to 92% of the datasets. The only IG prior with any DTs was IG(0.001, 0.001) (P-2). (Table 3). The IG priors also had larger ESS and smaller hyperparameter, the median ESS was larger for the IG priors by a factor of 2.1 (P-5 vs P-6; ν = 1), to 8.2 (P-9 vs P-10; ν = 10). In simulations using data with n = 30 observations, all HT priors had some DTs, but a smaller proportion of datasets had DTs than for n = 10. However, with the exception of the IG(1, 1) prior, ESS and With n = 10, the four priors we evaluated that were suggested in the literature (P-1 to P-4) generally did not perform well (Table 4). The IG(1, 1) prior badly overestimated τ , and had a coverage of 0. The HT (4, 1) prior, while having good coverage, was badly biased upwards with the largest bias of the HT priors and largest interval length. The situation was similar with n = 30, although biases were smaller (Supplemental Table 9. With both n = 10 and n = 30, coverage for all but the IG(1,1) prior was at least 98%. For priors that use the true τ as the scale hyperparameter (priors 5–10), the HT priors generally had smaller bias and a larger interval length than their IG counterparts. With increasing ν the bias decreased for both the IG and HT priors, and the interval length decreased but at a faster rate for the IG than the HT priors (Figure 1, top center). Consequently with ν = 1 and ν = 4 the HT priors had a smaller RMSE than their IG counterparts while the situation was reversed with ν = 10. For the IG prior with ν = 4, choosing a scale hyperparameter that is too large (P-11) resulted in a substantial increase in bias, whereas choosing it to be too small (P-13) slightly decreased bias relative to the prior based on the true τ (P-7). The HT priors also overestimated τ when using a large scale hyperparameter (P-12) and underestimated it with a small choice (P-14). Absolute bias was larger for the IG than the HT when τ was overstated (P-11 vs P-12), and was smaller for the IG than the HT when τ was understated (P-13 vs P-14) (Figure 2, top center). Medium τ = 1: Convergence diagnostics with τ = 1 were considerably improved relative to τ = 0.01. For simulations with n = 10, all HT priors had DTs, aﬀecting at most 12% of the datasets, while the only IG prior with DTs was the IG(0.001, 0.001). ) (P-7) and its HT(4, τ ) counterpart (P-8) was 0.83 and -2.045 respectively. For these six priors the ˆR were considerably worse with n = 30 (Supplemental Table 8) than n = 10. 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) 5.IG(1/2, τ 7.IG(2, 2τ 9.IG(5, 5τ 11.IG(2, 2(cτ ) 13.IG(2, 2(τ /c) Table 4: Summary results for τ under Model 2, the longitudinal model, with n = 10. median ESS was 1.2 to 1.6 times larger for the IG priors compared to their HT counterparts. Convergence diagnostics were much improved for simulations with n = 30, where only two priors had a few DTs for a single dataset. With n = 10 the only prior to have coverage below 90% was the IG with overestimated prior scale parameter (P-11). This prior had 88% coverage and the largest bias of all 14 priors. The HT priors had smaller bias than their IG counterparts, while generally the IG priors had a smaller RMSE (except the P-13, P-14 pair), smaller interval length, and slightly higher coverage than their HT counterparts. With n = 30, all priors estimated τ with little bias and good coverage. In contrast to n = 10, with n = 30 the IG priors using the true τ for the scale hyperparameter (priors 5–10) all had slightly smaller bias than their HT counterparts, while still having slightly smaller RMSE and interval length. Large τ = 10: With τ = 10 the issue of divergent transitions has entirely disappeared (Table 3). Although the median ESS and mean small minimum ESS and large maximum relatively small minimum ESS and maximum With n = 10, two of the priors had poor coverage: the IG(1,1) and the HT(4,1) with 84% and 80% coverage respectively. The HT(4,1) prior also badly underestimated τ by 12.6%. Among the remaining priors 5–14, only the IG with scale hyperparameter that overestimates τ (p11) was badly biased, with τ overestimated by 24.5% on average. Among priors that use the true τ for a scale hyperparameter (priors 5–10), the HT priors were somewhat less biased, but had somewhat worse coverage, larger interval length, and larger RMSE than their IG counterparts. For the smallest ν, coverage, interval length, and RMSE were similar for the IG and HT pair (P-5, P-6), but the disparity in these quantities increased with larger ν. With ν = 10, the IG prior (P-9) is better in all respects except bias than its HT counterpart (P-10). For simulated data with n = 30 observations the same patterns held, but diﬀerences between the IG and HT pairs were considerably reduced. A comparison of priors 11-14 shows that the HT priors are again less sensitive to over and underestimation of the scale parameter than their IG counterparts in terms of bias. The IG prior that overestimates τ (P-11) had the largest absolute bias of all 14 priors, while having similar coverage (90% versus 92%), similar RMSE, and similar interval length compared to its HT counterpart (P-12). Our primary focus is the standard error of the random eﬀects, τ was ﬁxed at a true value of 0.7 whereas we considered two values of τ priors (Supplemental Table 10), and although with small τ likely a function of the diﬃculty in estimating τ little bias across all 14 priors under both values of τ interval lengths for τ well estimated across all priors and both values of τ Small τ (Table 5). All HT priors had DTs for at least 40% of the datasets. Of the four priors suggested by the literature, the IG(1,1) prior, P-1, performed very poorly with a coverage of zero and an extremely large bias (Table 6). The IG(.001,.001) (P-2) and the HT(4,1) (P-4) slightly overestimated τ IG(1,1) prior, all priors had good coverage. For priors 5–14 the mean than the IG priors. In addition the median ESS was larger for the IG priors than their HT counterparts by a factor of 1.76 (small ν; P-5 versus P-6) to 2.82 (large ν; P-9 versus P-10). Among priors 5–10 that use the true τ slightly less biased than their IG counterparts (P-5, P-7, P-9), while having larger interval lengths and larger RMSEs than the IG priors. With increasing ν, bias decreased more for the IG priors than their HT counterparts, while interval length and RMSE increased more for the HT priors so that with ν = 10 the IG = 0.04: This small value of τlead to convergence issues for all HT priors but none of the IG priors , whereas the HT(1, 1.2τ) (P-3) had little bias, despite issues with DTs. Except for the prior (P-9) had better overall performance than its HT counterpart (P-10) (Figure 1, top right). When the scale hyperparameter is overestimated, both priors had positive bias, with the IG prior (P-11) showing much larger bias than its HT counterpart (P-12). Using an underestimate of τ hyperparameter resulted in a slight negative bias for both the IG (P-13) and HT (P-14) priors. In both cases the IG priors had smaller interval lengths (Figure 2, top right) and equal or smaller RMSE than their HT counterparts. Large τ the mean HT priors. The IG(1,1) prior (P-1) again had very large bias and a coverage of 0. The other three priors suggested by the literature all performed quite well, with the HT(4,1) (P-4) having the largest bias, interval length and RMSE among these three priors. Priors that used τ small but positive bias. Diﬀerences between the IG and HT pairs were slight, with the greatest diﬀerence for the largest ν = 10 for which the IG prior (P-9) was slightly better in all respects than its HT counterpart (P-10) (Figure 1, bottom right). When the scale hyperparameter overestimates τ counterpart (P-12), with larger bias, and 89% coverage. With a small prior scale hyperparameter (P-13, P-14), both the IG and HT priors had smaller absolute bias, smaller RMSE, and a shorter interval length 11.IG(2, 2(cτ ) 13.IG(2, 2(c/τ ) 14.HT (4, (τ /c) 11.IG(2, 2(cτ ) 13.IG(2, 2(c/τ ) 14.HT (4, (τ /c) Table 5: Diagnostics for τunder Model 3, the multiple outcomes model. = 0.16: Convergence diagnostics were considerably better with the larger τ. No prior had DTs, ˆR’s were very close to 1.000, and the median ESS was at least 4000 and was similar for the IG and than when using an inﬂated prior scale hyperparameter (P-11, P-12). Estimates of τ changes in the prior scale hyperparameters under the HT prior compared to the IG (Figure 2, bottom right). Inference for the standard deviation of random eﬀects in hierarchical models is known to be sensitive to the choice of its prior distribution. Using simulations, we addressed the question of how well τ, the random eﬀects standard deviation, can be estimated under IG and HT priors over a range of hyperparameters. We considered three diﬀerent models - the 8-schools model, a longitudinal model with random intercepts, and a simple multiple outcomes model. We compared seven IG priors for τ that results from IG and HT priors with the same prior degrees of freedom and prior scale hyperparameters can directly be compared, despite their quite diﬀerent distributions. Our simulation results showed that estimation of τ using typical hyperparameters suggested in the literature was sometimes extremely poor. When τ is very small, τ with a coverage of 0% for all three models. Although the other three priors that are commonly suggested in the literature had somewhat better performance, in some situations the IG(0.001, 0.001) and HT(4, 1) priors estimated τ with considerable bias. These results suggest that the expected magnitude of the SD of the random eﬀects in a hierarchical model should be considered when choosing hyperparameters for either an 11.IG(2, 2(cτ ) 13.IG(2, 2(c/τ ) 14.HT (4, (τ /c) 11.IG(2, 2(cτ ) 13.IG(2, 2(c/τ ) 14.HT (4, (τ /c) Table 6: Summary results for τunder Model 3, the multiple outcomes model. IG or HT prior. When choosing an IG prior, many investigators use IG(, ) for some small value of . We agree with Wakeﬁeld (2007, 2009) that the two hyperparameters should be chosen separately. Our simulations showed that choosing a scale hyperparameter for an IG prior that is larger than the true value can cause serious overestimation of τ, as noted by others (Crainiceanu et al., 2008), whereas choosing a scale hyperparameter that is smaller than τ by the same factor leads to far smaller absolute bias. Except for very small degrees of freedom, ν, when τ of τ from a HT distribution with the same scale and same value of ν. As ν increases, the posterior interval width decreases far more rapidly under the IG then the HT prior. Therefore the choice of whether to use an IG or HT prior, as well as the choice of their prior hyperparameters, could be viewed as a bias-variance tradeoﬀ. In particular, because its density is more peaked than the HT, the IG prior can lead to more bias in the posterior estimate of τ especially when the scale hyperparameter is not chosen well. Conversely, the HT prior can lead to larger variance in the estimate of τ and wider posterior intervals, which may be due to the strong assumption that τ can be very close to zero for any scale hyperparameter. Results for IG and HT priors that use the true value of τ as the basis for the scale hyperparameter were, in some cases, very sensitive to the prior degrees of freedom, ν. This sensitivity appears to be related to the information in the likelihood. Speciﬁcally, the length of the 95% posterior intervals for the 8-schools model (with 8 observations from which to estimate J = 8 random eﬀects) was 14.3 times longer for the IG prior and 5.4 times longer for the HT prior for ν = 1 as compared to ν = 10. In comparison, for the multiple outcomes model with n = 4900 correlated observations with which we estimate J = 7 random eﬀects, the length of the posterior intervals were far less sensitive to the choice of ν. Regardless of the model considered or the true τ, for the three values of ν that we considered here, the interval lengths based on an IG prior were nearly always shorter than those resulting from the paired HT prior. In summary, we found that it can be especially challenging to sample from the posterior of τ when the true value is very small, often leading to divergent transitions in Stan for HT priors but rarely for IG priors. When choosing hyperparameters for either an IG or HT prior for the variance or SD of random eﬀects, we argue that it is most important to choose a reasonable scale hyperparameter based on some a priori knowledge of the magnitude of τ . Although it is less clear what to choose for the a priori degrees of freedom, ν, one should bear in mind that when the number of random eﬀects is small, ν can have a large impact on the length of the posterior interval for τ . Finally, when it is possible to choose the prior scale hyperparameter well, the choice of whether to use an IG or HT prior may depend on the magnitude of τ and whether one is primarily interested in it’s point estimate or interval length. When τ is small, a HT prior is likely to be preferred when the point estimate of τ is of most interest (although convergence may be an issue), whereas an IG prior may be preferred based on interval length. For large τ, the IG prior may be preferable based on interval length, and can sometimes result in smaller bias than the HT, especially when the data has few random eﬀects or when ν can be chosen to be relatively large. However the consequences of choosing a poor prior scale hyperparameter are more severe for the IG than the HT prior, especially if this hyperparameter is chosen to be too large. More work is needed to determine whether these general conclusions hold for ν outside the range we considered here, and to what extent varying ν aﬀects posterior inference when the prior scale hyperparameter for τ is not chosen well.