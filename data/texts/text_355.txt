In recent years, researchers attempt to utilize online social information to alleviate data sparsity for collaborative ltering, based on the rationale that social networks oers the insights to understand the behavioral patterns. However, due to the overlook of inter-dependent knowledge across items (e.g., categories of products), existing social recommender systems are insucient to distill the heterogeneous collaborative signals from both user and item side. In this work, we propose Self-Supervised Metagraph Informax Network (SMIN) which investigates the potential of jointly incorporating social- and knowledge-aware relational structures into the user preference representation for recommendation. To model relation heterogeneity, we design a metapath-guided heterogeneous graph neural network to aggregate feature embeddings from dierent types of meta-relations across users and items, empowering SMIN to maintain dedicated representations for multifaceted user- and item-wise dependencies. Additionally, to inject high-order collaborative signals, we generalize the mutual information learning paradigm under the self-supervised graph-based collaborative ltering. This endows the expressive modeling of useritem interactive patterns, by exploring global-level collaborative relations and underlying isomorphic transformation property of graph topology. Experimental results on several real-world datasets demonstrate the eectiveness of our SMIN model over various stateof-the-art recommendation methods. We release our source code at https://github.com/SocialRecsys/SMIN. • Information systems → Recommender systems. Social Recommendation, Graph Neural Networks, Self-Supervised Learning ACM Reference Format: Xiaoling Long, Chao Huang, Yong Xu, Huance Xu, Peng Dai,, Lianghao Xia, Liefeng Bo. 2021. Social Recommendation with Self-Supervised Metagraph Informax Network. In Proceedings of the 30th ACM International Conference on Information and Knowledge Management (CIKM ’21), November 1–5, 2021, Virtual Event, QLD, Australia. ACM, Queensland, Australia, 10 pages. https://doi.org/10.1145/3459637.3482480 Recommender systems have become an essential component in online platforms (e.g., E-commerce [16], news portals [43]) to alleviate the information overload for users [41,46]. To predict user preference over dierent items from historical behaviors, collaborative ltering (CF) has served as the key paradigm to make recommendation based on users’ potential common preferences [5,38]. However, conventional CF methods often suer from data sparsity and cold start problems. With the prevalence of online social communities in enabling users to share their opinions with others, many eorts have been devoted to incorporating online social network information into the user-item interaction learning, to alleviate the data sparsity issue and enhance recommendation performance [2,8,44]. These social recommendation models are proposed based on the social inuence theory that socially connected people are likely to share similar interests [19]. Earlier methods extend the matrix factorization architecture to integrate social relationships as regularization term (e.g., SoReg [20]) or project users into latent representations with their trust relationships (e.g., TrustMF [52]). In recent years, several eorts provide deep insights into neural network techniques and design more sophisticated models to learn precise user and item embeddings, with the joint integration of useruser and user-item relational structures. In particular, attentionbased mechanisms, such as SAMN [2] and EATNN [4], perform the attentive operations over relationships between users through weighted embedding summation. Furthermore, due to the graphstructured nature of users’ social connections, several recent works design graph neural social recommendation models to encode the user relation graph into latent representation space. For instance, GraphRec [8] and DANSER [45] adopt the graph attention network to aggregate feature embeddings from neighboring nodes of the target user. Motivated by the strength of graph convolution network, DiNet [44] is built upon the graph-structured message passing architecture to conduct the layer-wise information diusion across users and approximate the social inuence propagation process. Despite the aforementioned solutions have provided promising recommendation performance, we argue that existing social-aware recommender systems are insucient to yield quality representations for preserving user’s preference, since their designed embedding functions lack an explicit encoding of semantic relatedness between items [55]. In real-world recommendation applications, incorporating the external knowledge from item side is particularly helpful to better understand user’s interests [37,50]. For example, in online retail platforms, products can be correlated with their similar functionality [51]. External knowledge from online review systems (e.g., Yelp) may contain fruitful connections between venues in terms of their categorical similarities or received reviews [57]. These semantic signals have great potential to characterize knowledgeaware relationships across dierent items [58], which can enhance the collaborative eect encoding for social recommendation. The joint modeling of social- and knowledge-aware collaborative signals poses several unique technical challenges that cannot be easily handled by existing social recommendation methods.First, the incorporation of both social and knowledge graph information into user-item interactions, involves diversied inter-dependencies which are heterogeneous in nature. How to eectively preserve the heterogeneous relational structure across users and items in a unied representation framework, remains a signicant challenge. Second, in practical recommendation scenarios, factors that aect customer’s behavior are often multifaceted from both user and item domains [35,45]. For example, there exist multiple relations between items reecting multi-dimensional contextual signals, e.g., behavior-level co-interact patterns and knowledge graph-based item-wise dependencies. Hence, it is a necessity to endow the designed embedding function with the capability of capturing itemitem semantic relatedness and knowledge-aware social inuence. Third, existing solutions extend graph neural networks to socialaware recommendation has the potential to model social connections between users. However, incorporating the learned socialand knowledge-aware information still requires a tailored modeling to distill the high-order collaborative relations, with the joint preservation of local and global graph structural information. The Present Work. Having realized the importance of integrating heterogeneous user- and item-wise relations into the recommendation framework, as well as the corresponding challenges, this work develops SMIN (Self-SupervisedMetagraphInformaxNetworks), a knowledge-aware social recommendation architecture that simultaneously captures relational heterogeneity across users and items. Specically, in order to handle relation heterogeneity, we propose a metapath-guided heterogeneous graph neural module to distill the multifaceted user-user and item-item relationships with the exploration of social network homophily, item knowledge graph dependencies as well as behavioral-level co-interactive patterns. SMIN rst designs a meta relation-guided message passing architecture which maintains the type-specic relation representation space. Following the metepath-specic graph encoding layer, we further conduct the cross-metapath aggregation based on attention mechanism, to learn summarized representation vectors which capture the comprehensive semantics ingrained in the heterogeneous relations among users and items. After encoding the relation heterogeneity (multifaceted social and knowledge graph dependencies) across users and items, we next incorporate the user-user and item-item relations into the encoding process of user-item interactive patterns, with a self-supervised graph mutual information learning architecture. Dierent from most of existing graph neural network-based collaborative ltering models which merely perform information propagation across local neighbors, we believe it is of critical importance to develop a relation encoder that investigates both local and global collaborative signals. Inspired by the eectiveness of introducing mutual dependence measurement in feature representation space [1,26,34], SMIN transfers external knowledge from both user and item side into our interaction encoder under a self-supervised graph learning paradigm. Our SMIN performs the self-supervised data augmentation from two-folds: i) Inject the substructure awareness into the graph neural architecture to distill ne-grained semantics of local and global user-item interactive patterns; ii) Model the useritem high-order connectivity with the exploration of three dierent graph structure views: high-level substructure-aware global context, low-level node feature representation, and transformation characteristics of user-item interactive relations. To summarize, our work makes the following contributions: • General Aspects. We emphasize the importance of jointly modeling social- and knowledge-aware relations from both user and item domains for better learning user’s preference. We further incorporate the relation heterogeneity across users and items under a self-supervised learning paradigm, into the embedding space by exploring local and global collaborative similarities. • Methodologies. To handle relation heterogeneity, we propose a metapath-guided heterogeneous graph neural network to maintain the user- and item-specic dependent representations through embedding propagation across graph layers. After that, an attentive cross-metapath aggregation layer is introduced to fuse the rich characteristics of multifaceted user- and item-wise interdependencies. In addition, SMIN allows the learned social- and knowledge-aware dependence to guide the user-item interaction embedding process from dierent structure views under a selfsupervised graph learning architecture. • Experimental Findings. We perform extensive experiments on three real-world datasets to demonstrate the superiority of our framework over state-of-the-art recommendation techniques. This section introduces key denitions and notations used in our work. Suppose we have𝐼users (𝑈 = {𝑢, ...,𝑢, ...,𝑢}) and𝐽items (𝑉 = {𝑣, ..., 𝑣, ..., 𝑣}) in a typical recommendation scenario, where 𝑖and𝑗are identier for user and item, respectively. We dene the user-item interaction matrixX = [𝑥] ∈ R, in which𝑥∈ {0,1}indicates whether user𝑢has interacted with (e.g., purchased or clicked) item𝑣, i.e.,𝑥=1 if interaction(𝑢, 𝑣)is observed and 𝑥=0 otherwise. In addition to the interaction data, we propose to consider side information from both users and items, and further present the relevant denitions which preserve the heterogeneous relationships across users and items as below. Denition 2.1.User Social Graph 𝐺. We dene graph𝐺= {𝑈 , 𝐸}to denote social relations between users, where there exists an edge between user 𝑢and 𝑢if they are socially connected. Denition 2.2.Item Relational Graph 𝐺. To model the external knowledge from item side, we represent the item-wise relational structures in the form of dependency graph𝐺. Specically, the item inter-dependent signals are characterized with item-relationitem triples(ℎ, 𝑟, 𝑡 ), whereℎ, 𝑡 ∈ Vand𝑟 ∈ R. Here,Rdenotes the set of relations in𝐺. For example, the relation𝑟can indicate that itemℎbelongs to the product category of𝑟, or the co-interaction with the same user. Based on the above notations, we dene the collaborative heterogeneous graphGto integrate both user behavior as well side information from both user and item domains. Denition 2.3.Collaborative Heterogeneous Graph G. Collaborative Heterogeneous Graph is dened as a unied graphG = {V, E}which is associated with mapping functions for nodes: V → Aand edgesE → B. Here,AandBdenotes the sets of node and edge types, respectively, with|A| + |B| >2. In particular, the relation heterogeneity among users and items are modeled inGwith the integration operations as:V = 𝑈 ∪ {ℎ, 𝑡 } ∈ 𝐺and E = 𝐸∪ R ∪ {𝐼𝑛𝑡𝑒𝑟𝑎𝑐𝑡}. Task Formulation. We now formulate our knowledge-aware social recommendation task as follows: • Input: collaborative heterogeneous graphG = {V, E}that collectively integrates user-item interaction𝐺, user social graph 𝐺and item relational graph 𝐺. • Output: the predictive function that infers the probability of an unknown behavior for target user 𝑢interacting with item 𝑣. This section presents the details of SMIN which consists of three key modules (shown in Figure 2): i) Metapath-guided heterogeneous graph encoder which simultaneously captures the multifaceted social eects and item inter-dependent relations. ii) Crossmetapath aggregation network that integrates the semantic learned by metapath-specic representations. iii) Self-supervised graph mutual information learning which injects the social- and knowledgeaware embeddings into the user-item interaction modeling. We rst develop a metapath-guided heterogeneous graph neural encoder to distill semantic information of user-wise relations and item-wise inter-dependencies, based on the metapath instances over the collaborative heterogeneous graphG. In our work, a metapath instance𝑝represents a vertex sequence to capture the structural and semantic relation between objects [6,9]. In particular,𝑝is formally dened in the form ofA→ A→ · · ·→ A, which characterizes the meta-relations between vertex typeAandA (𝐶 denotes the length of metapath instance 𝑝). Denition 3.1.Metapath-based Neighbor. Based on the above present metapath instance𝑝, nodes (𝑣∈ V) which are connected with𝑣through metapath instances in graphG, are dened as metapath-based neighbors𝑁of𝑣under the metapath instance of 𝑝. Note that two nodes are connected through dierent metapath instances are regarded as dierent neighborhood relations. 3.1.1Multifaceted Meta-Relations Generation.In our recommendation scenario, we extract dierent types of metapath instances for user and item domain, respectively, via exploring multifaceted social- and knowledge-aware dependence eects. Here, we dene𝑝and𝑝to represent the extracted individual metapath instance for user and item, respectively. The corresponding instance sets are denoted as𝑃and𝑃(𝑝∈ 𝑃,𝑝∈ 𝑃). We present illustrated examples of multifaceted meta-relations from both user and item domain in Figure 1. • Social Network Context. Social network homophily represents the static social relationships across users given their established social connections (e.g., friendship, community of interest). The generated user relation instance within the social network context is 𝑢→ 𝑢(𝑢, 𝑢∈ 𝑈 ) • Behavior-level User Relation. In addition to the static social network connections, we propose to model the social inuence with the consideration of user behaviors. The corresponding metapath instance𝑝over graphGfor behavior-level inuence is 𝑢→ 𝑣→ 𝑢(𝑢, 𝑢∈ 𝑈 and 𝑣∈ 𝑉 ). • Knowledge-aware User Dependency. With the incorporation of item relational graph information into our recommendation framework, we further integrate the external knowledge graph signals with behavior-level user inuence, so as to generate another type of metapath instance for user dependency, i.e., For the item domain, we consider two types of metapaths: • Behavior-level Item Relation. We consider the inuence between items with their attractiveness based on user interaction behavior. The attractiveness-based item metapath instance𝑝is generated as 𝑣→ 𝑢→ 𝑣(𝑣, 𝑣∈ 𝑉 and 𝑢∈ 𝑈 ). • Knowledge-aware Item Dependency. Since the relation graph 𝐺characterizes semantic relatedness across items, we also model implicit item-wise dependencies with entity-based metapath instance of𝑣→ 𝑟→ 𝑣.𝑟denotes the intermediate entity connecting item 𝑣and 𝑣with dierent relationships. Figure 2: (a). The integrative framework of metapath-guided heterogeneous neural network and cross-path aggregation network. (b-c) Substructure-aware global context modeling component that injects user-item high-order connectivity into the embedding space. (d) The topology-aware mutual information learning via capturing transformation property of user/itemspecic characteristics and the underlying interactive patterns. 3.1.2Metapath-guided Message Propagation.After obtaining the metapath instances𝑝 ∈ 𝑃with the preservation of multifaceted relational structures from both user and item side, we propose to encode the underlying relation heterogeneity with a graph-based neural architecture. In our metapath-guided message propagation framework, the embedding of individual node (i.e., user𝑢∈ 𝑈and item𝑣∈ 𝑉) is generated with a graph neural layer aggregating feature information from metapath-based neighbors. In particular, given the metapath instance of𝑝and𝑝, we dene the propagated message between (𝑢,𝑢) and (𝑣,𝑣) as𝑚and 𝑚, respectively. The corresponding embedding propagation process between users and items can be represented as follows: 𝑚= 𝜓 (h; 𝜏 (𝑖, 𝑖, 𝑝)); 𝑚= 𝜓 (h, 𝜏 ( 𝑗, 𝑗, 𝑝)) Our graph-structured message passing paradigm for neighborhood feature aggregation at layer 𝑙 for node 𝑢is formalized as: The embedding propagation is performed through multiple (𝐿) graph layers to update embeddings over metagraph neighborhoods with the𝑝-th metapath instance.𝜎 (·)indicates the PReLU function for dealing with feature non-linearities. We then apply the concatenate operation over the cross-layer social- and knowledge-aware node embeddings (e.g.,h,h).W ∈ Ris the transformation matrix andY ∈ Rdenotes the user/item local-level embeddings encoded from their graph-based connectivity. We develop an aggregation layer, which is built upon the attention mechanism, to perform the cross-metapath information aggregation. The aggregation network aims to automatically learn a normalized importance weight𝜔for each metapath instance𝑝, which is formally represented with the following operation. Here, we only present the cross-metapath aggregation layer for user-wise meta-relations. The same aggregation mechanism will be adopted for encoding relationship heterogeneity between items. whereW∈ RandW∈ Rare parameterized attention transformation matrices.b∈ Ris the attentive bias term. The estimated importance weight𝜔reects the importance of each type of meta-relation between users and items, e.g., social network homophily, behavior-level user inuence and knowledgeaware item-wise relations. The summarized embeddingsh,h aggregate semantics across heterogeneous user-user and item-item meta-relations. After preserving and extracting the heterogeneous relational structures into the embedding space of users and items, we aim to inject high-order interactive patterns into our social recommendation model. Towards this end, we design a self-supervised mutual information learning architecture to facilitate learning expressive representations which jointly exhibit the local-level node-specic user/item characteristics and global-level graph dependencies. Motivated by the graph learning framework in [26], this component is built upon the self-supervised learning framework to construct supervising signals with auxiliary optimization objective. 3.3.1Node-Level Graph Embedding Layer.In our framework, we generate the feature representationsH ∈ Rfor graph nodes which consist of fused user/item embeddings (h,h), with the preservation of social- and knowledge-aware heterogeneous relations (encoded from our cross-metapath aggregation network). In addition, we dene𝚽 ∈ Rmatrix to represent the node adjacent relations over the user-item interaction graph, in which each entry𝜙 =1 if the corresponding user𝑢adopts item 𝑣(𝑥=1 in interaction matrixX) and𝜙 =0 otherwise. The encoding process is formally given as follows: W ∈ Ris the transformation matrix ,D ∈ Ris the degree matrix which contains information about the degree of each vertex andY ∈ Rrepresents the user/item embeddings encoded from their graph-based connectivity. 3.3.2Substructure-aware Global Context Injection.It is worth mentioning that substructure often reects unique characteristics and relation signals of graph data for network representation [26,39], and collaborative user and item similarities could be captured suciently without constructing long-range graph-based connections across the entire user-item graph. Hence, we incorporate the substructure awareness into global context-enhanced user-item relation modeling from the low-level node and high-level graph topological information. In particular, we inject the substructure awareness into the user-item interaction graph by generating the𝑘-order substructure-aware adjacent matrix based on the following element-wise addition operations across dierent order-specic relation adjacent matrices (e.g., 𝚽, 𝚽): where𝚽represents the original adjacent matrix of user-item interaction graph by considering 1-hop neighborhood relations as edges between nodes.𝚽incorporates all𝑘-hop neighbors into the adjacent relations. For example,𝚽= 𝚽+ 𝚽(𝚽)and𝚽= 𝚽+𝚽(𝚽)+(𝚽(𝚽))𝚽. Given the𝑘-order substructure-aware adjacent matrix𝚽, we generate the graph-level representations: whereZ ∈ Rrepresents the learned substructure-aware global embeddings and each row of which represents the substructureaware global embedding corresponding to each node (user𝑢or item𝑣) in the interaction graph. It injects the global graph-structured context into latent representationsY.ˆ𝚽∈ Ris the degree matrix which contains the node degree of individual node. Next, we propose to capture both local and global user-item interactive patterns via encoding the mutual information between node embeddingy∈ Zand the corresponding high-level graph representationz∈ Z. Following the paradigm in [11], we dene our global context-aware discriminatorD(y, z) = 𝛿 (y⊗z)(𝛿 (·)denotes the sigmoid function) to classify the pairwise relationship between yandzfrom the joint distribution with the aim of maximizing the mutual informationMI(y;z). In particular, the embedding pair(y, z)is fed into our discriminator as positive instance. We generate negative instance(ey, z). We further dene the objective function with the modeling of global context-aware mutual information MI(y; z) as follows: L=−1𝐼 + 𝐽(𝑙𝑜𝑔D(y, z) +𝑙𝑜𝑔[1 − D(ey, z)]) (6) Minimizing the above cross-entropy-based loss contributes to the mutual information maximization and capturing the user-item highorder collaborative relations from locally to globally. 3.3.3Topology-Aware Mutual Information Encoding.We propose to consider the properties of the topological information over the user-item interaction graph (motivated by the graph structure modeling in [24,26]). Specically, we dene our topology-aware mutual information asMI(h, y)andMI(Z · Z, 𝚽)which reects the transformation property of node and edge structural feature, respectively. To achieve this goal, we design our discriminator D(y, h) = 𝛿(y⊗ h), to endow our graph embedding layer 𝑓 (H, 𝚽)with the ability of preserving characteristics of node dimension betweenyandh. The corresponding optimized objective function is given: L=−1𝐼 + 𝐽(𝑙𝑜𝑔D(y, h) +𝑙𝑜𝑔[1 − D(ey, h)]) (7) Additionally, another dimension of transformation lies in the encoded user-item interactions (relational edges) from our graph embedding layer. The loss with edge transformation is dened as: e𝚽indicates the re-constructed user-item connections which are generated with our encoded user and item representationszand z.𝑅(indexed by𝑟) denotes the number of non-zero elements ine𝚽. With the preservation of the transformation of both nodes and their connections, we augment the representation learning by incorporating topology-aware user-item interactions. 3.4.1Optimization Objective.We dene our joint optimized objectionLwith the integration of heterogeneous relationship learning across users and items, and user-item interaction modeling via graph-structured mutual information encoder, based on Bayesian personalized ranking loss: L =−1𝑁𝑙𝑜𝑔[𝛿 (h, h) − 𝛿 (h, h)] where𝑂is the training instance consisting of positive ((𝑢, 𝑣)) and negative ((𝑢, 𝑣)) samples corresponding to the observed and unobserved interactions between user and item.Θdenotes the trainable parameters for regularization with the strength of𝜆.𝜆, 𝜆and𝜆balances the loss functions with mutual information maximization from dierent views. Table 1: Statistical information of the datasets. 3.4.2Model Complexity Analysis.In this subsection, we perform time complexity analysis of our SMIN method. Particularly, the cost of cross-layer message propagation in our metapath-guided heterogeneous graph neural network lies in the𝑂 (|𝐸|×𝐿×𝑑), where |𝐸|denotes the number of meta-connections,𝐿represents the depth of our graph neural network, and𝑑denotes the latent dimensionality. The nal prediction layer has the complexity of𝑂 (|𝐸|×𝐿×𝑑). Given the component-specic complexity analysis, the overall computational complexity of SMIN is𝑂 ( (|𝐸| + |𝐸|) × 𝐿 ×𝑑), which is comparable to most of existing social recommendation approaches. We evaluate the performance of our SMIN recommendation framework on three public datasets collected from real-life platforms. This section aims to study the following research questions (RQs): • RQ1: How does SMIN perform compared with various baselines? • RQ2: How do dierent components (e.g., metapath-guided heterogeneous graph neural network, mutual information-augmented learning paradigm) aect the performance of SMIN ? • RQ3: What is the impact of dierent types of meta-relations across users and items in the recommendation performance? • RQ4: How do dierent settings of key hyperparameters aect the model prediction performance? • RQ5: How do the learned latent representations benet from the collectively encoding of social- and knowledge-enhanced user-item interactive patterns? 4.1.1Data Description.Our SMIN framework is evaluated on three real-world datasets. We present the data statistics in Table 1 and elaborate details of individual dataset as below: • Ciao and Epinions Data. These two datasets serve as benchmarks for evaluating social recommender systems. Ciao and Epinions are two popular consumer review platforms in which users are free to establish their social connections. • Yelp Data. This data is collected from Yelp platform and contains users’ online friendships with respect to their similar interests. In Yelp, customers could provide feedback on local venues from dierent business categories. 4.1.2Evaluation Protocols.In our evaluation, we adopt the leave-one-out strategy for training and testing set generation, which has been widely used in recommendation applications [27,44]. To follow the similar experimental settings in [2,33] and enable the result evaluation in an ecient way, we pair the positive sample of the target user with 99 negative instances which have no interaction with this user. Since this work focus on top-N item recommendation scenario, we leverage two representative recommendation evaluation metrics: Hit Ratio (HR) and Normalized Discounted Cumulative Gain(NDCG). In our experiments, in addition to user-user dependencies and user-item interactions, we further generate the knowledge-aware item relations by extracting external knowledge (i.e., categories of item) from item domain. 4.1.3Baselines for Comparison.We compare SMIN with various state-of-the-art baselines as shown below: • PMF[23]: it is a probabilistic matrix factorization method to factorize users and items into latent feature vectors. • TrustMF[52]: The proposed new matrix factorization-based framework incorporates the users’ trust relationships into the embedding process, to augment the user preference modeling. • EATNN[4]: It is an adaptive transfer learning model with attention network to capture the interplay between users and items. • SAMN[2]: A dual-stage attention model is developed to approximate the user-wise relations with their social neighbors. • DiNet[44]: It recursively updates users’ embeddings with a inuence diusion component. The user-item collaborative signals are captured through a fusion layer. • GraphRec[8]: In this framework, a graph attention framework is developed for embedding propagation between users for social relation aggregation. • DANSER[45]: It designs a dual-stage graph attention network to model multifaceted social eects in recommendation. • DGRec[32]: This social recommender system attempts to model dynamic user behavioral patterns and social inuence by integrating the recurrent neural network with graph attention layer. • NGCF[41]: It is a state-of-the-art graph neural network-based collaborative ltering model. We extend it to perform message propagation over our heterogeneous graph G. • KGAT[40]: It incorporates the knowledge graph information into the collaborative relation modeling and performs recursively embedding propagation between connected node instances. • MKR[37]: MKR is a knowledge-aware recommender system based on multi-task learning paradigm, which leverages knowledge graph representation task to assist the encoding of user-item interactions. • HERec[31]: it is a heterogeneous network embedding approach with meta-path random walk for node sequence generation. • MCRec[12]: this recommendation method incorporates the meta-path based context into the neural co-attention mechanism for recommendation performance improvement. • HAN[42]: it captures the heterogeneity of graph using the attentive encoder to dierentiate relations between users and items. 4.1.4Parameter Settings.We implement SMIN in PyTorch and optimize it with Adam optimizer. The learning process is performed with the batch size tuned amongst [1024, 2048, 4096, 8192] and learning rate of 5𝑒(with decay rate of 0.95 every epoch).𝐿regularization term with𝜆of 0.05 is adopted overΘ. The number of hidden state dimensionality𝑑is tuned from [8,16,32,64,128]. The depth𝐿of our graph neural layers in our relation heterogeneity Table 3: Ranking performance on Epinions dataset with varying Top-N value in terms of HR@N and NDCG@N encoder is chosen from 1 to 3. The number of neighbors𝑘for globallevel context injection in our graph mutual information learning architecture is set as 2. The sensitivities of those key hyperparameters have been investigated in Section 4.5. The performance of most neural methods is evaluated based on their source code. Table 2 summarizes the performance comparison between our developed SMIN and competing state-of-the-arts on three datasets. We summarize the following observations: (1). In terms of both metrics, we can observe that SMIN consistently outperforms other alternatives in all cases, which suggests the eectiveness of our method by modeling heterogeneous social and item graph dependencies (based on user- and item-wise meta relation schema) under a self-supervised graph neural architecture. (2). Among various baselines, graph neural network social recommendation models (e.g., GraphRec and DANSER) perform better than others, which suggests that the graph-structured embedding aggregation paradigm is an eective solution for social-aware recommender systems. The consistent performance gap between our SMIN and those GNN-based approaches, implies that encoding relation heterogeneity from both social and item domain could enhance graph neural architecture for recommendation. We further optimize those graph models by stacking more graph layers to t the high-order user-item interaction, but have not observed clear improvement with 𝐿 ≥ 3. (3). While NGCFalso considers the cross-user and item dependencies under a graph learning architecture, by comparing with SMIN and NGCF, we can observe that our develop mutual information learning framework results in further performance improvement compared with other graph-based model for capturing high-order user-item collaborative relations. (4). We can notice that recently proposed knowledge-aware recommendation techniques (i.e., KGAT and MKR) experience performance degeneration, which sheds light on the limitation of failing to comprehensively transfer the knowledge graph semantics into the users’ behavior modeling. Dierent from them, SMIN achieves better performance by utilizing the multifaceted relationships across users and items as self-supervised signals to guide the user preferences representation. (5). From the presented evaluation results in Table 3, the performance superiority of our SMIN can be observed under dierent top-𝑁recommended items. This observation further validates the eectiveness of our new recommendation framework. We conduct experiments to demonstrate the rationality of subcomponents in our SMIN model. To achieve this goal, we implement ve simplied variants to show the inuence of each model design. • Eect of Relation Heterogeneity Modeling. SMIN -h. We remove the metapath-guided heterogeneous graph neural network to fuse multifaceted user- and item-wise relationships. • Eect of Self-Supervised Information Encoder. SMIN-s. We do not include the multi-view graph mutual information encoder into our framework. Instead, we merely utilize graph convolution network to perform embedding propagation over the collaborative heterogeneous graph G. • Eect of Global Context Injection. SMIN -g. We remove the mutual informationMI(y;z)to inject the global-level collaborative signals based on graph substructure. • Eect of Topology-aware Isomorphic Transformation. SMIN t. In this variant, we remove the constrains of the isomorphic transformation in terms of topological node and edge characteristics, i.e., MI(h, y) and MI(Z · Z, 𝚽). • Eect of Cross-Metapath Aggregation. SMIN -a. We replace the cross-metapath aggregation layer with the mean pooling operation without dierentiating the importance of metapathspecic relational feature representations. The study results are shown in Table 4. We summarize the following ndings. (1) The performance is improved with our metapathguided self-supervised heterogeneous graph network for capturing diversied social and item-wise relations. (2) The performance gap between SMIN and SMIN -s veries the rationality of considering multi-view mutual relational signals in recommendation under a self-supervised learning paradigm. (3) Injecting the substructureaware graph global context imposes positive eect for encoding high-order user-item connectivity. (4) The careful consideration of relational learning gains more insights for modeling graph-based user-item interaction topological structure. (5) SMIN outperforms SMIN -a demonstrates the ecacy of encoding the importance of each metapath instance in an explicit way for generating user and item embeddings. This is because that each type of user-user and Table 4: Ablation Study of SMIN Framework. SMIN -h 0.6864 0.4706 0.8024 0.5934 0.8362 0.5887 SMIN -s 0.6800 0.4669 0.8034 0.5892 0.8422 0.5907 SMIN -g 0.6913 0.4769 0.8155 0.6114 0.8468 0.5903 SMIN -t 0.6833 0.4743 0.8144 0.6069 0.8456 0.5982 SMIN -a 0.6838 0.4645 0.8094 0.5909 0.8425 0.5894 item-item relations contribute dierently for the learning of useritem interactive patterns. To study the eect of multifaceted meta-relations incorporated in our metapath-guided heterogeneous graph neural network, we also perform ablation studies with the integration of dierent metarelations from user and item domain. In specic, we generate four contrast variants of SMIN as below for performance comparison: •SMIN -UU: SMIN without the user-user online social ties to capture the social network homophily, i.e., 𝑢→ 𝑢. •SMIN -UIU&IUI: SMIN without the behavior-level user and item relationships, i.e., item-specic user inuence (𝑢→ 𝑣→ 𝑢) and user-specic item dependency (𝑣→ 𝑢→ 𝑣). •SMIN -IKI: SMIN without the item semantic relatedness extracted from item relation graph 𝐺, i.e., 𝑣→ ℎ→ 𝑣. •SMIN -UIKIU: SMIN without the knowledge-aware dependency between users, i.e., 𝑢→ 𝑣→ ℎ→ 𝑣→ 𝑢. The investigation results are shown in Figure 3, we could observe that SMIN with the full set of meta-relationships obtains the best recommendation accuracy as compared to other alternatives. In particular, i) by competing with SMIN -UU, social context with the network homophily has positive eects to model user’s inuence. ii) SMIN -UIU&IUI erases the performance gain achieved by our model. This justies the importance of capturing item-specic user inuence and user-specic item dependency, in encoding relations across users and items. iii) When competing with SMIN -IKI, the results emphasizes the need of latent semantic relatedness between items in recommendation. iv) Through integrating the relational graph signals with item-specic user preference into our metapath generation phase, our scheme could further improve the recommendation accuracy as compared to SMIN -UIKIU. To gain further insights into our SMIN architecture, we now study the impact of hyperparameter settings from the following aspects. Figure 4 shows the results on dierent datasets. We integrate evaluation results (with dierent value scales) of two datasets into the same gure by presenting the performance increase/decrease percentage (compared with the rst data point) in y-axis. Hidden Unit Dimensionality 𝑑. We vary the hidden dimensionality𝑑of our latent representations from 8 to 128. The model performance saturates as the number of hidden units reaches around Figure 3: Eect analyses of meta-relation (𝑝 ∈ 𝑃) incorporation in SMIN in terms of HR@10. Figure 4: Hyperparameter study. y-axis shows the p erformance increase/decrease compared to the rst data point. 64, since the larger embedding dimensionality may bring stronger representation ability. However, the further increase of𝑑leads to the slightly performance degradation due to the overtting issue. Depth of Graph Neural Encoder 𝐿. We analyze the inuence of the number of GNN layers by varying𝐿from 1 to 3 while keeping other parameters as default settings. The best performance of our SMIN is achieved when𝐿 =2. Further stacking more information propagation layers (e.g.,𝐿 =3) leads to the worse performance, which suggests that two-order connections in our heterogeneous graph architecture is sucient to capture the multifaceted relations across users and items. Substructure-aware 𝑘-Hops Neighbors. We further examine the impact of incorporating𝑘-hop neighboring relations into our global context injection with the awareness of graph substructure. We could notice that the performance is boosted with the increase of𝑘 as 2 at the beginning stage. By modeling the global-level collaborative relations with the higher-order (𝑘 =3), it may introduce some noise and irrelevant dependence signals. We perform the qualitative study on the user and item latent representations learned by SMIN. In particular, we project the dense embedding vectors to 2-D space with the t-SNE algorithm [21]. As shown in Figure 5, we can observe that embeddings learned by SMIN present a better clustering phenomenon (denoted with the same color) compared with the embeddings of GraphRec and HERec. This suggests the eectiveness of our method in well preserving the Figure 5: Embedding visualization of users (stars) and interacted items (circles) based on dierent encoding methods. user-item interactive relationships. Additionally, a better embedding separation phenomenon can be observed for dierentiating users who interact with dierent items. These observations further verify the rationality of our graph-structured main embedding space which bridges the semantics between user and item domain, such that the external knowledge can be utilized to guide the heterogeneous relation representation. In recent years, many eorts have been devoted to developing social-aware recommendation techniques with various neural network architectures. In particular, attention networks has been used for social inuence modeling between dierent users [2,4]. Furthermore, due to the graph-structured nature of social relations, several social recommendation methods have been proposed to handle social network information with graph neural networks [17]. For instance, DiNet [44] leverages the graph convolution network to approximate the inuence diusion across users. Additionally, graph-based attentive aggregation models (e.g., DANSER [45] and GraphRec [8]) adapt attention mechanism to the user-user relation graph, capturing social signals for recommendation. However, most of those methods fail to incorporate the knowledge-aware information from item domain into the social-aware user-item interaction encoding. To ll this gap, this work develops a metagraph informax network, to enhance the social recommendation with the explicitly modeling of item-wise dependency information–containing fruitful facts and semantic relatedness about items. The objective of graph neural networks is to project nodes in a generated graph into a low-dimensional vector space [42,56]. The rationality which motivates the development of graph neural network, is that nodes are naturally characterized by their own features and neighbors [7,14,28,48]. Following this idea, many recent efforts aim to explore the user-item interaction graph structure for recommendation scenarios [47]. For example, based on the graph convolution operation, several studies propose to capture the collaborative relationships between users and items over their interaction graph, such as PinSage [53] and NGCF [41]. Later on, LightGCN [10] optimizes the GCN-based user-item relation encoder by only keeping the most essential module–neighborhood aggregation in the graph-structured message passing paradigm. This work develops a hierarchical learning framework by integrating a metapath-guided graph neural module and a substructure-aware mutual information modeling paradigm for social-aware recommender system. Self-supervised learning has shown its eectiveness in learning representations from limited labeled data, such as natural language processing [18,29,30] and image data analysis [22,25]. The general idea of self-supervised learning is to design pretext training tasks, so as to oer additional supervision signals. There exists one line of recent trend aims to propose self-supervised learning paradigms over graph-structured data [13,15,54]. For example, Hu et al. [13] proposes a pre-trained graph neural network based on the graph reconstruction task in terms of the attributed and structural information. Additionally, a hypergraph convolutional network is augmented with a self-supervised learning framework with respect to the mutual information exploration [54]. Dierent from the above methods, this work is the rst to inject the relational knowledge from user and item side as the self-supervised information into social recommendation. This will enhance the user/item representation paradigm to learn a knowledge-aware global information, which leads to better recommendation performance. Another relevant research line of recommendation methods lies in incorporating the external knowledge information as the side information of items [47,59]. These knowledge-aware recommender systems transfer structural knowledge among items to the useritem interaction modeling to improve the recommendation performance [3,49]. With the promising results of graph neural networks in relation learning, researchers have recently attempted to investigate the structural knowledge with the embedding propagation paradigm, such as KGAT [40] and KGNN-LS [36]. Dierent from these knowledge-aware recommendation methods, this paper empower recommender systems with the ability of utilizing not only the knowledge information from item domain, but also exploring the multifaceted social signals, in order to boost the performance. In this paper, we propose the Self-Supervised Metagraph Infomax Networks (SMIN) architecture for knowledge-aware social recommendation. Our model learns social and knowledge graph dependent relationships for users and items via a metapath-guided heterogeneous graph neural network. Furthermore, a self-supervised learning framework is introduced to augment the modeling of graph structural information, so as to preserve the complex relationships among users and items. Extensive experimental results on several real-life datasets demonstrate the advantage of our framework as compared to various state-of-the-art recommendation models. We thank the reviewers for their valuable comments. This work is supported by National Nature Science Foundation of China (62072188), Major Project of National Social Science Foundation of China (18ZDA062), Science and Technology Program of Guangdong Province (2019A050510010).