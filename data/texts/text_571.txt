Abstract—Effective wireless communications are increasingly important in maintaining the successful closed-loop operation of mission-critical industrial Internet-of-Things (IIoT) applications. To meet the ever-increasing demands on better wireless communications for IIoT, we propose an orthogonal time-frequency space (OTFS) waveform-based joint communication and radio sensing (JCAS) scheme — an energy-efﬁcient solution for n ot only reliable communications but also high-accuracy sensi ng. OTFS has been demonstrated to have higher reliability and energy efﬁciency than the currently popular IIoT communication waveforms. JCAS has also been highly recommended for IIoT, since it saves cost, power and spectrum compared to h aving two separate radio frequency systems. Performing JCAS based on OTFS, however, can be hindered by a lack of effective OTFS sensing. This pap er is dedicated to ﬁlling this technology gap. We ﬁrst design a series of echo pre-processing methods that successfully remove the impact of communication data symbols in the timefrequency domain, where major challenges, like inter-carrier and inter-symbol interference and noise ampliﬁcation, are addressed. Then, we provide a comprehensive analysis of the signal-tointerference-plus-noise ratio (SINR) for sensing and optimize a key parameter of t he proposed method to maximize the SINR. Extensive si mulations show that the proposed sensing method approaches the maximum likelihood estimator with respect to the estimation accuracy of target parameters and manifests applicability to wide ranges of key system parameters. Notably, the complexity of the proposed method is only dominated by a two-dimensional Fourier transform. Index Terms—Internet-of-Things (IoT), industrial IoT (IIoT), orthogonal time-frequency space (OTFS), joint communication and radar/radio sensing (JCAS), range/velocity estimation. Industrial Internet-of-Th ings (IIoT), as a key variant of Internet- of-Thin gs, is essentially “a network of physical objects, systems platforms and a pplications that contain embedded technology to communicate and share intelligen ce with each other, the external environment and with people” [1]. In terms of the way “thin gs” communicate in IIoT, wireless links become increasingly preferred over wired counterparts, since the former has some un ique ad vantages, e.g., greater ﬂexibility and higher cost-efﬁciency [2]. Although some wireless solutions are available alre a dy, e.g., ZigBee, LoRa, NB-IoT and LTE-M etc. [3], the evolving IIoT constantly r a ises new challenges. A major one is the in creasing demand of massivescale wireless networks for mission-critical IIoT applications, subject to low-latency, high-reliability communications and strict power constraint [4]. In line with the enormous research effort for enhancing future IIoT, we advocate two techniques — the joint communication and radar/radio sensing (JCAS) and the orthogonal time-frequency space modulation (OTFS) — both are investigated for 6G r e cently [5]–[9]. JCAS is proposed to use one hardware platform an d one waveform to perform two radio frequency (RF) fun ctions, i.e., communic a tions an d sensing, thus saving the cost and power as compared to having two separate transmitters [5]. More over, using one waveform for both RF functions can help relieve the in creasingly severe spectrum congestion and crowdedness [6]. Due to its high cost-/power-/spectrum-efﬁciency, JCAS has been highly recommended for IoT [10], [ 11]. In add ition, in many IIoT applications, such as intelligent tran sportation, sensing nodes only need to share some basic parameters, such as ranges and velocities, with other nodes [7]; there is no need for employing sophisticated radar equipments. Therefore, JCAS is an attractive and potentially important tech nology for future IIoT, especially for mission critical ones. To b etter support the high-mobility use cases in mobile communications, OTFS is proposed to modu la te data symbols in the delay-Doppler domain that generally promises longer channel coherence time than the conventional time-frequency domain [9]. It is worth noting tha t hig h mobility is becoming a common scenario in IIoT, due to the incr easingly use of highspeed platf orms, e.g ., satellites and drones [12]. Moreover, OTFS also has a smaller peak to average power ratio (PAPR) than OFDM [13], which makes OTFS more suitable to work under strict power budget. In addition, OTFS can per form better than OFDM a nd SC-FDMA in IIoT commun ic ations that tend to use small-size packets. This is because, despite packet size, OTFS always spr eads informa tion over the whole time-frequency channel in use, thus being able to use the time-frequency-domain diversity to combat cha nnel fading; in contrast, the interleaving and coding, as relied on by OFDM and SC-FDMA to survive channe l fading, generally require a large p a cket size [14]. Given its advantages over OFDM and SC-FDMA in typical I IoT use scenarios/constraints, OTFS can potentially b e an excellent waveform candidate for future IIoT. Since JCAS and OTFS are both p romising to further enhance the performance of IIoT com munications, combining the two techniq ues is a natural choice. However, one question remains: ho w to achieve effective RF sensing using OTFS waveforms with such a low complexity that a power- a nd computing-limited IIoT device can afford? Here, OFTS sensing is referred to as estimating the ranges and velocities of targets, e.g., cars and drones etc. So far, only few published papers dealt with OTFS sensing. In [15], an iterative optimization procedure is developed to solve the ML-based OTFS sensing problem. In each iteration, all the targets are alternatively estimated, o ne at a time, by searching for the channel matrix that minimizes the signal-tointerference ratio (SIR). The channel matrices are generated based on pre-selected delay-Doppler grids. In [16] and [ 17], matched ﬁltering is performed for OTFS sensing, where the ﬁlter c oefﬁcients are constructed on pre-deﬁned delay-Doppler grids. Different from the above works [15]–[17] focusing on the delay-Doppler domain, the work [13] develops a generalized likelihood ratio test (GLRT) detector in the tim e domain, where the inter-carrier interference (ICI) and inter-symbol interference (ISI) are used to surpa ss the ambiguity barrier. The GLRT problem is solved by enumerating pre- deﬁned delay-Doppler grids; the ones making the likeliho od ratio larger than the thr eshold are taken as parameter estimations of radar targets. A common feature of the OTFS sensing methods developed in [13], [15]–[17] is that, despite the domain where the estimation problem is formulated, they estimate target parameter s by searching over a set of delay-Doppler grids. When testing each grid, a metr ic needs to be calculated with multiplication s of large-dimension a l matrice s/vectors involved. Thus, these methods [13], [15]–[17] may not be computationally efﬁcient enoug h for IIoT devices with strict limits on power and computing resources. I n addition, the methods in [13], [15]– [17] all require a certain number of sensing channel matrices, where the number is e qual to that of the overall delay-Doppler grids. Although th e channel matrices can be calculated off-line, large storage is then req uired to save them on -board, whic h is hardly feasible for IIoT devices. Different from the existing methods reviewed above, we present a low-complexity OTFS sensing in th e time-frequency domain that has not been investigated yet. Th e idea is inspired by the conventional OFDM sensing, where commun ic ation data symbols can be readily removed in the time-frequency domain, then a range- D oppler proﬁle is obtain e d through a simple two-dime nsional Fourier transform and the peaks in the range-Doppler pro ﬁle are identiﬁed for target detection [18], [19]. D espite the close rela tion between OTFS and OFDM, sensing in the time-frequency doma in can be very difﬁcult for OTFS. A major challenge is that communication data symbols are non-trivial to rem ove in OTFS sensing. To im prove data rate, OTFS tends to use a single cyclic preﬁx (CP) for a whole block o f data symbols [20]. Such a b lock may equivalently consist of a number of equivalent (in length) OFDM symbols, each with an individual CP. If an OTFS block is processed as a whole, the ICI and ISI issues can be promin ent [13]. That is, an unknown combination of more than one data symbols can b e conveyed by each sub-carrier at the sensing re c eiver, making the removal of data symbols difﬁcult, if not infeasible. Moreover, even if one manages to recover the sub-carrier orthogonality, the majority of data symbols, conforming to a centered Gaussian distribution in the time-frequency domain, can be near zero. Thus, directly dividing data symbols can largely amplify backgrou nd noise [21], thus degrading sensing performance. (The distribution of data symbols in the timefrequency domain will be further illustrated in Remark 2.) In order to realize OTFS-based JCAS for future IIoT, we present a low-complexity OTFS sensing method that has a near-maximum likelihood (ML) performance. Not only the above-mentione d challenges are effectively add ressed, but also the optimization of the pr oposed method is performed to maximize its sensing performance. As OTFS communications have been widely studied [9], [14], we only focus on the sensing aspec t in this pa per. Our key contributions include: 1) We develop an OTFS sensing framework that is independent of communication data symbols and off-grid. The framework is underpinned by several inn ovations. First, we propose a series of waveform pre-processing metho ds that recover the sub-carrier orthogonality in the presence of severe ICI and ISI in OTFS. Second, we devise an effective way of removing communication data symbols in the time-frequency do main, yet without amplifying the backgr ound noise. Third, we develop a hig h-accuracy and off-grid method for estimating ranges and velocities of targets. 2) We optimize the key parameter of the proposed OTFS sensing framework to maximize the sensing performance. In doing so, we ﬁrst derive the power expressions of different signal comp onents. Then we provide comprehensive analyses, revealing the monotonicity of the power functions of both useful and non-useful signals in terms of the key parameter. Moreover, the optimal value of the parameter is derived, showing insights into the impact of system parameters on sensing perf ormance. 3) We perform extensive simulatio ns to validate the proposed designs and analyses. We ﬁrst provide a set of comparison simulations with the state-of-the-art OTFS sensing method [15] that is based on the maximum likelihood (ML) estimation. This ﬁrst set of resu lts demonstra te the nearML performance of our OTFS sensing meth od. Moreover, our design is seen to have an even performance across a wide r egion of velocity, e.g., [0, 360] kilometer p er hour (km/h); whereas, the ML method [15] presents a veloc itysensitive estimation performance. We then use another set of simulations, validating the pre cision of the SINR analysis, parameter optimization and the app licability of the propo sed method in wide regions of system parameters. The remainder of the paper is organized as fo llows. Section II depicts the signal mod el of OTFS system. Starting with an illustration of the ICI issue in OTFS sensing, Section III then proposes a series of pre- processing to recover subcarrier orthogonality and rem ove communication inf ormation. Section IV develops a high-accuracy parameter estimation method and analyzes the overall computational complexity of the proposed sensing scheme. Section V optimizes the key parameter of the proposed method to maximize the sensing SINR, followed by simulations and conclusions in Sections VI and VII, respectively. Consider a communication node that transm its a block of MN(= M · N ) data symbols using OTFS modulation. Let d(i = 0, 1, ··· , M N − 1) denote the data symbols which are independently drawn from the same constellation, e.g., 64QAM. These symbols are ﬁrst placed in a two-dimensional plane, referred to as the delay-Doppler do main. Assume that the delay and Doppler dimensions are discretized into N and M grids, respectively. Denoting the time duration of M data symbols as T , the sampling freque ncy along the Doppler dimension is then, which leads to a Doppler resolutio n of. Since the time duration of M grids in the delay dimension is T , the grid resolutio n along the dimension is. In OTFS modulation, the data symbols can be mapp ed from the delay-Doppler domain into th e tim e-frequency domain via the following inverse symplectic Fourier transfor m [14], where j denotes the imaginary unit, ∆is the sub-carrier interval, and the second result is ba sed on the critical sampling, i.e., ∆T = 1. Mod ulating S[m, n] onto the m-th sub-carrier, we obtain the following time-domain signal, s(t) =1√S[m, n]g(t − nT )e, where g(t) is a pulse shaping waveform [20]. With a CP added to an OTFS block, the transmission waveform of the block becomes ˜s(t) = s(ht − Ti), 0 ≤ t ≤ N T + T where Tdenotes the time duration of a CP, and hxitakes the modulo -y of x. In this paper, we con sid er the active sensing , wher e the sensing receiver is co-located with the communication transmitter. Thus, it is reaso nable to assume prefect synchro nization and zero frequency offset at the sensing receiver. Consider P targets. The scattering coefﬁcient, time delay and Doppler frequency o f the p-th target are denoted by α, τand ν, respectively. The target echo consists of the sum of scaled and d elayed versions of ˜s(t), leading to where w(t) is an a dditive white Ga ussian noise. Remark 1: For illustration clarity and analytical tractability, we make some basic assumptions on the signal model. First, the single antenna transmitter and receiver is focused on to introdu ce the new designs and methods. Second, the recta ngular pulse shaping is used. Third, the Swerling-I target mode l is employed, which indicates th at α(∀p) is ﬁxed within a coherent processing interval (CPI) of sensing and conforms to a complex Gaussian distribution over CPIs [22]. Here, we regard the time duration of an OTFS block, i.e., N T , as a CPI. Fourth, we consider uncorrelated target scattering coefﬁcients, i.e., E {αα} = 0, ∀p 6= p, where E {·} takes expectation. Remark 2: We remark here on the Gaussian randomness of S[m, n]. With the independently drawn d ata sym bols d’s, the l-related summation in (1), as denoted by˜S[m, k] =P and hence conforms to a complex cente red Gaussian distribution approximately [23]. Sin ce the above l-related summation is scaled by, it acts as an unitary tran sf orm. The variance of˜S[m, k] then equals to the average power of d(∀i), as denoted by σ. For any m, we can regard {˜S[m, 0],˜S[m, 1], ··· ,˜S[m, N −1]} as a white Gaussian noise sequence. Since the unitary DFT d oes not ch ange the Gaussian randomness and its whiteness [24], the-scaled, k-related summation in (1) results in a white Gaussian noise sequenc e; namely, S[m, n] ∼ CN(0, σ) and is independent over ∀m, n. In this section, we develop a low-complexity sensing method based on OTFS-modula ted communication waveform. Similar to the transmitter, the critical sampling is performed at the receiver, leading to the following sampling interval where B denote s the bandwidth. The digitally sampled x(t) with CP removed can be given by where l= τ/T. The modulo operator makes s[hi − li] a circularly shifted version of s[i] which is the i-th digital sample of s(t) given in (2). If MN were such a small valu e that th e phase shifts caused by the Doppler frequency remained approxima tely unchanged across i = 0, 1, ··· , MN − 1, we would be able to take an MN-point DFT of x[i] given in (5), achieving X[j] ≈αeS[j]e+ W [j], where S[j] is the MN-point DFT of s[i] and W [j] is that of w[i ]. Since s[i] is k nown to the sensing receiver, S[j] is also available. Dividing X[j] by S[j] in a point-wise manner, the remaining signal becomes a sum of P discrete exponential signals, namely e(j = 0, 1, ··· , M N − 1). The frequency of any exponential compo nent is solely related to the sample delay of a sing le target. Thus, the range estimation is turned into the well studied frequency estimation [25], [26]. Clearly, being able to obtain (6) is he lpful and also desirable for estimating target parame ters, which, however, is challengin g in practice. This is because the value of MN or νcan make the variation of the Doppler-induced phase, i.e., egiven in (5), non-negligible in an OTFS block. The ICI caused by the non-negligible Doppler impact destroys the sub-carrier orthogonality, thus preventing the removal of communication data symbols. Below, we introduce some preprocessing on x[i] to ﬁrst rec over the sub-carrier orthogonality and th e n remove the da ta symbols. In light of the conventional coherent ra dar signal processing, we propose to segment a whole OTFS block (c.f., a radar CPI) into multiple sub-blocks (c.f., radar pu lse repetition intervals, PRIs). As shown in Fig. 1, the segmentation is done at the sensing receiver and does not require OTFS transmitter toles change its signal format. Let˜N denote the number of subblocks and˜M the number of samples in a sub-b lock. Note that it is not required to have˜M = M or˜N = N, but˜M˜N ≤ M N is nece ssary. Provided that the following condition holds, the target echo in the n-th sub-block can be written into ≈˜αs[n˜M + m − l]e+ w[m], (8b) where ˜α= αeand w[m] = w[n˜M + m]. The approximation is obtained by plugging (7) into (8a). Note that the modulo operator, only affecting the ﬁrst sub-block, is dropped in (8b) for notatio nal simplicity. To help un derstand the f easibility of the approximation in (7), we provide a numerical example based on the 5G numerology, where˜MT=microsecond (ms) [27]. Note that˜M here r esembles the number o f samples per symbol. For the carrier frequency of 5 gigahertz (GHz) and velocity of 500 kilometer per hou r (km/h), the Doppler frequency is ν= 4.63 kilohertz (KHz). Applying these values in ( 7), we obtain that ν˜MT= 9.6 × 10≈ 0. Substituting the result in (8a), we further obtain e≈ 1, ∀m ∈ [0,˜M −1]. To reduce the approximation error in (7), a smaller˜M is better. As will be seen subsequently, the value of˜M also has other impact on the sen sing p e rformance of the proposed design. In fact,˜M is a critical parameter in our design. In Section V, w e will optimize˜M to maximize the sensing perfor mance. The second design we propose is refer red to a s the virtual cyclic preﬁx (VCP). The motivation of this design is to turn the echo signal in each sub-block into a sum of th e scaled and circularly shifted versions of the same signal sequence. To achieve this, we have seen from (5) and (6) that a CP is required for the signal sequence (based o n which a DFT is taken). However, the OTFS considered here only has a single Fig. 1: Illustrating the proposed virt ual cyclic preﬁx (VCP), where idenotes the minimum sample delay, ithe maximum, and ‘NE’ stands for ‘non-essential’. We emphasize that segmenting and adding VCP are performed on the sensing receiver side, without requiring any changes made on the OTFS transmitter. CP for a large block; see Fig. 1. Theref ore, we propose to create our own CP from the received signals, hence named virtual CP. The proposed VCP is performed on the sensing receiver side solely and does not require the OTFS transmitter to make any changes, e.g., inserting regular CPs as O FDM . In particu la r, the proposed design of adding VCP is illustrated in Fig. 1. Each sub-block is divided into two parts: the ﬁrst part, consisting of (˜M − Q) samples of each tr ansmitted block, is the essential part, while the second part, consisting the remaining Q samples, is the non-essential part. At the sensing receiver, a sub-block is delayed to different extent, after being reﬂected by different targets. From Fig. 1, we see that as long as Q is n o smaller than the maximum sample delay, we can add the sampled sign als in the non-essential segment onto the ﬁrst Q samples of the essential part, and then obtain the circularly shifted versions of the signals in the essential part. Therefore, the non-essential part of each subblock acts as a VCP. Note that Q does not have to take the same value as the CP length of the underlying communication system. This is a new ﬂexibility — the maximum range detection is not restricted by the CP length of the underlying multi-carrier communica tion system — as ensu red by our design and no t owned b y many previous JCAS schemes. Note that the practical implementation of the p roposed sensing design is similar to the conventional continuous-waveform radar. As mentioned in Sec tion II, we consider the synch ronized transceiver in this pape r. Thus, the receiver receives echo sig nals while the communication transmitter transmits OTFS signals. In practice, the segmentation parameters, i.e., ˜M and Q, can be pr e-determin e d based on the analysis to be performed in Section V. So, within the synchronized timing frame, the receiver can segment both the original transmitted signal (as shared by the transmitter) and the echo signa l, and can add VCPs for sub-blocks, as described in Fig. 1. After signal preprocessing, the receiver can then estima te target parameters using the method to be developed in Section IV. Let ˜s[m] denote the essential signal part of the n-th transmitted su b-block . Referring to Fig . 1, we have ˜s[m] = sn˜M + m, m ∈ [0,¯M − 1] (¯M =˜M − Q), where¯M is introduced to simplify notation. After adding the proposed V CP for the n-th sub-block, the target echo can be rewritten based on (8), as given by where z[m] denotes the inter-block interference for the n-th sub-block and z[m] the intra-block inte rference. Based on the illustration in Fig. 1, z[m] can be expressed as and z[m] can be given by where g[u] (x ≤ Q −1) is deﬁn e d as g[u] = 1, for u ∈ [0, x − 1]; g[u] = 0 for u ∈ [x, Q − 1 ]. Note that the two interferen c e terms, z[m] and z[m], are the price paid for introducing VCP. Nevertheless, we notice that z[m] and z[m] can be treate d as Gaussian noise uncorrelated with the essential signal part of the n-th subblock. Lemma 1 provides some useful features of the different signal components in (10). Its proof is provided in Appendix A. In addition, we point out that the impact of the two interference terms can be minimized by properly c onﬁguring ˜M. This will be detailed in Sec tion V. Lemma 1: The signal compone nts in (10), i.e., ˜s[m], z[m], z[m] and w[m], are approximately independent over m = 0, 1, ··· ,¯M −1, and are mutually uncorrelated complex centered Gaussian variables satisfying ˜s[m] ∼ CN(0, σ), z[m] ∼ CN(0, σ[m]),(13) z[m] ∼ CN(0, σ[m]), and w[m] ∼ CN(0, σ), where σis the average power of communication data d(∀i), σ[m] takes the discrete values summarized in Table I, and the possible values of σ[m] a re given in Table II. Taking the¯M-point DFT of ˜x[m] obtained in (10) w.r.t. m, we obtain where˜S[l], Z[l], Z[l] and W[l] are the¯M-point DFTs (w.r.t. m) of ˜s[m], z[m], z[m] and w[m], respectively. Since ˜s[m] is k nown to the sensing re c eiver,˜S[l] can be calculated as where Zis the (j, i)-th entry of an x-point unitary DFT matrix. As will be frequently used , the following features of the signal components in (19) are worth highlighting. The proof is given in Appendix B. Lemma 2 : Given ∀n, l, the sig nal components in (14) satisfy ˜S[l] ∼ CN(0, σ), W[l] ∼ CN(0, σ), Z[l] ∼ CN(0, σ), and Z[l] ∼ CN(0, σ), where each c omponent is inde pendent over ∀l. Assuming that l(∀p) is un iformly distributed in [0, Q − 1], we then have where iand iare th e maximum and minimum sample delay, resp ectively. From (14), we see that c ommunication information can be suppressed by dividing both sides of the eq uation by˜S[l]. This, however, can yield signiﬁcant bursts in the resulted signal, due to the Gaussian randomness of˜S[l]. To reduce the bursts, we p ropose to use k˜S[l] as the divisor. The rationale ofno introdu cing k is: multiplying k(> 1 ) can increase Vk˜S[l]no and then decrease C|k˜S[l]| ≤ 1, ∀l. Here, V {x} denotes the variance of a random variable x and C {·} the event count. The following lemma helps conﬁgure k and its proof is given in Appe ndix C. Lemma 3: For P|k˜S[l]| ≤ 1= ǫ (∀n, l), we can set where ǫ denote s a sufﬁciently small pro bability. Z[l] +W[l], I[l] =, (19) where th e intermediate variables are given by ˜Z[l] = Z[l]/(k˜S[l]),˜Z[l] = Z[l]/(k˜S[l]), In case |k˜S[l]| < 1 (although unlikely given a properly selected k), I[l] can help prevent noise enhanceme nt. We remark that the way we remove communication information is similar to the widely used OFDM sensing [18]. However, we emphasize that it is our design proposed in Sections III-A and III-B that enable OTFS sensing to be p erformed in such a simple manner. On the other hand, we notice that when dividing communication data symbols in OFDM sensing, the noise enhancement is not an issue in general, as PSK (w ith constant modulus) is assumed in most OFDM sensing works. In contrast, we are dealing with OTFS modulation that obtains the signals in the time-frequency domain through a symp le ctic Fourier transform; see (1), making noise enhancement issue rather severe. But thanks to the desig n and analysis in this section, the issue can be greatly relieved. We also remark that the pointwise division (PWD) performed in (19) can be replaced by pointwise product (PWP). As PWP is per formed in the frequency domain , taking the IDFT of the PWP result leads to the cyclic cross-correlation of the corr esponding time-domain signa ls, similar to the matched ﬁltering in conventional radar processing. The SINRs in the range-Doppler maps (RDM) generated by PWD and PWP have interesting relation s, as revealed in [28]. In particular, in low SNR regions, the PWP-SINR is higher than PWD-SINR, while the relation reverses in high SNR regions. Inter e sted readers are referred to [28] for more details. Enabled by the proposed pre-processing on the target echo, the resulted signal˜X[l] presents a clear structure. In particular, we see from (19) that eand e are two single-tone signals whose frequencies are r elated to target range an d velocity, respectively. Therefore, parameter estimation in OTFS sensing is turned into e stima ting the center frequencies of the multi-tone signa l˜X[l]. To fulﬁll the task, we develop a low-complexity and high-accura cy method, combining the commonly used estimate-and-subtra c t strategy [29], [30] with the frequency estimator we recently proposed in [ 26] for a single-tone signal. Below, we ﬁrst illustrate the pa rameter estimation method and then analyze the computational complexity of the whole OTFS sensing scheme. Input:˜X[l], as given in (19), and P (the number of targets) 1) Initialize p = 0; 2) Update˜X[l] as done in (21); 3) Estimate (˜l, ˜n) as done in (24); 4) Estimate δand ǫby running Algorithm 2; 5) Obtain the estimates of land νas given in ( 32); 6) Estimate αas done in (33); 7) End if p = P − 1; otherwise, p = p + 1 and go to Step 2). The overall estimation procedure is summarized in Algorithm 1. In each iteration, we always estimate the parameters of the presently strongest target, as done in Steps 3 ) to 6) of the table; reconstruct th e echo signal of the target and subtract the reconstructed echo signal, as done in Step 2); and reperform the above three steps fo r the next strongest target. For ease of illustration, we assume that the p-th (∀p) target has strong er echo than the p-th (∀p> p) target, namely |˜α| > |˜α| > ··· > |˜α|. Thus, the signal used for estimating the p-th target can be given by s.t. p ≥ 1,˜X[l] =˜X where˜X[l] d enotes the signal used for estimating the (p−1)-th target, and ˆα,ˆland ˆνdenote the estimated parameters of the target. As mentioned earlier, eand ein (19) are exponential signals along l a nd n, respectively. Therefore, we can ide ntify their cente r fr e quencies thro ugh a twodimensional DFT: where Zand Zare the DFT bases deﬁned in (15). Note that all irrelevant terms, in cluding interference plus noise terms given in (19) and the echoes of weaker targets p(= p + 1, ··· , P − 1), are absorbed in Ξ[˜l] for b revity. Moreover, the function S(y) in ( 22) is deﬁned as Note that S(y) is a discrete sinc function which is maximized at y = 0. Therefore, the integer parts of (l, n) ca n be estimated by identifying the maximum of˘X[˜l], i.e ., 1) Input:˜X[l] given in (21), (˜l, ˜n) in (24) and N(the maximum number of iterations); 2) Initialize:ˆδ= 0.25dand i = 1, where dis given in (28); 3) Interpolate the DFT coefﬁcients at˜l =˜l=˜l+ˆδ±0.25, leading to˘X[˜l] given in (25); 4) Construct the ratio of ρ=, s.t. x=˘X[˜l]; 5) Calculate r(i = 0, 1, 2) as done in (27 ) ; 6) Estimate ξasˆξ= r, s.t. i= argmin|r|; 8) Set i = i + 1 and go back to Step 3), if i < N; 9) Output: the ﬁnal esti mateˆδ=ˆδ+ˆξ. To obtain h igh-accuracy estimations of target para meters, the fractional parts of (l, n) ∀p, as denoted by (δ, ǫ), also need to be estimated. With referen ce to [26], we develop below the methods for estimating δand ǫ. We start with δ. As summarized in Algorithm 2, its estimation is performed iteratively. At iteration i(≥ 1), we have the estimate of δfrom the iteration (i − 1), as denoted byˆδ. Let ξ= δ−ˆδdenote the estimation error which is estimated in Steps 3) to 6). In Step 3), the interpolated DFT coefﬁcients are given by where (˜l, ˜n) is obtained in (24) and˜l=˜l+ˆδ±0.25. In Step 4), the ratio ρis construc ted such that it can be regarded as a noisy value of the function f (ξ) given in (26). Note that the result “= ” in (26) is ob ta ined by suppressing the common terms of the num erator and denom inator and by replacing˜l− lwith Equating f(ξ) and ρ, ξcan be estimated by solving th e equation. As derived in [26], there are three roots, r= −k/3 + 2B, r= −k/3 − B + D, r= −k/3 − B − D,√ s.t. B = (S + T )/2, D =3(S − T )j/2,qq R = (9kk− 27k− 2k)/54, Q = (3k− k)/9, where c, cand care the coefﬁcients of the ﬁrst, third and ﬁfth power term s in the Taylo r series of f(ξ) at ξ= 0. Only one root provides the estimate of ξ, as determined in Step 6). Next, we update the estimate of δin Step 7), check the stop criterion in Step 8) and, if unsatisﬁed, run another iteration. Above is th e general iteration proced ure. As for the initialization of the algorithm, dis the result of the fo llowing sign test: where˘X[˜l] is obtained by plugg ing ˜n = ˜nand˜l =˜l into (22) and likewise˘X[˜l± 1] is obtained . Above, the estimation steps are given with the rationales suppre ssed for brevity. Interested reade rs may refer to [26] for mor e details. We notice that ǫcan also be estimated as done in Algorithm 2, with necessary changes pointed ou t in the table. For ǫ, the estimation er ror in the iteration i(≥ 1) is denoted by where ˆǫis the estimate from the previous iteration. The DFT interpolation in Step 3) now happens at ˜n = ˜n= ˜n+ ˆǫ± 0.25 and the interpolated coefﬁcients are given by which can be likewise inte rpreted as˘X[˜l] given in (25). Moreover, corresponding to f (ξ) given in (2 6), we now h ave which is used for computing the three roots according to (27). After running Algorith m 2, we obtainˆδand ˆǫ. Adding them with˜land ˜ngiven in (24), the estimates of land ν can be written as. where the relation between nand νis shown in (22). Substitutingˆland ˆνinto (22), the complex coefﬁcient ˜α can be estimated as. where the values of the two discrete sinc functions can be readily calculated based on (23). Next, we analyze the computational complexity (CC) of the proposed OTFS and compar e it with the existing methods. For pre-processing the echo, as illu strated in Section III, the only computation-intensive computatio ns are given in (14) and (19) which perform˜N numbers of¯M-dimensional DFT and an ˜N¯M-size point-w ise division, respectively. Thu s, the CC of echo pre-processing is in the order of O{˜N¯M log¯M}. For the proposed parameter estimation method, as summarized in Algorithm 1 , its CC is analyzed below. as done in (22), incurring the CC of O{˜N¯M log(¯M˜N)}. Step 3) also requires P times of searching for th e peak in an ˜N ×¯M-dimensional r a nge-Doppler p roﬁle, yielding th e CC of O{P˜N log¯M}. Since˜N¯M log(¯M˜N) ≫ P˜N log¯M, the overall CC of Step 3) in Algorithm 1 is O{˜N¯M log(¯M˜N)}; In each time, th e a lgorithm is performed twice, one for range estimation and ano ther for Doppler. Moreover, the CC of Algorithm 2 is dominated by the interpolation in Step 3) [26] and is given by O{(2N+ 1)¯M} and O{(2N+ 1)˜N}, respectively, for range and Doppler estimations. Thus, Step 4) of Algorithm 1 has a CC of O{(2N+ 1)P x} with x = max{¯M,˜N}. As will be shown in Section VI, a small value of N, e.g., ﬁve, can ensure a near-ML estimation performance of Algorithm 2. Moreover, P is typically smaller than˜N or¯M in practice. In summary, we can assert that the CC of the proposed OTFS sensing scheme is domina te d by that of the two-dimensional DFT perfor med in Step 3) of Algorithm 1. Since the ML-based OTFS sensing m e thod [15] will be employed as a benchmark in the simulations, we provide below its CC as a comparison. As a lower bound on its CC, we only take into account the ﬁrst iteration of the ML method under a single target assumption. Fro m (22) and its context in [15], we can see that the number of range-Dop pler grids is NN, where Nis the number of samples in the CP of the unde rlying OTFS communication system a nd N is the size of the Doppler dimension. For ea ch grid, the likelihood ratio given in [15, (21)] needs to be calculated, yielding the CC of O{(M N )}. Thus, a lower bound of the overall CC of the ML method can be given by O{NMN}. Based on ( 9) and the text above (7), we have¯M =˜M −Q <˜M a nd˜N¯M <˜N¯M < MN, and hence˜N¯M log(¯M˜N) ≪ NMN. This demonstrates the high computational efﬁciency of the proposed OTFS sensing. Before ending the section, we remark on the potential extension of the prop osed method to a m ultiple-input and multipleoutput (MIMO) system with indepe ndent sign als transmitted from all a ntennas. Based on Remark 2, we know that the transmitted signals h ave low mutual cross-correlations. This suggests that we can perform the methods developed in Sections III and IV on the signal received by each receiver antenna using each transmitted sign al as (3), as in a conventional orthogonal MIMO radar. However, ˜x[m] obtained in (10) will have an extra interference term, owing to the cross-correla tions among transmitted signals. Though the in te rference does not affect the way the proposed methods are performed, it can degrade sensing performance. Thu s, optimizing the transmitted waveforms to reduce their cross-correlations, subject to a satisfactory com munication performance, c an be an interesting future work. In th is section, we optimize the proposed sensing scheme by deriving the optimal˜M such that the estimation SINR is maximized. To start with, we de rive the respective power expressions of the usef ul signal, interference and noise c omponen ts in the input of the algorithm given in Algorithm 1; namely˜X[l] given in (19). In doing so, we ﬁrst recover the accurate signal model without neglecting the intra-symbol Doppler impact. By using the accurate signal model in (8a), in con trast to using (8b) in Section III, the signa l in (10) can be rewritten as where, to account for the in ter-carrier interference (ICI), the time-dom ain signal ˜s[·] is replaced by its inverse IDFT, as enclosed in the round bra c kets. Strictly speak ing, z[m] and z[m] are different fro m those given in (11) an d (12), sinc ehi ˜sm +˜M − land ˜sm +¯Mare multiplied by extra exponential terms in a point-wise manner. The mu ltiplication, however, changes neither the white Gaussian na ture of z[m] and z[m] nor their variances. This can be validated based on Append ix A. Thus, we continue using the same symbo ls here. Based on the new expression of ˜x[m],˜X[l], as g iven in (19), can be rewritten as in (35), where the co e fﬁcientin˜X[l] comes from the product of ZZand the coefﬁcient in˜X[l] is likewise prod uced. For the same reason that z[m] and z[m] are reused in (34), we continue u sin g Z[l], Z[l] and˜W[l] in (35). Next, we ﬁrst derive the power expressions of the four components in (35) and then study their relations. Some handy features that will be frequently used later are introdu ced ﬁrst. We notice that the p-related summation is involved in˜X[l] and˜X[l]. Lemma 4 is helpful in simplifying the calculations of their powers. We also notice that the ra tio of c omplex Gaussian variables appears in˜X[l] and˜X[l]. The ﬁnite moments of such ratio does not exist [32]. Thus, we provide Proposition 1 to approximate the variance of the ratio. The pro of of the pr oposition is given in Appendix D. Lemma 4: Let X d e note a general expression. We have where V {x} denotes the variance of x. Proof: As illustrated in Remark 1, we consider i.i.d.nPo zero-mea n α(∀p). Thus, EαX= 0. Then, the variance can be calculated as where the cross-terms are suppressed due to Eαα= 0 given ∀p6= p. Proposition 1: Let x ∼ CN(0 , σ) and y ∼ CN(0, σ) denote two uncorrelated complex Gaussian variables. Deﬁning z =, we hav e E {z} = 0. Provided that P {|y| ≤ 1} = ǫ, σ≪ σand ρ = σ/σ, the variance of z can be approximated by σ≈ b(ǫ)ρ, s.t. b(ǫ) = 2ln2(1 − ǫ)p− 1. (37) Power o f˜X[l]: A pplying Lemma 4, the variance of˜X[l] given in (35), as deno ted by σ, can be calculated as where the approximation is due to the Taylor series used for calculating Π, as illustrated in Appendix E. Power o f˜X[l]: Applying Lemma 4, the variance of˜X[l] given in (35), as deno ted by σ, can be c alculated as = b(ǫ)k(a¯M− a), s.t. a =πT3σν(39) where E= b(ǫ)kaccordin g to Lemma 2 and Proposition 1, and Γ is calculated in (40) ( a t the top of next page). In the calculation, the result= is ob ta ined by separately considerin g the summation over l= 0, 1, ··· ,¯M −1 (leading to Γ) and the special case of l= l (which happens to become Π/¯M). As calculated in Appendix F, Γ= σ. Then, combining the result of Π ca lc ulated in App e ndix E, we obtain the result= in (4 0). Power of˜X[l]: According to Lemma 2, Z[l], Z[l] and˜S[l] are zero-mean complex Gaussian variables. Thus, applying Lemma 1, we have where σis given in (17). Likewise, we obtain (35), as denoted by σ, can be calculated as b(ǫ)i(p + 1)σ+ (Q −i)P(P − p)σ ≤b(ǫ)Q(P + 1)σkP¯M, s.t. σ=σ where the two expectations are approximately zeros, as proved in Appendix G. The equality in the last line can be achieved when the two conditions are satisﬁed, i= 0 and i= Q. These conditions are likely to hold for a large P , since the larger P is, the more variety can present among targets. Power of˜W[l]: According to (19), we have˜W[l] = W[l]/(k˜S[l]) which is the ratio of two complex Gaussian. Thus, directly applying Proposition 1 gives us where V {W[l]} = σ, as proved in L emma 2. With the power of individual signal components in˜X[l] d erived, we proceed to analyze the overall SINR for the proposed parameter estimation method a nd de rive the optimal˜M. Note that a two-dimensional DFT along n and l is taken fo r˜X[l] before e stima ting target parameters; see A lgorithm 1. The maximum SINR improvement brought b y the DFT is¯M˜N; see (22). This is because˜X[l] is coherently accumulated with the maximum a mplitude gain of¯M˜N, while˜X[l] and˜X[l] are only incoherently accumulated with the power gain of¯M˜N. With the SINR gain of¯M˜N taken into account, the overall SINR for parameter estimation can be given by where σ, σ, σand σare derived in ( 38), (39), (41) and (42), respectively. To avoid overly cumbersome expressions, we denote the numerator and denomin ator as different function of¯M and study their monotonic features separate ly. In particular, the following interesting results are achieved, with the proof given in Appen dices H and I. Proposition 2: The numerator function f (¯M) in (43) is concave w.r.t.¯M. Given¯M ≫ 3Q/2, f(¯M) is maximized at Proposition 3: The denominator function g(¯M) in (43) is convex w.r.t.¯M and is minimized at From the two propositions, f (¯M) and g(¯M) seem to achieve th e extremum at different values of¯M. Nevertheless, taking into account the practical values of the variables in th eir respective expressions, we have the following r esult. Corollary 1: The optimal¯M fo r the numerator and denom-q inator functions in (43) satisfy¯M≈¯M≅Qσ(2a), where the equality can be approached as P b ecomes larger. Proof: As d e ﬁned in (38), a =Pσν. Thus we have the following upper bound of 2a Qσ/(2a) ≥QP≫ Q/2 where the last result is because Tcan be in the order of 10 while νis only in the order of 10. Reﬂecting the a boveq relation in Proposition 2, we o btain¯M≈Qσ(2a). Given a large P ,¯Mderive in Proposition 3 becomes¯M≅q In summary, w e highlight below the key features of the proposed OTFS sensing methods. First, the actual range and Doppler dimensions, as denoted by˜M and˜N, respectively, are not limited to the orig inal dimensions of the underlying OTFS system, i.e., M an d N . Second, the max imum ran ge that can be estimated by the proposed design is not subject to the CP length of the OTFS system and can be ﬂexibly adjusted by changing Q, i.e., the length of the proposed VCP. Third, the SINR for target parameter estimation c an be maximized by setting where a and σare deﬁned in (38). Note that the relation ˜M =¯M + Q, as given in (9), is used above. Also note tha t the optimization in this section has included the potential ICI caused by the intra-sub-block Do ppler impact. Thus, even if a large Q results in a large˜M according to (44), the optimal ˜M is guaranteed to maximizes the sensing SINR, wh e ther ICI is pre sent or not. In this section, simulation results are provided to validate the propo sed design s and analyses. In a ﬁrst set of simulations, we co mpare the proposed design with the state-of-th e-art OTFS sensing me thod [15] which performs the maximum likelihood (ML) estimation. In short, the ML method [15] ﬁrst tran sforms x[i] given in (5) into the delay-Doppler domain by performing an inverse symplectic Fourier transform, i.e., the inverse transform of tha t performed in (1). T he re sult is stacked into an I-dimensional (I = M N ) column vector, as denoted by y. Then a multi-layer twodimensional searching is carried out, using the coefﬁcients H(l, ν)d, where d is obtained by stacking dinto an I-dimensio nal column vector (k ﬁrst) and H(l, ν) is the input-output response matrix at a delay-Doppler grid (l, ν); refer to [15, Eq. (15) ] for its d e ta iled expression. The superscript ()denotes the layer index and the sub script () denotes the grid index. For a single target, the 2D searching can be depicted as follows, where (ˆl, ˆν) is the pair o f estimated par ameters and Sis the delay-Doppler region to be searched at layer a. For simula tion efﬁciency, we take l= l(∀a, g), where lis the true value of sample de la y at lay er a. Thus, we only perform ML estimation for the target velocity. Moreover, we set the number of grids in each layer as ﬁve, i.e., |S| = 5, and the total number of layers as eight, i.e ., a = 0, 1, ··· , 7. More speciﬁcally, at a = 0, we set ν= g∆/4 (g = 0, 1, 2, 3, 4). Note that ∆, the su b-carrier interval, is also the unambiguously measurable region of the Doppler frequency for the ML method [15]. For a ≥ 1, the searching region of la yer a is reduced to ∆/4centered at ˆν. In addition, we set a rule that stops the iterative searching at layer a if ˆν6= νand take νas the ﬁnal velocity estimate, where νis the true value. For fair comparison with the ML method [1 5], th e key system p arameters set therein are used here only with minor modiﬁcation. The settings are summarized in Table III. Fig. 2: MSE of velocity estimati on, denoted by ˆv, versus γ(= σ/σ), i.e., the SNR of x[m] given in (8), where ML is for the benchmark method [15] and PP for the proposed design. Fig. 2 plots the mean squared error (MSE) of the veloc ity estimation, den oted by ˆv, against the SNR, denoted by γ. Here, γ= (σ/σ) is de ﬁned based on the sensing-received signal in the time domain, i.e., x[m] given in (8). We see that, in overall, the proposed method h as a comparable performance to the ML method [15]. Interestingly, we see different perform ance relation between the two methods in three SNR regions. 1) As γincreases from −10 dB to − 2 dB, the ML outperforms the proposed method, with the perf ormance gap becoming increasingly smaller. This is because the proposed estimation algorithm, as su mmarized in Algorithm 2, can return any value in [0,], in th e presence of strong noises. In contrast, the way the ML method is simulated makes its velocity estimation error bounde d to 80/3.6; 2) For γ∈ [−1, 5] dB, the proposed method is able to outperform the ML method. The reason is that the proposed method provides off-grid e stima tions, while the ML method performs on-grid searchin g; and 3) As γincreases over 5 dB, an increasing (yet small) performance gap between the proposed and the ML methods can be seen. The slight degrading of the proposed method is caused by the interference introduced during adding VCP; refer to Fig. 1. In particular, when the noise power Fig. 3: MSE of ˆv versus v, where˜M = 100 is taken for the proposed method (PP) and the curves with markers correspond to the ML method [15]. keep decreasing, the impact of the inter- and intra-symbol interference becomes gradually dominant. Nevertheless, we see from Fig. 2 that increasing˜M can help reduce the im pact of the interference. This is expected. Based on the parameter setting in Table III and Corollary 1, we have ¯M≈¯M≅ 247.8675. According to Propositions 2 and 3, the estimation SINR increases with˜M when˜M ≤¯M. That is, a larger˜M corresponds to a more accurate ˆv estimation. Fig. 2 also plots the CLRB of velocity estimation to validate the high accuracy of the parameter estimation methods developed in Section IV. As derived Appendix J, the CRLB is given by where b(ǫ) is g iven in Proposition 1. We see fr om Fig. 2 that the asymptotic performance of our estimation is slightly worse than the ML estimation. T his owes to the interference introduced when adding VCP. Note that the low-SNR performance of the ML method is no t accurate in Fig. 2. As expla ined above, this is because th e way we simulate the method bound s estimation er ror. Fig. 3 plots the MSE of ˆv versus different values of v. We see that the proposed method can achieve a comparab le performance to the ML me thod [15] at a mode rately high or high SNRs. We also see that the proposed method presents an even perfo rmance over a large region of v, while the good performance of the ML method can be velocity-selective. From Figs. 2 and 3, we conclude that the proposed meth od can provide an ML-like estimation performance for OTFS-based sensing. Next, we validate the analysis of the impact of˜M on the proposed OTFS sensing framework. To also show the wide applicability of the proposed me thod, we employ another set of system parameters, as summarized in Table IV, wh ere Udenotes the uniform distribution in [a, b]. Note that P = 4 means f our targets are set. Also note that the Dopple r Fig. 4: Illustrating the impact of˜M on the powers of signal and other components, as derived in Section V-A, where the curves with markers are theoretical results while the ones without markers are simulated. frequency o f 4.6 3 KHz corresponds to the maximum target velocity of 500 km/h. Fig. 4 illustrates the impact of˜M on the powers of the signal and oth er components in˜X[l] given in (35), where the power expressions of σ, σ, σand σ, as derived in (38), (39), (41) and ( 42), respectively, are plotted as the theoretical references. From Fig. 4, we see that the derived expressions can precisely depict the actual powers of different signal compon e nts. We also see from the left sub-ﬁgure that the signal power presents an approximate concave relation with˜M, as proved in Proposition 2. Moreover, we see from the right sub-ﬁgure that the overall power of interference plus noises is indeed a convex function of˜M, which validates Proposition 3. In addition, jointly compar ing the two subﬁgures, we can see that the extrema of σand (σ+σ+σ) are achieved at approximately identical˜M f or ea ch value of Q. This conﬁrms the analysis in Corollary 1. Fig. 5 plots the MSE of range and velocity estimations against˜M. We see that, as consistent with the SINR variations reﬂected in Fig. 4, the MSEs of the estimations of both parameters are convex functions of˜M and are min imized at the optimal˜M de rived in Corollary 1. We also see that the proposed method achieves the high-accuracy estimations of the ranges and velocities of all four targets (as the MSE is calculated over the squared estimation errors of all targets). Moreover, we see from Fig. 4 that Q also has a n on-trivial impact on OTFS sensing performance. In particular, a s Q becomes larger, the whole MSE curve shifts upwards. This is because a larger Q leads to a smaller number of samples in the essential part of each sub-block; see Fig. 1; as a further resu lt, the cohere nt accumulation gain of the two-dimensional DFT Fig. 5: MSE of parameter estimations versus˜M, where the mean is calculated over the squared estimation err ors of all the four targets. Fig. 6: MSE of parameter estimations versus γ, where Q = 50 and the mean is calculated over the squared estimation errors of all the four targets. performed in (2 2) for parameter estimation is also reduced. Fig. 6 illustrates the MSE of param e te r e stima tions a gainst γ. Based o n Fig. 4, we see that the optima l˜M is about 500. Thus, we take three values of˜M in this simulation to further illustrate the impact of˜M under different γ. As consistent with Fig. 4 and 5, the best MSE performance versus γis achieved at˜M = 500. Moreover, we also see that the MSE performance under˜M = 500 is better than that under˜M = 900. This is also consistent with what observed in Fig. 5. In addition, we see that the impact of˜M is more promine nt at a higher SNR. This is because as noise bec omes weaker, the interference compone nt has a more dominating effect, w hich also makes the impact of˜M mo re obvious. To advocate OTFS-based JCAS for future IIoT as an ultrareliable, low-latency and high-accur acy commu nication a nd sensing solution, we develop in this p aper a low-complexity OTFS sensing method with the near-ML performance. This is achieved by a series of waveform p re-processing which addresses the challenges of ICI a nd ISI, and successfully removes the the impact of communication d ata symbols in the time-frequency domain without amplifying noises. This is also accomplished by a high-accura cy and off-grid method for estimating range of velocity. The complexity of the m ethod is on ly dom inated by a two-dimension a l DFT. This is further attained by th e comprehensive analysis of SINR for parameter estimation and the optimization of a key parameter in the proposed method. Extensive simulations are provided, validating th e near-ML performance and wide applicability of our method as well as the pre c isio n of our SINR analysis. We remark that a dditional r e search effort would be necessary to make OTFS-based JCAS more ready for IIoT applications. First, sen sing between the distributed, non-cohere nt, asynchronous transmitter and re ceiver is yet to be solved, where the e stima tion ambig uities caused by timing and frequency offset are challenging to remove [7]. Second, networked sensing can combine the capabilities and diversities of different IIoT nodes for better performance, which is yet largely unexplored. Third, using sensing results to assist communications can further enhance the en ergy-efﬁciency of JCAS. A recent work [16] shows the ben eﬁt of doing so in the vehicular network. More studies are nec essary to account for the unique needs/features of IIoT applications. Fourth, in the spirit of JCAS, we may be able to make changes to the transmitted OTFS signal, e.g., inserting more CPs as in OFDM systems. This, however, requires a holistic evaluation on th e trade-off between the performance loss of communications and performance gain of sensing. The state-of -the-art OFDMbased JCAS waveform design [33]–[37] can provide good referenc e s for future OTFS JCAS designs. A. P roof of Lemma 1 As illustrated in Remark 2, S[m, n] ∼ CN(0, σ) is satisﬁed and indepen dent over ∀m, n. The signal transform in (2) resembles an unitary discrete time Fourier transform. Therefore, the resulted signal preserves the white Gaussian fea ture. Since ˜s[m] is the sampled version of the signal ob tained in (2), we have ˜s[m] ∼ CN(0, σ) and is independent over ∀m, n. Reﬂecting ˜s[m] ∼ CN(0, σ) (∀n, m) in (11) and (12), w e see that z[m] and z[m] are also ce ntered complex Gaussian variables. Based on (11), the variance of z[m] can be calcu la ted as in (47), where= is obtained by suppr essing th e cross-terms at p6= p. The sup pression is enab le d by the uncor related target scattering coefﬁcients, as illustrated in Remark 1. We see from (47) that the variance of z[m] can ch a nge with m due to the various support of the rectang ular function associated with each path, i.e., g[m]. As shown in Fig. 1, th e number of paths involved in z[m] decre ases, as m becomes larger. This leads to the discrete values of σ[m], as summarized in Table I. Similar to the a bove analysis for z[m], the variance of z[m] can be obtained, as summarized in Table II. On the othe r hand, we notice from Fig. 1 that z[m], z[m] and ˜s[m] have non-overlapping support. Therefore, the three com ponents are mutually uncorrelated. The whiteness of z[0], z[1], ··· , z[¯M −1 ] can be validated based on (11). In particular, we can show that = 0, ∀m6= m where the rectangular functions in z[m] and z[m] are dropped f or br evity, and the cross-terms ar e suppressed di- rectly due to Eαα= 0. Sim ilarly, we can validate the whiteness of z[m] along the n-dimension given ∀m, and moreover the whiteness of z[m] along n- a nd m-dimensions. B. P roof of Lemma 2 Each compone nt in (16) is a unitary DFT of the corresponding component given in (13). Thus, with reference to the proof of Lemma 1 established in Appendix A, we can readily show the white Gaussian na ture of the four components in (16). The details are suppressed for brevity. Next, we show the derivation of the variance of σ. Similar to (15), Z[l] can be written as Z[l] =P in (15). The variance of Z[l] can be calculated as where the cross-terms are suppressed due to the whiteness of z[m], as illustrated in Lemma 1. As also shown in Lemma 1, σ[m] is a discrete function of m. Based o n the uniform distribution of las stated in the condition of Lemma 2, σ[m] takes each value in Table I with the same probability . This further leads to Substituting (50) into (49), we obtain the variance o f Z[l], as given in (17). Similarly, σcan b e derived. The details are suppressed her e . = 1 − e, where˜S[l] ∼ CN(0, σ) is illu strated in Lem ma 2, x then conforms to a chi-squared distribution with two degrees of freedom, and the last result is based on the fact that P {x ≤ z} = 1 − e[32]. Solving the above equation results in (18). D. Proof of Proposition 1 By d eﬁnition, we have where adding th e sub scripts, (·)and (·), to a complex variable denotes the real and imaginary parts of the variable, respectively. The variance of z, denoted by σ, can be calculated as σ= σ+ σ, where σ(or σ) deno te s the variance of z(or z). Since zand zhave the same PDF [38] a nd occupy the same region, they have the same variance as well. Thus, we only illustrate the calculation of σbelow. With reference to [38, Eq. (18)], the cumulative density function of zcan be expr essed as F(u) = (λ(u) + 1)/2, where λ(u) =√and ρ = σ/σ. Taking the derivative of F(u) w. r.t. u, we obtain the PDF of z, as given by The PDF is an even function of u and hence E {z} = 0. Directly calculating the variance o f zwith an inﬁnite r egio n of u will results in an inﬁnite variance. Thus, we put a ﬁnite upper limit on |z| and approximate its variance as follows, where, under¯k ≫ 1, two approximation s are used, i.e., asinh¯k≈ ln2¯kand√≈ 1. Based on the PDF f(u), the p robability that |z| ≤ ¯u can be calculated as where the substitution ¯u =¯k√ρ is performed. Assume that P{|z| ≤ ¯u} = 1−ǫ, where ǫ is a sufﬁciently small probability claimed in the condition of Pr oposition 1. Then we can solveq that¯k =and, moreover, σ≈ ρln4¯ǫ1 − ¯ǫ− 1 As mentioned earlier, zhas the same variance as z. Thus, the ﬁnal variance of z becom es the on e given in (37). E. Calculating Π given in (38) Pσ. Note that th e result= is obtained by separately calculating the cases of m= mand m6= m; the approximation is obtained based on the second-degree Taylor expansion of the cosine function w.r.t. m; and the result= is obtained based on the following formula of summations:PP F. Deriving Γ= σfor (40) For convenience, we provid e below the expression of Γ, where we notice that the su mmations enclosed in the round brackets can be calculated ﬁrst. Similar to the way Π is calculated in Appendix E, we calculate Γby considerin g m= mand m6= m. For the ﬁrst case, we have where we have used Z=; see (15). For the case of m6= m, the summa tion w.r.t. lis always zero since the summands, given ∀m, m, are the samples of a complex exponential signa l within an in teger multiple of periods. Com-P bining the two cases, we have Γ=σ× 1 = σ. G. Proving E≈ 0 For convenience, we deﬁne some shorthand expressions: Z[l] = a + jb, Z[l] = c + jd and˜S[l] = e + jf . Based on (20), we have The expectation of R/S can be calculated as [40] E {R/S} ≈ µ/µ− σ/µ+ σµ/µ where µand µare means, σdenotes covariance and σ denotes variance. Based on Lemma 1, a, b, c, d, e and f are indepen dent centered Gau ssian variables. Therefore, we have µ= 0 and moreover σ= E {(R − µ)(S − µ)} = E {RS} = E(ad − bc)e+ fj + (ac + bd)e+ f= 0. These further lead to E≈ 0. Likewise, weno can show E≈ 0. H. Proof of Proposition 2 Based o n (38), we have where th e approximation is d ue to˜N =≈=. The ﬁrst derivative of f (¯M) w.r.t.¯M is and th e second derivative is where C(> 0) abso rbs the¯M-independe nt coefﬁcients. Since f(¯M) < 0 always ho lds, f(¯M) monotonically decreases. We notice that f(0) > 0. Thus, there exists¯Msuch that f(¯M) < 0 for¯M >¯M. The value of¯Mcan be determined by solv ing the equation f(¯M) = 0 which is essentially Directly using the cubic formula leads to a solution with a complex structure and does not provide much insight. To this end, we consider the case of¯M ≫ 3Q/2 and simplify the equation by dro pping the quadratic term, obtaining 2¯Ma − Qa − Qσ= 0. Thus, an approximation of¯Mis achieved I. Proof of Proposition 3 Moreover, we can readily validate that the second derivative of g(¯M) is constantly po sitive, which is suppressed here for brevity. Therefore, there exists¯Msuch that g(¯M) < 0 for J. Approximate CRLBs for the estimates obtained in (32) From Section IV, we see that the velocity and range estimations are both turned into frequen cy estimations. Thus, we can use the CRLB of a single- tone frequency estimator to derive the CRLBs of ˆνandˆlobtained in (32). As the derivations for the two estima te s are very similar, we. only take ˆν= (˜n+ ˆǫ)(˜N˜MT) for an illustration. According to [25], the CRLB of (˜n+ ˆǫ) ca n be given by 6/(4π˜γ), where ˜γ is the SNR of˘X[˜l] obtained in (30). The SNR ˜γ can be approximated by suppressing σ and σin (43), leading to ˜γ =, where σis given. in (38) and σin (42). Given ˆν= (˜n+ ˆǫ)(˜N˜MT), we have CRLB{ˆν} = CRLB{˜n+ ˆǫ}/(˜N˜MT). Since ν= 2v/λ, we further have CRLB{ˆv} =CRLB{ˆν}. Combining the above analyses gives th e CRLB in (46).