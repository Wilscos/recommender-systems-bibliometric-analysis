1. School of Mathematics, Physics and Statistics, S hanghai University of Engin eering Science, Shanghai 201620, 2. Center of Ap plication and Research of Computational Physics, S hanghai University of Engineering Science, 3. Guangx i Key Laboratory for Relativistic Astrophysics, Guangxi University, Nanning 530004 , China † Corresponding Author Email: wuxin1134@sina.com (X. W.); M130120101@sues.edu.cn (N. type spacetimes is based on splitting and com position methods for numerical integrations of Hamiltonians or time-tr ansformed Hamiltonians associated with these spac etimes. Such splittings are not u nique but have various choices. A Hamiltonian describing the motion of charged particles around the Schwarzschild black hole with an external magnetic ﬁeld can be separated into three, four and ﬁve explicitly integrable parts. I t is shown thr ough numerical tests of regular and chaotic orbits that the three-part splitting meth od is the be st one of the three Hamiltonian splitting methods in accuracy. In the three-part splitting, optimized fourth -order partitioned Runge-Kutta and Runge-Kutta-Nystr¨om explicit symplectic integrators exhibit the best accuracies. In fact, they are several orders of magnitude better tha n the four th-order Yoshida algorithm s for appropriate time steps. The former algorithms need small additional computational cost compare d with the latter ones. Optimized sixth-orde r partitio ned Runge-Kutta and Runge-Kutta-Nystr¨om explicit symplec tic integrators have no dramatic advantages over the optimize d fourth-order ones in accuracies during long-term integrations due to roundoff errors. The ide a ﬁnding the integrators with the best perform ance is also suitable for Hamiltonians or time-transformed Ha miltonians of other curved spacetimes including the Kerr type spacetimes. When the numbers of explicitly integrable splitting subHamiltonians are as small as possible, such splitting Hamiltonian methods would bring better accuracies. In this case, the optimized fourth-order partitioned Runge-Kutta and Runge-Kutta-Nystr¨om methods are worth recommending. Uniﬁed Astronomy Thesaurus concepts: Black hole physics (159); Computational methods (1965); Computational astronomy (293 ); Celestial mechanics (211) Four basic black hole spacetimes consisting of Schwarzschild, Reissner-Nordstr¨om, Kerr and KerrNewman metrics are integrable. Although their an alytical solutions exist from a theoretical point of view, they cannot be expr essed in terms of elementary functions of time and are only formal solutions described by elliptic integrals. Numerical tec hniques are necessary to study geodesic orbits of p articles in these spacetimes. When th e spacetimes or their co rrespond ing modiﬁed theories of gravity (Deng & Xie 2016; Deng 2020; Gao & Deng 2021) contain electromagnetic ﬁelds or are imme rsed in externa l electromagnetic ﬁelds acting as perturbations, they become nonintegrable in many situations. The onset of chaos is even allowed in the nonin tegrable systems (Karas & Vokroulﬂick´y 1992; Takahashi & Koyama 2009; Kop´aˇcek & Karas 2014; Stuchl´ık & Koloˇs 2016; Tursunov et al. 2016; Kop´aˇcek & Karas 2018; Panis et al. 2 019; Stuchl´ık et al. 2020). Numerical techniques are particularly important to solve the nonintegrable problems. Because the spacetimes can exactly corre spond to Hamiltonian sy stems, their most appropriate solvers should maintain the symplectic nature of Hamiltonian dynamics. They are symplectic schemes (Wisdom 1982; Ruth 1983; Feng 1986; Suzuki 1991). They nearly preserve the energy of a conservative mechanical system when truncation errors act as a main error source (see e.g., Hairer et al. 2006). They can also provide reliable r esults to the integrated trajectories and to the detection o f the chaotical behavior for appropriate choices of time steps. Symplectic methods are divided into explicit symplectic algorithms and im plicit ones (Yoshida 1993). Sometimes their com positions (i.e., explicit and implicit symplectic composition methods) are used in the literature (Lia o 1997; Preto & Saha 2009; L ubich et al. 201 0; Zhong et al. 2010; Mei et al. 2013a , 2013 b). The implicit methods do not need splitting th e above-mentioned Hamiltonians, and th us are always available. The implicit midpo int rule (Feng 1986; Brown 2006) and Gauss-Rung e-Kutta methods (Kop´aˇcek et al. 2010; Seyrich & Lukes-Gerakopoulos 2012; Seyrich 2013) are common implicit symplectic schemes. They should be generally more expensive in computational cost than the explicit and implicit composition metho ds at same order. O f co urse, the latter is more computationally demanding than the explicit algorithm s. Many explicit symplectic algorithms usually rely on splitting nonlinear Hamiltonians and composing the ﬂows of the splitting terms. In fact, they are splitting and composition methods for the numerical integration of nonline ar ordinary differential eq uations. There are a class of explicit symp le ctic integrators for solving non-sepa rable nonlinear Ham iltonians, which are the product o f a function of momenta and another function of coordinates a nd do not need splittings (Chin 2009). In addition, variational symplectic integrators (Marsden & West 2001) can be explicit for some nonlinear H amiltonians without the use of splitting. The im plicit midpoint rule as one of the variational symplectic integrators becomes explicit for lin ear Hamiltonian problems without any splittings. In general, an N-body Hamiltonian problem in the solar system has a classical splitting into two explicitly integrable parts with comparable size, which involve a kinetic energy depending on momenta and a potential energy depending on position coordinates (Ruth 1983). It can also be split into two explicitly integrable terms of different magnitudes, i. e., a primary Kepler part and a small perturba tion part corresponding to the in te ractions among planets (Wisdom & Holman 1991). This Hamiltonian splitting is a perturbative Hamiltonian splitting meth od. Explicit symplectic methods, such as fourth-ord e r symplectic integrations of Forest & Ru th (1990) and h igher-order symplectic algorithms of Yoshida (1990), are easily feasible and applicable to the classical splitting and the perturbative splitting. Optimized higher-order partitioned Runge-Kutta (PRK) and Runge-Kutta-Nystr¨om (RKN) explicit symplectic integrators (Blanes & Mo an 2002) are applied for the classical splitting method. However, the pseudo-higher-order symplectic integrators (Chambers & Murison 2000; Laskar & Robutel 2001; Blanes et al. 2013) are speciﬁcally d esigned for the perturbative splitting. A splitting of the N-body Hamiltonian into three explicitly integrable terms correspond ing to various magnitudes was co nsidered by Duncan et al. (1998). The pseudo-higher-order symplectic schemes still work well for such a splitting (Wu et al. 200 3). Recently, Chen et al. (2021) split an N-rigid-body Hamiltonian p roblem into three and four integrable terms with various magnitude s and different timescales. Based on coefﬁcient combinations optimized, the integration accuracy and efﬁciency are typically improved in the splittings. The Hamiltonians corr esponding to the abovementioned black-hole spacetimes in general relativity are inseparable to the phase space variables. In spite of this, the above-mentioned explicit symplec tic integration algorith ms or explicit and implicit combin ed symplectic m ethods are always available. When each of the Hamiltonians is split into two terms, not both terms are in tegrable o r have analytical solutions as explicit functions of time. The construction and a pplication of explicit symplectic integrators is difﬁcult for the splitting method. Doubling the phase space variables in any inseparable Hamiltonian problem, Pihajoki (2015) introdu ced a new Hamilto nian on an extended phase space with two splitting parts equal to th e origin a l inseparable Hamiltonian system. Here, one part depends on the original coordinates and the new momenta, and the other pa rt is a f unction of the original momenta and the new coordinates. The extended phase-space Hamiltonian is amenable for integration with a standard explicit symplectic leapfrog symplectic method. Because both solutions from the leapfrog integrating the two splitting parts are coupled through the derivatives, th ey should diverge with time. Mixing maps acting as feedback between the two solutions are necessarily included in th e leapfrog so as to solve this problem. If the mixing maps are nonsymplectic, then the resulting algorithm no longer symplectic on the extended phase space. Even if the mixing maps are symplectic, the extended phase space le apfrog is n ot symplectic when a solution in the extended phase space is projected back to that in the original phase space in any case. The best choice of the mixing maps a nd projection map is that the mixing maps take permutations of momenta, and the projection map takes the original coordinates and the new m omenta in the extended phase space as the solution in the original phase space. In this way, the explicit extended phase space algorithm has good long term stability and error behavior although it does not retain the symplecticity, as was numerically conﬁrmed by Pihajo ki. Thus, it is a symmetrically symplectic-like method. Liu et al. (2016) pointed out the p reference of sequent permutations of coordinates and momenta over the per mutations of momenta, and proposed higher orde r explicit extended phase space symplectic-like integrators for inseparable Hamiltonian systems. Luo et al. (2017 ) found that the midpoint permu ta tions between the original coordinates and the extended coordinates and th e midpoint permutations be twe en the original momenta and the extended m omenta are the best mixing maps. The explicit extended phase space symplectic-like integrators with the midpoint permutations are w ell applicable to nonconservative nonseparable systems (Luo & Wu 2017), logarithmic Hamiltonians (Li & Wu 2017), relativistic co re-shell spacetimes (Liu et al. 2017), and magnetized Ernst-Schwarzschild spacetimes (Li & Wu 2019). Recently, Pan et al. (2021) considered the c onstruction of semiexplicit extended phase space symplectic-like integrators for coherent postNewtonian Euler-Lagrange equations. On the other hand, Tao ( 2016a) did not adopt any mixing maps and proposed explicit symplectic methods of any even order for a nonseparable Hamiltonian in an extended phase space. In his metho d, an extende d phase space Hamiltonian consists of three parts: two copies of the original system with mixed-up positions and momenta and an artiﬁcial restraint with a parameterωcontrolling the binding of the two copies. There are two problems. One problem is that, although the integrators based on the idea of Tao are symplectic in the extended phase space, it is unclea r that how the symplecticity of the extended phase space Hamiltonian is related to that of the origina l system (Jayawardana & Ohsawa 2021). Another problem is that there is no universal method to ﬁnd the optima l c ontrol parame te rω. The optimal choice relies o n only a large number of numerical tests (Wu & Wu 2018). Combining an extended phase space appro ach of Pihajoki and a symmetric projection method, Jayawardana & Ohsawa (2021) have more recently constructed a semiexplicit symplectic integrator for inseparable Hamiltonian systems. The computations of the main tim e evolution for two copies of the original system with mixed -up positions and momenta a re explicit. However, the computations of the symmetric projection that binds potentially diverging copies of solutions are implicit. The resulting method is symplectic in the original phase space. In fact, it is possible to construct explicit symplectic integrators for the afor e mentioned curved spacetimes in terms of splitting and composition . One way is a splitting of the Hamiltonians corresponding to these cur ved spacetim e s into more explicitly integrable terms of co mparable sizes or different magnitudes. When the Hamiltonian of Schwarzschild spacetime is separated into four integrable splitting parts with analytical so lutions as explicit functions of proper time, explicit symplectic m ethods are easily designed (Wang et al. 2021a). The explicit symplectic methods are also suitable for a splitting of the Hamiltonian of Reissner-Nordstr¨om blac k h ole into ﬁve exp licitly integrable terms (Wang et al. 2021b), and a splitting of the Hamiltonian of Reissner-Nordstr¨om-(anti) de Sitter black hole into six explicitly integrable parts (Wang et al. 2021c). These explicit sym plectic methods are still effective when external magnetic ﬁelds are inclu ded to destroy the in tegra bility of these spacetimes. Un fortunate ly, no such a similar splitting exists in the H amiltonian of Kerr black hole and then explicit symplectic meth ods do not work. Using a time transformation method intr oduced in the work of Mikkola (1997), Wu et al. (2021) g ave a time-transformed Hamiltonian to the Hamiltonian of Kerr black hole. The time-transformed Hamiltonian is separated into ﬁve explicitly integrable ter ms and allows for the application of explicit symplectic methods. This idea was extended to study the chao tic motions of charged particles around the Kerr black holes and deformed Schwarzschild black holes immersed in external magnetic ﬁelds (Sun et a l. 2021a, 2021b; Zhan g et al. 2021). How to choose time transformation functio ns is d ependent on some spe ciﬁc spacetimes. H ow to split the Hamiltonians or time-transformed Hamiltonians also depends on the speciﬁc spacetimes. Generally, for a splittin g of a certain Hamiltonian into many explicitly integrable terms of comparable sizes, the higher-order explicit symplectic methods of Yo shida (19 90) are conveniently applied. The optimized fourth - and sixth-order PRK and RKN explicit symplectic integra tors (Blan e s & Moan 2002) for the two-part splitting with comparable size can be adjusted as those that are appropriate for the multipart splitting of comparable sizes (Blanes et al. 2008, 2010). An op timized fourth-order PRK integrator was recently discussed in the splitting method (McLachlan 2021). Compared w ith the Yoshida constructions, the same order PRK or RKN methods contain more additional time coefﬁcients and more compositions of all sub-Hamiltonian ﬂows. For instance, a fourth -order Yoshida method is a symmetric composition of three second-order leapfrogs, and th e optimized fourth-order PRK integrator is that of six pairs of ﬁrst-order ap proxima tion composing all the subHamiltonian ﬂows and the adjoint of the ﬁrst-order integrator. As a result, the optimized PRK and RKN methods are somewhat more expensive in computations than the same order Yoshida integrators. Now, there is a question of whether the splitting methods of the above-mentioned or non-mentioned Hamiltonians co rresponding to curved spacetimes are unique. If they are not, which of them perform the best accuracies. What performance s do the optim ized PRK and RKN methods have in various splittings? Are the optimized PRK and RKN methods superior to the same order Yoshida integrators in accuracies? To answer these questions, we consider a Hamiltonian describing the motion of charged particles around the Schwarzschild black hole with an external magnetic ﬁeld as an example. Besides the splitting of four explicitly integrable parts introduced in the work of Wang et al. (2021a), two splitting methods o f three and ﬁve explicitly integrable parts with comparable sizes will be given to the Hamiltonian. T hen, the fourth and sixth-order Yo shida algorithms and the fourth- and sixth-order optimized PRK and RKN methods are numerically evaluated in the three splittings. These algorithms combining the explicit extended phase spa c e symplectic method s of Tao (201 6a) or the explicit extended phase space symplectic-like integrators with the midpoint permutations of Luo et al. (2017) are nu merically compared. In a word, the fundamental aim of the present paper is to ﬁnd the best integrators and splitting method. The paper is organized as follows. In Section 2, we introdu ce three splitting methods to a Hamiltonian system describing the motion of charged particles around the Schwarzschild black hole with an external magnetic ﬁeld. Yoshida algorithms and optimize d PRK and RKN methods of orders 4 and 6 are used in the three splittings. In Section 3, we check the numerical performance of these algorithms in the three splitting methods. Finally, the main results are concluded in Section 4. Some exp licit extended phase space symplectic or symplectic-like methods a re described in Append ix. First, we present a Hamiltonian dynam ic a l system for the description of charged particles moving around the Schwarzschild black hole with an external magnetic ﬁeld. Second, an existing splitting of the Hamiltonian into four explicitly integrable terms is introduced, and Yoshida algorithms and optimized PRK and RKN methods of orders 4 and 6 are applied to the splitting. Third, a splitting into three explicitly integrable parts is given to the Hamiltonian and these integrators are considere d in such a splitting. Finally, the mentioned integrators act on a splitting of the Hamiltonian into ﬁve explicitly integrable parts. 2.1. Hamilto nian formulism for Schwarz schild spacetime with external magnetic ﬁeld The dynamics of a test particle with charge q moving a round the Schwarzschild black hole surr ounded by an external magnetic ﬁeld is described by the following Hamiltonian (Koloˇs et al. 2015) In spherical-like coordina te s (t,r,θ,ϕ), nonzero componen ts of the Schwarzschild metric gare The external uniform magnetic ﬁeld in the vicinity of the black hole has an electromagnetic ﬁeld potential with only one nonzero covariant component (Koloˇs et al. 2015; Panis et al. 20 19) where B repre sents a magnetic ﬁeld strength. Here, a point on the p resence of magn etic ﬁeld in the vicinity of the black hole is illustrated. Observations show that strong m agnetic ﬁelds exist in active galactic nuclei (Xu et al. 2011). A regular magne tic ﬁeld might arise inside an accre tion disk around a black hole d ue to the dynamo mec hanism in cond ucting matter (plasma) of the ac cretion disk (Tursunov et al. 2013 ; Abd ujabbarov et al. 2014). This magnetic ﬁeld does not get through the conducting plasma region and falls in the vicinity of the black hole (Frolov 2012). At large distances, the character of a large-scale magnetic ﬁeld in accretion processes can be approximately simpliﬁed to a homogeneous magnetic ﬁeld in ﬁnite element of space. For simplicity, an asymptotically uniform magnetic ﬁeld is con sidered as the external magnetic ﬁeld (Wald 1974; Kov´aˇr et al. 2014; Stuchl´ık & Koloˇs 2016). pis a generalized momentu m determined by a set of canonical Hamiltonian equations ˙x=∂H/∂p, and reads Here, covariant metric components are g= 1/g, g= 1/g, g= 1/gand g= 1/g. 4-velocity ˙xis a derivative of coordinate xwith respect to proper timeτ. Another set of canonical Hamiltonian equations ˙p= −∂H/∂˙xshow ˙p= ˙p= 0. Namely, two constant generalized momentum components are whereβ= qB. E is a constant energy of the par ticle , and L corresponds to a constant angular momentum of the particle. Substituting the two constants into Equation (1), we rewrite the Hamiltonian as Due to the par ticle’s rest mass in the time-like spacetime, a th ird constant is always given by No fourth con stant exists when the magnetic ﬁeld is included in the Schwarzschild spacetime. Thus, the Hamiltonian (6) is a nonintegrable system with two degrees of freedom in a fo ur-dimensional phase space. A point is illustrate d here. The speed of light c and the gravitational constant G are measu red in terms of geometric units, c = G = 1. Equation (6) with Equation (7) is dimensionless. The dimensionless o perations to the re late d qualities are imp lemented through scale transformations to the qualities. That is, t → tM, τ→τM, r → rM, B → B/M, E → mE, p→ mp, L → mML, p→ mM p, q → mq and H → mH, where M denotes the black hole’s mass and m stands for the particle’s ma ss. Separations of the variables in the Hamiltonian (6), including the separation of momenta pand pfrom coordinates r andθor the separation of variables r and pfrom variablesθand p, are impossible. In spite of this fact, the H amiltonian can still be split into two integrable parts with analytical solutions; e.g., one part is composed of the ﬁr st, second and fourth terms, and ano ther part is the th ird term. Unfortunately, not both the par ts have explicit analytical so lutions. Thus, explicit symplectic integrators are not applicable to the Hamiltonia n splitting. However, they are available when the Hamiltonian is separated into four parts with explicit analytical solutions explicitly depending on proper timeτ, as was shown by Wang et al. (2021a). In what follows, we br ie ﬂy introduce the idea on the construction of explicit symplectic methods. Wang et al. (2 021a) suggested splitting the Hamiltonian (6) into four parts as follows: It is clear that each of the four sub-Hamiltonians H, H, Hand His analytically solvable, and its analytical solutions are explicit fu nctions of proper timeτ. The exact solvers for the four parts are in sequence labelled a s Ξ, Ξ, Ξand Ξ, where h is a prop er time step. The exact ﬂow of Hamiltonian (6) advancing time h, Ξ, is approximately expressed as S2 is a symmetric c omposition produ ct of these solvable operators Ξ, Ξ, Ξand Ξ. It is a secondorder explicit symplectic solver for the Hamiltonian (6). Symmetric pr oducts of S2A solvers can produce fourth - and sixth-order exp licit symple ctic sch emes (Yoshida 1990): S6A = S4A(dh) × S4A(dh) × S4A(dh). (15) where c= 1/(2 − 2), c= 1 − 2c, d= 1/(2 − 2) and d= −2/(2 − 2). These explicit symplectic algorithms proposed by Wang et al. (2021a) are speciﬁcally designed for th e Schwarzschild type spacetimes without or with perturbations from weak external sources like magnetic ﬁelds. Th e Hamiltonian splitting (8) is also suitable for the construction of higher order optimized explicit symplectic alg orithms of Blanes et al. (2010), who introdu ced sym metric compositions using more extra stages. Consider two ﬁrst-order approximations to the exact solutio ns of the system (8): Note thatχ=χis the ad joint o fχ. Using both mapsχandχ, Blanes et al. (2 008, 2010) introdu ced a symmetric composition where a series of coefﬁcients areα=α= 0, and In the above equations, coefﬁcients a, · · · , b, · · · with∑a=∑bare stemm ed fr om those of the symmetric fourth- and sixth-order symplectic partitioned Runge-Kutta (PRK) and Runge-Kutta-Nystr¨om (RKN) methods for the two-part splitting, and are listed in Tables 2 and 3 by Blanes & Moan (2002). When s = 1, Equation (18) is the second-order algorithm (13): Such a pair of operatorχand its ad jointχcan compose higher-order integrators. Given s = 6, Equation (18) corresponds to a fourthorder optimal explicit symplectic PRK algorith m whereα, · · · , andαcalculated by us are given in Table 1. The optim ization means that free coefﬁcients among coefﬁcients a, bminimize the truncation errors at the ﬁfth order. The free coefﬁcients a rise because the number of coefﬁcients a, bis more than that of the order conditions. The op timization can drastically lead to reducing discretization errors at ﬁxed cost, compared with the non-optimizatio n. McLachlan (2021) conﬁrmed that the or dering of the separable terms in the algorithm affects the errors and slightly affects the computational c ost. Thus, choosing the best ordering is impor tant to reduce the errors. Clearly, the optimized fourth- order PRK in te grator contain more additional time coefﬁcients and more compositions of all sub-Ha miltonian ﬂows than the fourth-order Yoshida method. In fact, the former is a symmetric composition of six pairs of operatorχ and its adjointχ, and the latter is th at of three secondorder methods S2 A. For s = 10 in Equatio n (18 ), a sixth-order optimal explicit symplectic PRK metho d is where the values ofα-αare listed in Table 1. This integrator is a symmetric composition of ten pairs of operatorχand its adjointχ. On the other hand, Equation (18) ca n also yie ld RKN methods. Taking s = 6, w e have a fourth-order optimal explicit symplectic RKN method Given s = 11, a sixth-order optimal explicit sym plectic RKN method reads For s = 14, another sixth-order optimal explicit symplectic RKN method is We use Equations (1 9)-(21) to calculate the coefﬁcients of the thr ee algorithms, which are listed in Table The PRK and RKN methods for the Ham iltonian splitting (8) need more compositions of operators Ξ, Ξ, Ξand Ξthan the same ord e r Yoshida’s constructions. Suc h a splitting Hamiltonian meth od is not unique. There are o ther splitting Hamiltonian methods to construc t explicit symplec tic schemes. We focus on th e application of the aforementioned integrators to two splittings of the Hamiltonian into three and ﬁve explicitly integrable terms. The Hamiltonian (6) can be split into three parts where His the sum of Hand H: The canonical equations of sub- H amiltonian H are written as They are exactly, analytically solved. Advancing time h from solutions (r,θ, p, p) at proper timeτ, the analytical solutions at proper timeτ= τ+ h are expressed as θ= f+ arctan[(e+ e)hp+ f], (33) f= arctan 2(e,e), S6B = S4B(dh) × S4B(dh) × S4B(dh). (37) Their constructions are based on the Hamiltonian three-part splitting (28). Throu ghχ→χandχ→χ, algorithms PRK4A, PRK6A, RKN4A, RKN6A and RKN6A become me thods PRK4B, PRK6B, RKN4B, RKN6B and RKN6B, respectively. Now, we give ﬁve sepa rable par ts to the Hamiltonian (6) as follows: where two new sub-Hamiltonians are Here, a is a free parameter. Various choices of a c orrespond to different ﬁve part Hamiltonian decompositions. In other words, there are an inﬁnite number of methods for the Hamiltonian split into ﬁve parts. S6C = S4C(dh) × S4C(dh) × S4C(dh). (5 3) Take two ﬁrst-order maps χ= Ξ× Ξ× Ξ× Ξ× Ξ, (54) χ= Ξ× Ξ× Ξ× Ξ× Ξ. (55) In terms ofχ→χandχ→χ, algorithms PRK4A, PRK6A, RKN4A, RKN6A and RKN6A correspo nd to methods PRK4C, PRK6C, RKN4C, RKN6C and RKN6C, respectively. Two points are worth noticing. First, the abovementioned three, four and ﬁve splitting parts might have comparable sizes sometimes, or might have various magnitudes and different timescales. In other words, these splitting parts do not always have various magnitudes, and should be considered to be comparable sizes in the whole course of integration. Therefore , the optimiz e d coefﬁcient combinations in the explicit symplectic integrations for the N-rigid-body Hamiltonian problem into three and four integrable terms of various magnitudes and different timescales (Chen et al. 2021 ) are not suitable for the present splitting and composition methods. Second, if the asymptotically unifor m magnetic ﬁeld in Equation (2) gives p lace to the general magnetic ﬁelds of Tao (2016b), the present splitting and composition meth ods fail to construct the explicit symplectic methods. However, the Tao’s explicit symplectic integrators are still valid. In fact, th e Tao’s con struction is unlike ours. In the Tao’s method, one of the two Hamiltonian splitting parts has an analytical solution, whereas another part is not analytically available and uses Runge-Kutta approximation to calculate position. In our construction, each of the Hamiltonian splitting p arts is solved analytically. In this sectio n, we m ainly check the numerical performance of the ab ove-mentioned algorithms in the three sp littin g Hamiltonian meth ods. For comparison, the explicit extended phase space symplectic-like methods with the midpoint permutations of Luo et al. (2017) and the explicit extended phase space symplectic methods without any permutations of Tao (2016a) are considered. Their details are introduced in Appendix. The para meters are E = 0.995, L = 4.6, andβ= 8.9 × 10. The initial cond itions areθ=π/2 and p= 0; the in itial value p> 0 is determin ed by Equation (7). Taking a = h = 1, we employ the secondorder method S2C to plot Figure 1, which describes two orb its with the initial separations r = 11, 72 in Poincar´e surface of sectionθ=π/2 with p< 0. The initial separation r = 11 corresponds a closed curve, which indicates regular motion. The motion for the initial separation r = 72 is chaotic because the plotted points are randomly distributed in an area. Th e orbital regularity or chaoticity for any co nservative Hamiltonian system with two degrees of fre e dom in fourdimensional phase space can be seen clear ly fr om the distribution o f the points in the Po incar´e map. Let us choose the regular orbit with the initial separation r = 11 as a test o rbit to evaluate how a variation of a affects the numerical performance of S2C. When a ranges from 0 to 10 with an interval ∆a = 0.01, the dependence of Hamiltonian error ∆H = 1 + 2H on a is shown in Figure 2(a), where each error is obta ined by S2C after the integration tim eτ= 10. Clearly, a = 1.0260 corresponds to the minimum error. This result is also supported in Figure 2( b) on the description of Hamiltonian errors for a = 1.0260, 3.9691, 8.66 10. Hereafter, a = 1.0260 is used in the C type algorithms for the Hamiltonian ﬁve-part splitting (40). Now, the ordered orbit in Figure 1 is still used as a test orbit. The second-order, fourth-order and sixthorder symplectic schemes of Yoshida are applied to the three Hamiltonian splitting methods. The Hamiltonian errors of these algorithms are described in Figures 3 (a)-(c). They remain stable and bounded, and do not grow with time. Wh en truncation errors are larger than roundoff errors, the boundness of Hamiltonian (or energy ) errors in long- te rm integrations is the intrinsic property of these symplectic integrators. Different Hamilto nian splitting methods affect nume rical er rors. In accuracies, the fourth-order methods ar e better than the second-orde r ones, but poorer than the sixth-order ones; at sam e orders, the B type algorithms are always super ior to the A type methods, which are inferior to the C type integrators. Namely, the threepart splitting method has the best accuracy, whereas the ﬁve-part splitting method p erforms the poorest accuracy for a given integrator. When the ordered orbit in Figure 1 is replaced with the chaotic or bit, the results are still the absence of error growth for the second- and fourth -order schemes. The preference of the fourthorder schemes over the second-order schemes, and the preference of the B typ e algorithms over the A type methods at the second and f ourth orders are shown in Figures 3 (d) and (e ). However, the err ors of the sixthorder method in the three Hamiltonian splittings are almost the same and begin to yield a secular drift when the integration time spans 10in Figure 3(f). This drift is due to roundoff errors. The trun cation errors are appropriately accurate to the machine double precision before the integratio n timeτ= 1000. As the integration continues, the roundoff errors slowly increase and dominate the truncation errors. This lead s to the drift in the errors. Thus, the accuracies of the sixthorder algorithms have no advantage over those of the fourth -order metho ds when the integration time is long enoug h. Compariso ns between Figures 3(a) a nd 3(d), compariso ns between Figures 3(b) and 3(e), and comparisons betwee n Figures 3(c) and 3(f) show that eac h of the integrators for the same Hamiltonian splitting exhibits better energy accura cy for the chaotic orbit than for the ordered orbit. This result is due to the average period of the chaotic orbit larger than that of the regular orbit. Although th e chaotic orbit lacks periodicity, its average period is admissible. Given a time step, a larger average orbital period should bring better accuracy. On the contrary, the accur a cy of solutions becomes poorer f or the chaotic case than for the regular case. This is because sensitive dependenc e of the solutions on the initial conditio ns for the chaotic case must give rise to the rapid accumulation of errors of the solutions. What about the numerical performance of the PRK and RKN integrators for the three splitting methods? The ordered orbit in Figu re 1 is still chosen as a test orbit. Figures 4 (a) and (b) still support the results described in Figures 3 (a)-(e). That is, the B type algorithms have the best accuracies in the fourth-order optimized methods PRK4 and RKN4, but the C type algorithm s yield the poorest accuracies. The B type sixth-order methods in Figures 4 (c) and (d) are better than the A ones within the integration timeτ= 10. As the integration time lasts long enou gh, PRK6B is inferior to P RK6A, and RKN6B is inferior to RKN6A due to the fast growth of roundoff errors. In Figure 4(e), the energy error for RKN6B is smaller than that for RKN6A, and both errors have no secular drifts. However, the energy error for RKN6B has one or two o rders of magnitude larger than for RKN6B in Figure 4(d) and PRK6B in Figur e 4(c). Th us, the inﬂuence of the roundoff errors on the global errors is smaller for RKN6B than for RKN6B and PRK6B. Table 2 lists CPU times of these a lgorithms solving the regular orbit in Figures 3 and 4. The higher the order of an algorithm is, the more CPU time the a lgorithm ta kes. Although CPU time with 3 minutes 23 seconds for RKN6C is more than CPU time with 32 seconds for S2A, additional CPU time with 2 minutes 51 seconds is still acce ptable. In particular, PRK4B and RKN4B have a pprop riately same CPU times, a nd need small additional com putational cost compared with S4B. The main results of the A and B type algorithms in Figures 3 and 4 are in c luded in Figures 5 (a) and (c). The fourth-order metho ds from high accu racy to low accura cy in Figure 5(a) are PRK4B ≻ RKN4B ≻ PRK4A ≻ RKN4A ≻ S4B ≻ S4A. Note that PRK4B is slightly better th a n RKN4B in accuracy. In particular, the error s of PRK4B and RKN4B are four orders of magnitude smaller than that of S4A, and three orders of magnitude smaller than that of S4B. For comparison, the errors of four methods TS4, LS4, T PRK4 an d LPRK4 are plotted in Figure 5(b). TS4 is the Yoshida’s f ourth-order construction combining the extended phase space symplectic metho d of Tao (20 16a). LS4 is the Yoshida’s fourth-order construction combining the extended phase spac e symplectic-like method of Luo et al. (2017). TPRK4 is the fourth-order PRK4 method combining the Ta o’s method. LPRK4 is the fourth-order PRK4 method combining the meth od o f Luo et al. The ir details are given in Appen dix. It can be seen clearly from Figures 5 (a) and (b) that TS4 is almost the sam e as S4A in accuracy. The algorithms from low accuracy to high accuracy a re TS4 ≺ LS4 ≺ S4B ≺ TPRK4 ≺ LPRK4 ≺ RKN4B ≺ PRK4B. The superiority of the extended phase space symple c tic-like methods with the midpoint permutations to the same type extended phase spac e symplectic methods without the use of any permutations (e.g., LS4 ≻ TS4) in accuracy is consistent with that of Wu & Wu (2018). As far as the CPU times in Table 2 are conc erned, the computational efﬁciency of LS4 is slightly superior to that of TS4. The efﬁciency of TS4 is close to those of S4A and S4 B. The cost of TPRK4 is slightly larger than those of RKN4B and PRK4B, whereas that of LPRK4 is slightly smaller. When the integration time is less th a n 10, the sixth-order methods from good accuracy to poor accu racy in Fig ure 5(c) are PRK6B ≻ RKN6B ≻ PRK6A ≻ RKN6A ≻ RKN6B ≻ S6B ≻ RKN6A ≻ S6A. As the integrations continue, the four methods PRK6B, RKN6B, PRK6A and RKN6A show secular drifts in the errors. The related errors of these algorithms are clearly listed in Table 3. The fourth-order methods PRK4B and RKN4B are four orde rs of magnitude better in accura cies than the fourth -order Yoshida method S4A or the fo urth-order Tao extende d phase space method TS4. The sixthorder methods such as RKN6B have no advantages over the fourth-order methods PR K4B and R KN4B. Let us investigate the accuracies of the aforementioned algorith ms in the three-part and four-part splitting methods for other choices of parameters and initial conditions. Taking E = 0.995, L = 4,β= 1 × 10 and r = 15.5, we obtain a ﬁgure-eight orbit on the Poincar´e section in Figure 6 (a). This ﬁgure-eig ht orbit has a hyperbolic ﬁxed point, which corresponds to a stable direction and another unstable direction. It is a separation layer between the regular and chaotic regions. The acc uracies of the fourth-order integrators in Figure 6(b) are similar to those in Figu re 5( a). There are small differences between Figur es 6(b) and 5(a). The accuracy of ea ch integrator in Figure 6(b) is about one order higher than that in Figure 5(a). The accuracies o f the sixth-order integrators (such as PRK6B) in Figure 6(c) have no explicit advantages over those of the fourth-order integrators (e .g., PRK4B) in Figure 6(b). Whe n a chaotic orbit with parame ters E = 0.992, L = 4,β= 1.7 × 10and initial separation r = 25 in Figure 7(a) is selected as a test orbit, the optimal fourth -order method PRK4B o r RKN4B in Figure 7(b) has several orders of magnitud e better in accuracies than the fourth-order method S4A . The sixthorder methods in Figure 7(c) are not exp licitly superior to the fourth-order PRK and RKN methods in Figu re 7(b). The main result can be conclu ded from Figures 5-7 and Tables 2 and 3. The optimal fourth-order meth ods PRK4B and RKN4B are th e best ones of the aforementioned algorithms, and show the best numerical performance in computational accuracy and efﬁciency. Explicit symplectic integrators are not available for curved spacetimes such as the Schwarzschild or Kerr type spacetimes if the Hamiltonians correspo nding to these spacetimes are split into two parts like Hamiltonian problems in the solar system. This is because the two parts lack the separ ation of variables, are nonintegrable, or have analytical solutions which are not explicit functions of time but are implicit functions of time. A series of recent works (Wang et al. 20 21a, 2021b, 2021c; Wu et al. 2021) have successfully worked out this obstacle. The basic idea is splitting the considered Hamiltonians or time-transfo rmed Hamiltonianss into more par ts whose analytical solutions are explicit functions of time. A notable point is that the Hamiltonian splitting method is not unique but has various choices. Taking a Hamiltonian describing the motion of charged particles around the Schwarzschild black hole immersed in an external magnetic ﬁeld a s an example, we can easily separate the Hamiltonian into three, four and ﬁve explicitly integrable parts, which are expected to have analytical solutions as explicit functions of tim e. Errors of an integrator of order 2 or 4 closely depend on the Hamiltonian splitting method. Given an appropriate time step , this integrator shows the be st accura cy in the three-part splitting metho d, but the poorest accuracy in the ﬁve-part splitting me thod. This result is indepen dent of the type of orbits which are regular or chaotic. It is also fou nd tha t the o ptimized fourth-order PRK and RKN explicit symplectic integration schemes in the three-part splitting are several orders of magnitude better in accuracies than the fourth-order Yosh ida methods. T he for mer algorithms need small additional computational cost compared with the latter ones. The optimized sixth-order PRK and RKN explicit symplectic integrators have no dramatic advantages over the optimized fou rth-order ones in accuracies during long-ter m integrations due to the rapid accumulation of rou ndoff errors. Although the choice of the best explicit symplectic integrators is based on the Schwarzschild spacetime backgrou nds, it is applicable to the Kerr ty pe spacetimes o r other curved spacetimes. That is, time transformed Hamiltonia ns associated with the Kerr type spacetimes, or (time-transforme d) Hamiltonians correspo nding to the other curved spacetimes, should decrease the number of exp licitly integrable splitting parts. Such a splitting method is helpful to decrease the number of computations and then reduces the roundoff errors. In th is case, the optimized fourth-order PRK and RKN explicit symplectic integrators will exhibit the best perform ance. The four-dimensional phase space Hamiltonian in Equation (6) is labelled as H = H(r, idea o f Pihajoki ( 2015) and extending the phase spac e to an eight-dimensional phase spac e (r, we have a new Hamiltonian Γ as follows: Clearly, Γand Γare independently analytically solvable. Advancing time h, their ﬂows are described b y Ξ Ξ. Equation (13) bec omes Replacing S2A with S2Γ in Equation (14), we obtain a fourth-order explicit symplectic integrato r S4Γ in the extended phase space. Luo et al. (2017) introduced a midpoint permutation matrix The method S4Γ combining the matrix Ψ corresponds to a fo urth-order explicit scheme Due to the inclusion of the permutation Ψ, LS4 is a symplectic-like method for the extend e d phase space Hamiltonian Γ. Similarly, Equations (16) and (17) become Usingχandχinstead ofχandχin Equation (23), we have PRK symplectic-like method is , ˜p), 4Γ. Thus, an extended phase space PRK explicit to Equatio n (A1), Tao (2016a) obtained another new Hamiltonian Here,ωis a parameter controlling the binding of the two copies. Noting that H Equation (28), we have TS4 correspon ding to S4B in Equation (36) a nd TPRK TPRK4 are two fourth-order extended phase spac e explicit symplectic method s for the Hamiltonian K. Numerical accuracies depend on the contr ol parameterω. Forω= 3.553 in Figure 8(a), the meth od TS4 has the best accuracy. Forω= 7.943 in Figure 8(b), the method TPRK4 performs the best accur a cy. The two values o f other computations. The authors are very gratef ul to the anonym ous referee for valuable comments and suggestions that have greatly improved this article. This research has been supported by the National Natural Science Foundation of China (Grant Nos. 11973020 and 11533004) and the National Natural Science Foundatio n of Guangxi (No. 2019JJD110006).