* Correspondence: ﬂorian.mouret@terranis.fr; ﬂorian.mouret@irit.fr Abstract: multispectral images and acquisition problems. This can be a critical issue for crop monitoring, especially for applications relying on machine learning techniques, which generally assume that the feature matrix does not have missing values. This paper proposes a Gaussian Mixture Model (GMM) for the reconstruction of parcel-level features extracted from multispectral images. A robust version of the GMM is also investigated, since datasets can be contaminated by inaccurate samples or features (e.g., wrong crop type reported, inaccurate boundaries, undetected clouds, etc). Additional features extracted from Synthetic Aperture Radar (SAR) images using Sentinel-1 data are also used to provide complementary information and improve the imputations. The robust GMM investigated in this work assigns reduced weights to the outliers during the estimation of the GMM parameters, which improves the ﬁnal reconstruction. These weights are computed at each step of an Expectation-Maximization (EM) algorithm by using outlier scores provided by the isolation forest (IF) algorithm. Experimental validation is conducted on rapeseed and wheat parcels located in the Beauce region (France). Overall, we show that the GMM imputation method outperforms other reconstruction strategies. A mean absolute error (MAE) of 0.013 (resp. 0.019) is obtained for the imputation of the median Normalized Difference Index (NDVI) of the rapeseed (resp. wheat) parcels. Other indicators (e.g., Normalized Difference Water Index) and statistics (for instance the interquartile range, which captures heterogeneity among the parcel indicator) are reconstructed at the same time with good accuracy. In a dataset contaminated by irrelevant samples, using the robust GMM is recommended since the standard GMM imputation can lead to inaccurate imputed values. An application to the monitoring of anomalous crop development in the presence of missing data is ﬁnally considered. In this application, using the proposed method leads to the best detection results, especially when SAR data are used jointly with multispectral images. Exploiting the information contained in cloudy multispectral images instead of removing these images is beneﬁcial for this application. Keywords: Isolation Forest; Anomaly detection; Heterogeneity; Vigor; Missing data; Expectation-Maximization; Robust Gaussian Mixture Model; Data imputation TerraNIS, 12 Avenue de l’Europe, 31520 Ramonville-Saint-Agne, France University of Toulouse / IRIT-INP-ENSEEIHT / TéSA, 2 Rue Charles Camichel, 31000 Toulouse, France University of Toulouse / IRIT-UPS, 118 Route de Narbonne, 31062 Toulouse Cedex 9, France Missing data is a recurrent problem in remote sensing, mainly due to cloud coverage for 1. Introduction precision farming [ vegetation without a need for on-site visits [ sensed images has drastically increased, especially thanks to the Copernicus mission operated by the European Space Agency (ESA). Its ﬁrst multispectral high resolution satellite (Sentinel-2A) was launched in 2015, followed by a second satellite in 2017 (Sentinel-2B) [ Sentinel-1A and Sentinel-1B, are also part of the Copernicus mission and were launched in 2014 and 2016 [53]. Sentinel-1 (S1) and Sentinel-2 (S2) images are available with high temporal and spatial resolutions, which is well suited for precision agriculture. S2 images have been widely used for crop mapping and monitoring, e.g., for the detection of land use anomalies [ such as the leaf area index (LAI) [ [12]. Since S1 images can provide information regarding water content and the structure of the vegetation [29], they have been also largely investigated for crop monitoring and mapping [ joint use of these sensors has been motivated by their complementary [14,27,39,41,55]. which is an inherent problem in remote sensing. Multispectral images are particularly sensitive to this issue since they are affected by clouds (to a lesser extent, acquisition problems can also affect SAR images). The problem of missing data is of crucial importance when using machine learning techniques, which generally assume a complete feature matrix. The lack of timely information on crops has been identiﬁed for decades as a main limitation for precision agriculture based on remote sensing [ reconstruction of multiple parcel-level features extracted from S1 and S2 data, when part of S2 images are missing due to the presence of clouds. The features used in this study were previously investigated for the detection of abnormal crop development at the parcel level [ values, which is obviously not acceptable for operational applications. To that extent, we also propose to evaluate the interest of considering partially cloudy images (with missing data) for this application. general review [ 2) spectral-based methods, 3) temporal-based methods and 4) hybrid methods (combining the spatial, spectral and temporal strategies). For crop monitoring, temporal-based and hybrid methods are generally used, since the temporal information is an essential indicator when analyzing the vegetation status. Temporal-based methods are also known as “gap ﬁlling” and traditionally rely on linear or spline interpolations. They are well suited to dense noisy time series and have provided interesting results, e.g., for the classiﬁcation of crop types or the prediction of plant diversity [ precision when there is a need to monitor abrupt changes or when data from a large period of time is missing. Hybrid methods have been used intensively in remote sensing, mostly because they are able to impute missing data in multimodal signals and images, such as multispectral and SAR images. Recent techniques based on deep learning have also been investigated for SAR-Optical image matching [ Image matching can be interesting to reconstruct large parts of S2 image. However it generally uses a single SAR image acquired at a date close to the multispectral image to be reconstructed. Consequently, this method does not fully exploit all the available data acquired throughout the growing season. Deep learning methods have also been used to regress NDVI time series based on SAR times series and various other external indicators (e.g., weather, terrain) [ for large scale applications, these methods need a huge amount of training data (more than 23850 parcels are analyzed in [ French Land Parcel Identiﬁcation System (LPIS) used in these studies is generally available with a delay of Remote sensing images have become an essential tool for many agricultural applications, including A main challenge that can affect all the aforementioned applications is the presence of missing data, Various methods have been proposed in the remote sensing literature to deal with missing data. A one or two years. Moreover, the method proposed by Garioud et al. NDVI as a function of SAR time series and does not exploit the available S2 information for the imputation task. Similarly, Pipia et al. Gaussian processes. However, this method has been designed to reconstruct a single optical time series using a single SAR time series, which is too restrictive for the problem addressed here. fashion by using a Gaussian Mixture Model (GMM) [ (EM) algorithm. The main originality of the proposed approach is to use outlier scores resulting from an outlier detection algorithm within the EM algorithm to 1) detect abnormal agricultural parcels and 2) have a robust parameter estimation of the GMM parameters. GMMs have been used successfully in remote sensing, e.g., for clustering [ to reconstruct missing data [ knowledge). The main motivation for using GMMs is their faculty to learn complex behaviors in a fully unsupervised way. Even if these models also suffer from the curse of dimensionality, they can be used with a limited amount of data, which is important here since the number of analyzed parcels is relatively small (the database used in the experiments contains around 2000 parcels). data and the proposed method. Experimental results are presented in Section 3, with an application to the detection of anomalies in the development of rapeseed crops (additional experiments were conducted on wheat crops and are available in the supplementary materials). In Section 4, a discussion on the results and the different imputation methods is proposed. Finally, some conclusions are drawn in Section 5. 2.1.1. Study Area and Parcels center is located approximately at 48 this study area, 2218 rapeseed parcels are monitored for the 2017/2018 growing seasons. All the parcels affected by clouds were discarded in a ﬁrst analysis in order to have a reliable ground-truth to validate the proposed imputation method. Note that experiments were also conducted on 3361 wheat parcels (for the growing season 2016/2017). Since the results obtained conﬁrmed those obtained on rapeseed parcels, they are reported in the supplementary material attached to this document for the sake of conciseness. 2.1.2. Satellite Data data collected for this study has been acquired in both ascending and descending orbit passes and in dual polarization (VV and VH). Ground Range Detected (GRD) products are used in the Interferometric Wide (IW) swath mode (phase information is lost but the volume of data is drastically reduced) [ following preprocessing steps have been applied to each S1 image: thermal noise removal, calibration, terrain ﬂattening and range Doppler terrain correction. Multi-temporal speckle ﬁltering was tested, but without bringing any improvement for the considered application. Overall, 40 S1 images were selected for the growing season analyzed. Note that a drop in the number of available S1 images was observed after April 2018 (this can be observed in all web pages related to sentinel data, conﬁrming an acquisition problem). The method investigated in this paper can impute missing features derived from S2 data in a robust The rest of this paper is organized as follows. Section 2 presents the study area with the available The area of interest is located in France (Beauce region) and corresponds to the S2 tile T31UCP (whose S1-A and S1-B satellites are SAR C-band imaging satellites whose center frequency is 5.405 GHz. The the near infra-red (NIR) and the shortwave-infrared (SWIR) spectral region [ products expressed in surface reﬂectance are obtained using the MAJA processing chain [ provides cloud and shadow masks. Overall, 13 S2 images were selected for the considered growing season. This low number of images is due to the cloud coverage, which often leads to images fully covered by clouds, especially in winter. For instance, no S2 image is exploitable between December 2017 and the end of February 2018, as shown in Figure 2. 2.1.3. Pixel-level features features showed interest for crop monitoring and the detection of anomalous development, as detailed in [39 Difference Vegetation Index (NDVI) [ Normalized Difference Water Index (NDWI) [ Ratio Index (MCARI/OSAVI) [ focusing on a particular spectral response of the vegetation. S1 features are directly the VV and VH backscattering coefﬁcients. Combinations of these coefﬁcients were tested (e.g., their ratio) but without Figure 1.The Sentinel-2 tile considered in this work is delimited by the red box. The S2 image processed in level 2A acquired in June 28 2018 is displayed in natural colors in the right part of the Figure. S2-A and S2-B satellites are multispectral imaging satellites with 13 spectral bands covering the visible, Figure 2.Each marker corresponds to the acquisition date of a used image for the growing season 2017/2018. The features extracted at the pixel-level from S1 and S2 images are detailed in Table 1. Each of these ]. S2 features consist of 5 benchmark agronomic vegetation indices (VI), namely the Normalized improving the quality of the detection results [ (depending on the application) without changes in the proposed imputation approach. 2.1.4. Parcel-level features and creation of the feature matrix and the interquartile range (IQR). The median is a robust mean value of an indicator, and can capture the mean behavior of a given parcel. The IQR captures the dispersion of an indicator, providing relevant information at the parcel-level regarding potential heterogeneous development of the vegetation. Note that IQR is not computed for the S1 features, since it is directly proportional to the median. Each parcel is characterized by the different parcel-level statistics computed at each acquisition. The number of columns of the feature matrix is computed for each S1 feature. Similar deﬁnitions apply to chain that leads to the creation of the feature matrix used for the detection of outlier parcels is summarized in Figure 3. Each line of the feature matrix has 210 features characterizing each rapeseed parcel (when considering all the acquisition dates and all the spatial statistics, i.e., 130 S2 features and 80 S1 features). consult this reference for complementary information and additional examples, especially regarding the description of the parcels with anomalous development. Table 1.Pixel-level features extracted from S2 and S1 images used for the crop analysis. For S2, the near infrared (band 8), red edge (band 5), short wave infrared (band 11), green (band 3) and red (band 4) channels are denoted as NIR, RE, SWIR, GREEN and RED, respectively [39]. S2 indicators are in the range [-1,1], except for MCARI/OSAVI varying in the range [0, +∞]. Parcel-level features are computed from pixel-level features by using two spatial statistics: the median is the number of pixel-level features extracted for each S1 image,Nis the number of statistics Note that the study area and the data were also used in [39]. The interested reader is invited to 2.2. Imputation of Missing Values with Mixture of Gaussians using the EM Algorithm matrix. GMMs can be learned using the Expectation-Maximization (EM) algorithm, which can be naturally extended to handle missing data in a multivariate space [ the EM algorithm for GMM estimation, we introduce a robust modiﬁcation of this method taking into account the presence of outliers in the dataset and improving the estimation of the model parameters. More details about GMMs can be found in the classic book from Bishop dealing with regularization techniques for GMM in high dimension was proposed in Bouveyron and Brunet-Saumard it is worth mentioning the review proposed by Rehman et al. algorithm for the detection of cucumber disease was considered in Zhang et al. [65]. 2.2.1. The standard EM algorithm constant): where density function (PDF) of the multivariate normal distribution and contains the parameters to be estimated. These parameters are the mean vectors Σand the mixing coefﬁcients respect to (w.r.t.) associated with the observed vectors known labels) and the complete log-likelihood: where an appropriate initialization of Figure 3.The different steps leading to the creation of the feature matrix used for the detection of parcels with anomalous behavior. NDVIdenotes the NDVI computed at time instanttwhile medianand IQRdenote the spatial median and IQR for the indicator computed inside the parcel #M. The proposed approach uses a multivariate GMM to impute the potential missing values of the feature Given a feature matrixX, we assume that each row of this matrix is distributed according to a mixture Gaussian distributions. The corresponding log-likelihood can be expressed as (up to an additive Nis the number of samples in the dataset,xis a speciﬁc sample,N (x|µ,Σ)is the probability z=1 if the vectorxbelongs to thekth component of the GMM andz=0 otherwise. After oflog L expectation of the complete log-likelihood conditionally to the current set of the mixture parameters, where E[log L For brevity, we will denote the rest of the paper. probabilities that the sample x with not change signiﬁcantly or after a ﬁxed number of iterations. 2.2.2. Extension to handle missing data can be itself viewed as a missing data problem [ decomposed into respectively. More generally, the superscripts of the sample matrix and expressed as follows: with multivariate normal probability density of the observed sample for missing data computes the component responsibilities using the observed variables [23]: (θ;X,z)in an iterative fashion until convergence. The expectation step (E-step) computes the γ= E[z= k|x,θ]is referred to as responsibilities. The maximization step (M-step) maximizes (θ; z) |θ] w.r.t. θ to provide an updated parameter vector θ: E-step: in practice the E-step reduces to the computation of the responsibilitiesγ, which are also the M-step: the parameters are re-estimated using the updated responsibilities: N=∑γ. The EM algorithm is stopped when the log-likelihood or the parameter values does The EM algorithm is known to be able to handle missing data since the estimation of mixture densities Σin the rows and columns speciﬁed byoandm(and so on). For brevity, we will denoteo= o m= min the following. Using these notations, the log-likelihood of the observed vectors can be Xthe set of all observed variables,Xthe set of all missing variables, andN (x|µ,Σ)the marginal computation of additional terms due to the evaluation of the following quantities have to be computed: where conditional expectation and the conditional covariance matrix of the missing variables of a sample given that missing values of has been ﬁlled with zeros except for the missing components, which corresponds to the covariance matrices using an additional term taking into account the missing values: More details about the EM algorithm for the GMM with missing data can be found for instance in Ghahramani and Jordan [16] classiﬁcation and regression. 2.2.3. Robust GMM presence of outliers, especially in the M-step [ classiﬁcation with remote sensing images, Tadjudin and Landgrebe estimation method which associates weights to the observed samples. The idea is that samples with a reduced weight (corresponding ideally to outliers) will have a small inﬂuence on the estimation of the model parameters. However, the method proposed in Tadjudin and Landgrebe main limitations: 1) It does not detect the outliers in an unsupervised way and 2) It does not take into account the presence of missing data. To overcome these issues, we propose to modify this method by using the output of the Isolation Forest (IF) algorithm, which is a reference method for the detection of the outliers [ advantage of providing an outlier score in the range [0,1]. In order to build a robust GMM, we propose to weight the importance of each sample in the M-step by using the anomaly score provided by the IF algorithm. The resulting robust EM algorithm updates the unknown GMM parameters in the M-step as in [52] In the presence of missing values, the expectation of the complete data likelihood requires thehi 0,0and0are matrices of zeros of appropriate dimensions. Note that(9)and(11)are the xhas been generated by Gaussian #k, i.e.,ˆµ= E[x|x]andˆΣ= Var[x|x]. Note also that the In the presence of missing data, the M-step replaces the means by their imputed values and updates devoted to the estimation of distances with missing values and applied to various tasks including The estimation of the means and covariances of a GMM using the EM algorithm is sensitive to the 32]. This algorithm was found to be efﬁcient to detect relevant abnormal parcels [39] and has the However, contrary to [ as score where the fact that it is a smooth monotonically function of the weights taking its values in the range [0,1], with a unique inﬂection point equal to values of more slowly from 1 to 0 for lower values of explained in Liu et al. is depicted in Figure 4 for α = 50 and th = 0.5. 2.3. Regularization of the covariance matrices matrices are ill-conditioned (in some extreme cases, the covariance matrix cannot even be inverted). A heuristic strategy for regularizing a covariance matrix consists in adding a small constant to its diagonal elements during the estimation (e.g., this regularization is proposed in the Python library scikit learn [ Alternatively, Bouveyron et al. of covariance matrices for high dimensional problems. In this study, we have considered the model referred to as eigendecomposition of the covariance matrices constant operation signiﬁcantly reduces the number of model parameters to estimate, which is valuable to ﬁght against the curse of dimensionality. The scree test is used to ﬁnd the number of eigenvalues to be set to the constant value b (see Bouveyron et al. [6] for details). (ˆx) for the imputed sample ˆx) as follows: αandthare two constants to be ﬁxed by the user. Motivations for using the sigmoid(15)include th, the sigmoid(15)reduces to a hard thresholding operation aroundth, whereas it decreases Figure 4.Variation of the weightwversus the outlier score attributed by the IF algorithm, withα =50 and th = 0.5. Learning the parameters of a GMM can be subject to instabilities, especially when the covariance b= b(which can be justiﬁed when the data are obtained in a common acquisition process). This 3. Results using the k-nearest neighbors (KNN)[ using the technique mentioned in Section 2.3. Various other imputation methods (gap ﬁlling, autoencoders, multiple imputations, soft imputation) were tested and are discussed in Section 4. They are not presented here for conciseness since they did not improve our results. The results presented in this paper focus on the imputation of multispectral S2 time series, but the same method could be used to reconstruct S1 features as well. Finally, note that before the GMM and KNN imputations, each feature was scaled in the range obtained using the inverse transformation). 3.1. Simulation scenarios and performance measures presence of missing values in the observed data. We also introduce metrics to evaluate the performance of the different algorithms considered to reconstruct the missing data. An application to the detection of anomalies in agricultural parcels is ﬁnally described with appropriate performance measures. 3.1.1. Simulation scenarios we removed some existing features in the dataset introduced in Section 2.1.4. Two parameters control the number of missing data: the percentage of S2 images having missing values (e.g., due to the presence of clouds), and for each of these S2 images, the percentage of parcels affected by missing values (the parcels affected by clouds are not necessarily the same for each S2 image). For a given S2 image with missing data, we have removed all the features associated with this image for all the affected parcels. In practice, for cloudy days, missing values are likely to affect a signiﬁcant amount of the parcels. In the presented experiments, half of the total number of parcels (chosen equally likely in the database) was supposed to be cloudy with all S2 features removed (other tests were made with different percentages of cloudy images leading to similar conclusions). The different scenarios considered in this paper are summarized in Table 2. 3.1.2. Performance measures the different missing features, with the advantage of being unambiguous and naturally understandable compared to the root mean squared error (RMSE) [61]. The MAE is deﬁned as follows: Both robust and non-robust GMM imputation methods are compared to the imputation obtained [0, 1]using the available values, i.e., without the missing data (features in natural scale can then be This section provides details on the simulation scenarios, which were designed to evaluate the In order to evaluate the performance of missing data reconstruction with a controlled ground truth, Table 2.Summary of the experiments conducted in this paper with the percentage of cloudy S2 images and the percentage of cloudy parcels within a given cloudy S2 image. The column “Cloudy S2 images” indicates the percentage of S2 images with missing values whereas the column “Affected parcels” provides the percentage of parcels with missing values within a cloudy S2 image. The mean absolute reconstruction error (MAE) is used to evaluate the quality of the reconstruction of where estimation (also referred to as imputation or reconstruction). abnormal crop development in the presence of missing data. Using an outlier detection algorithm (here, the IF algorithm) to detect potential anomalies, the precision of the results (deﬁned by the number of true positives divided by the total number of parcels detected as outliers) is computed for various outlier ratios. This outlier ratio is ﬁxed by the user and corresponds to the percentage of abnormal parcels to be detected. The area under the precision vs. outlier ratio curve (AUC) is a good metric to measure the ability of an outlier detection algorithm to detect relevant anomalies. It is similar to the precision vs. recall curves or receiver operational characteristics with the advantage of being adapted to imbalanced datasets containing outliers [39,49]. 3.2. Parameter tuning and convergence more details included in the next sections. (BIC) as suggested in Bouveyron and Brunet-Saumard a need for manually choosing the number of components, which can be difﬁcult in practice (especially for an unsupervised task). For the regularization of the covariance matrix, the stopping criterion of the scree test was set to 10 (typically lower than 10 deterioration of the imputation results. ﬁxed to et al. did not have a signiﬁcant impact on the imputation results. EM algorithm was initialized by the output of the K-means algorithm with likely in the dataset. This initialization yields a fast convergence of the EM algorithm obtained in less than 10 iterations. The EM algorithm was stopped when the difference between two consecutive values of the log-likelihood was less than 10 we ran 50 Monte Carlo (MC) simulations of the EM algorithm using the same dataset (1 S2 image covered by clouds, 50% of the parcels affected by missing values) with different random initializations and imputed the missing values. The distribution of the MAE obtained for these Monte Carlo runs (evaluated using all the reconstructed features for the parcels with missing data) is displayed in Figure 5, showing that the values of MAE are very similar, varying in the interval [0.02178, 0.02186]. These results indicate that the EM algorithm is not very sensitive to its initialization for the reconstruction of VI at the parcel level. “KNNimputer”) was used as a benchmark. The number of nearest neighbors was ﬁxed to the value of this parameter in a neighborhood did not have a huge effect on the reconstruction results. The contribution of each neighbor was weighted by the inverse of its distance to the sample to be imputed, similarly to the conﬁguration used in [1]. Nis the number of missing features,fis the original value of theith feature andˆfdenotes its The second set of experiments shows the usefulness of the proposed method for the detection of The hyperparameters used for the different reconstruction algorithms are reported in Table 3, with The number of GaussiansKin the GMM was estimated using the Bayesian Information Criterion The parameters of the weighting functionware the thresholdthand the slopeα. The threshold was th =0.5, which is a natural value to separate outliers and inliers when using the IF algorithm Liu [32]. The slope parameter was ﬁxed toα =40 by cross validation. Small changes in these parameters The outputs of the EM algorithm depend on its initialization, which is detailed in what follows. The The KNN imputation method available in the Python library Scikit-Learn [42] (version 0.24) (named 3.3. Data imputation time series of vegetation indices for crop monitoring. In particular, we test the robustness of the proposed approach to the amount of missing data, and in a second step to the amount of outlier by introducing samples coming from different crop types. 3.3.1. Imputation results obtained by varying the amount of S2 images affected by missing values 1% of errors in the crop type reported) or the features (e.g., few undetected clouds) as detailed in Mouret et al. conditions. percentage of S2 images affected by missing values, as depicted in Figure 6. All the results were obtained by averaging the outputs of 50 MC runs. We recall that for each S2 image with missing data, 50% of the parcels were randomly chosen in the database and their corresponding features were removed. The MAE obtained for all the S2 features is depicted in Figure 6(a) whereas Figure 6(b) and (c) show speciﬁcally the MAE of the median and IQR NDVI. Note that in Figure 6(a), the S2 features are scaled in the range [0,1] to be able to have comparable results (e.g., MCARI/OSAVI features are not normalized), which can lead to MAE greater than those obtained in natural scale. One can observe that the GMM imputation algorithm outperforms the KNN imputation with good reconstructions even with a high amount of missing data. Results obtained with the classical GMM are close to those obtained with the robust GMM in these experiments. Looking speciﬁcally at the median NDVI (Figure 6(b)), it appears that using S1 data is particularly useful, especially when there is a high amount of missing S2 features. The reconstruction of IQR statistics is not favored by the use of S1 data, as shown in Figure 6(c). For this statistics, the robust GMM provides a lower MAE than the classical GMM. Figure 5.Histogram of MAE obtained after 50 Monte Carlo runs (with different initializations) on the same dataset. Table 3.Hyperparameters used in the experiments for the GMM and KNN algorithms. R-GMM refers to robust GMM. This section evaluates the imputation performance of the proposed GMM method when applied to The dataset used in this study is relatively exempt of errors coming from the parcel data (e.g, less than [39]. As a consequence, this dataset is a good start to test the imputation methods in controlled The inﬂuence of the amount of missing data on the imputation results was tested by varying the 3.3.2. Imputation results obtained by introducing samples coming from different crop types the rest of the data. In that case, GMM learning can be more difﬁcult and lead to inaccurate imputations. To investigate the sensitivity of the imputation method to the presence of irrelevant samples, agricultural parcels with a different crop type than rapeseed were included into the rapeseed dataset (these crop types mainly correspond to wheat, maize and barley). The features of these parcels were extracted using ﬁeld boundaries coming from the French Land Parcel Identiﬁcation System (LPIS) [ open license. (i.e., the percentage of non-rapeseed parcels in the dataset) are provided in Figure 7, showing the median of the MAE computed using 50 MC runs. The median of the MAE is used here since some extreme MAE values are obtained when using the standard GMM imputation due the presence of non-rapeseed parcels (contrary to the robust GMM). For each run, there are three random S2 images with missing values affecting 50% of the parcels (note that the MAE is computed using the rapeseed parcels only). Using the robust GMM imputation is particularly useful in that case, with an MAE almost stable with respect to the percentage of irrelevant samples in the dataset (it is especially true for the NDVI statistics). Note that the standard GMM imputation is highly impacted by the presence of outliers in the dataset and can lead to large errors, with reconstruction sometimes worse than those obtained using the KNN approach. Consequently, using the robust GMM imputation is recommended in practice, especially if the dataset contains some irrelevant samples. Figure 6.MAE for rapeseed vegetation indices versus the percentage of missing images. X-axis: percentage of S2 images with missing values. Y-axis: MAE for (a) the normalized S2 features (all the S2 indicators are considered), (b) the median of NDVI and (c) the IQR of the NDVI (computed at the parcel level). Results in dotted lines are obtained using S2 features only whereas solid lines correspond to the joint use of S1 and S2 data. The results are averaged after 50 MC runs. In practice, errors or noise can contaminate the feature matrix with samples that are very different from Imputation results obtained on the rapeseed parcels by varying the percentage of contamination 3.4. Application to the detection of anomalous crop development in the presence of missing data monitoring. Such detection can be useful for farmers or agricultural cooperatives to automatically detect parcels with potential problems, without a need for on-site visits. Typical crop anomalies can be grouped into 4 categories: growth anomalies, heterogeneity problems, database problems (i.e., wrong crop type or inaccurate boundaries reported in the database) and false positives (e.g., due to undetected clouds or shadows). An example of heterogeneous parcel is depicted in Figure 8 (a further analysis showed that a part of the parcel was damaged during winter). Each parcel was labeled by an agronomic expert as true positive (relevant anomaly to be detected) or false positive (not relevant for crop monitoring). Figure 7.Median of MAE versus the percentage of contamination in the dataset (i.e., coming from non-rapeseed crops) after 50 MC runs for (a) the normalized S2 features (all the S2 indicators are considered), (b) the median of NDVI and (c) the IQR of NDVI (computed at the parcel level). Results are obtained using S1 and S2 features jointly. For each MC run, the percentage of missing data has been ﬁxed: three S2 images (23%) have missing data affecting 50% of the parcels. Detecting potential anomalies in the development of crop parcels is an important problem in crop using the Isolation Forest algorithm, which computes anomaly scores using the feature matrix (whose construction is detailed in Section 2.1.4). The strongest anomalies are generally related to errors in the crop type (as simulated in Section 3.3.2), whereas other anomalies are parcels with abnormal phenological development. While it was shown that this method is useful to detect relevant anomalies in the crop development, one main problem is that this method cannot be applied in the presence of missing data. As a consequence, we propose to use an imputation method before the outlier detection step, in order to consider images partially covered by clouds. The distribution of the rapeseed parcels detected as abnormal using the IF algorithm with an outlier ratio of 20% is displayed in Figure 9. application of the IF algorithm. The AUC values (the higher the better) obtained by varying the amount of Figure 8.(a) A rapeseed parcel (yellow boundaries) affected by heterogeneity, the image was acquired in May 2018. (b) Interquartile Range (IQR) of the NDVI time series for the yellow parcel (orange line). The blue line is the median value of the whole dataset. The blue area is ﬁlled between the 10th and 90th percentiles. The orange line clearly shows an abnormal behaviour of the parcel due here to heterogeneity problems. Following the method proposed in Mouret et al.[39], parcels with abnormal behavior are detected Figure 9.Distribution of the detected rapeseed parcels in each outlier category when using the IF algorithm with an outlier ratio of 20%. This section evaluates the inﬂuence of missing values on the detection results resulting from the S2 images affected by missing data are displayed in Figure 10 (more details on this metric were provided in Section 3.1.2). It can be observed that accurate results are obtained with AUC greater than 0.84, even with a high percentage of missing data in the dataset. In particular, the best results are obtained using S1 and S2 data jointly and a reconstruction with the GMM (both robust and non-robust versions perform similarly in that case). It is interesting to note that discarding S2 images affected by missing values yields a reduced detection performance, since some of the anomalies cannot be detected anymore. Thus, the imputation methods are able to reconstruct the VI with sufﬁcient accuracy to detect the abnormal crop parcels and important information on the parcel behavior seems to be lost without the reconstruction step. (available in the supplementary material) are also discussed. 4.1. Analysis of the presented results method 2) using a robust GMM is of crucial importance in the presence of strong outliers. Hence, our results conﬁrm the interest of using outlier detection techniques as standard preprocessing steps in remote sensing, as also recommended for instance in [ results are coherent with the literature: an MAE of 0.0281 was obtained in [ of NDVI in crop vegetation, an MAE of 0.038 was obtained in [ grassland parcels and MAE varying from 0.035 to 0.042 (depending on the region analyzed) was obtained in [22 important differences have to be highlighted: existing studies generally focus on NDVI time series acquired Figure 10.Area under the precision vs. outlier ratio curve (AUC) w.r.t. the percentage of cloudy S2 images (50% of the parcels in a cloudy S2 image have missing data, i.e., do not contain S2 features). Results in dotted lines are obtained using S2 features only whereas solid lines correspond to the joint use of S1 and S2 data. All results are averaged using 50 MC runs. This section provides some comments about the results obtained in this paper. Additional experiments The experiments conducted in this study show that 1) GMM imputations outperform the KNN ] for agricultural parcels. While these results provide quantitative values for comparison purposes, at the pixel-level and do not analyze crops at the parcel level, as proposed in this paper. Moreover, some of these studies focus on the regression of SAR time series towards NDVI [ MAE close to 0.013 (resp. to 0.019) when imputing the median NDVI for rapeseed (resp. wheat) crops is encouraging (see Tables S1 and S2 in the supplementary materials). particular, using S1 features is interesting to reconstruct more accurately S2 features and thus ensures a better detection of crop anomalies. Two speciﬁc examples illustrating the interest of using S1 data are provided in the supplementary material for rapeseed and wheat parcels (Figures S2 and S3). The heterogeneity of a parcel (summarized using IQR at the parcel-level) is less linked to S1 data, which conﬁrms previous results given in [ data helps to reconstruct missing data in NDVI time series when compared to using NDVI only. it appears that some speciﬁc stages of the growing season are more difﬁcult to reconstruct, with differences observed for rapeseed and wheat crops. For rapeseed crops, the ﬁrst S2 acquisition (October 10) is challenging to reconstruct. One explanation is that at this date some ﬁelds are not sowed yet whereas others are already vigorous, leading to a higher dispersion of the parcel indicators. The higher MAE obtained for S2 data acquired in February can be explained as follows: 1) S2 images before and after this date correspond to very distant dates 2) crop parcels can be more or less affected by winter, which again leads to a larger dispersion of the indicators. Regarding wheat crops, the high reconstruction errors observed for the data acquired in June 18 can be explained by the beginning of the senescence, which leads to abrupt changes in the crop behavior. 4.2. Other imputation methods compared to the proposed method (see Figure S6 in the supplementary material). Some observations are brieﬂy provided below. overall poorly compared to the methods investigated in this paper, which is mainly due to the sparsity of S2 acquisitions, conﬁrming the results found in [ crop development, smoothing methods tend to decrease the accuracy of the detection results. Other benchmark imputation methods were tested, such as Multiple Imputation by Chained Equations (MICE) proposed in van Buuren and Groothuis-Oudshoorn [42]. Similarly to the KNN imputation, this method provides reconstruction results signiﬁcantly less accurate than those obtained using the proposed GMM imputation algorithm. Deep learning methods were also tested without success (a classical structure named denoising autoencoders was tested [ due to the small number of parcels in the dataset. is the case with the IF algorithm, which can be extended to handle missing values without imputation using the strategies studied in [ computation time when compared to GMM-based methods. However we observed that these methods are sensitive to the amount of missing values in the dataset and can lead to poor results. Moreover, having access to reliable reconstructed time series is interesting for crop monitoring since it allows the user to analyze with more details the behavior of an abnormal parcel. The interest of using a combination of S1 and S2 features was conﬁrmed by our experiments. In When removing features from one of the S2 image (Figures S4 and S5 in the supplementary material), Other strategies for the imputation of missing data were tested without bringing any improvement Gap ﬁlling methods (linear interpolation, spline interpolation and Whittaker smoother) [8] perform Finally, we considered some outlier detection methods that do not need to impute missing data. It 4.3. Regularization techniques for GMM especially due to the small number of parcels compared to the high number of features. The regularization of Bouveyron et al. [6] used in this paper provided the best results overall. which can be solved using the graphical lasso algorithm [ problem [ indices. The sparsity of the precision matrix is due to conditionally independent variables, which is not the case in the proposed feature vector gathering the same features acquired at different time instants. The sparsity of the covariance matrices was also investigated using the method proposed in [ improving the results obtained with the [a 5. Conclusion reconstruction of remote sensing time series constructed from vegetation indices (VI) associated with Sentinel-2 (S2) data. One contribution of this paper is to propose a method able to reconstruct simultaneously various time series, coming from different VI whose statistics have been computed at the parcel-level. These statistics (here, the median and interquartile range) are well suited for crop monitoring since they can characterize efﬁciently the parcel behaviors, e.g., to detect abnormal growth or heterogeneity problems. This paper showed that using a GMM imputation to reconstruct missing values in the feature matrix performs signiﬁcantly better than other reference methods such as the k-nearest neighbors or the Multiple Imputation by Chained Equations (MICE)). weights to each sample based on the outlier scores resulting from the Isolation Forest algorithm. Samples with high outlier scores have reduced weights, limiting their impact on the estimation of the GMM parameters. Using the proposed robust GMM method instead of the standard GMM imputation method is particularly useful in the presence of irrelevant samples contaminating the dataset. For operational services, we then recommend to use this robust version since it consistently provides reconstruction results similar or better than the standard GMM imputation method. can improve imputation results, especially to reconstruct S2 features at the parcel level, such as the Normalized Difference Vegetation Index (NDVI). This indicator can be reconstructed with good accuracy (mean absolute error (MAE) close to 0.013 for rapeseed crops and to 0.020 for wheat crops), even with a high amount of missing data (e.g., for rapeseed parcels, the MAE is close to 0.020 even when 70% of the S2 images have 50% of the parcels affected by missing data). investigated. Using S1 and S2 images jointly provided best results for this application. Using a Gaussian mixture model (GMM) for the reconstruction of missing data provided detection results signiﬁcantly better than with KNN imputation. Note that discarding images affected by clouds leads to poor results for this application. to GMM to improve the imputation results, for instance by ﬁnding an adapted structure for the covariance matrices or by reducing the dimensionality of the dataset. Moreover, since GMM are good models for vegetation indices, other applications, such as forecasting, clustering or classiﬁcation, would deserve to be investigated. In particular, the automatic classiﬁcation of the different anomalies could be considered as in León-López et al. GMM are subject to the curse of dimensionality [5]. This problem was conﬁrmed in our application, Another classical regularization consists of adding a sparsity constraint to the precision matrices, 48]. However, using such regularization yielded poor results for the reconstruction of vegetation This paper studied an imputation method based on Gaussian Mixture Models (GMM) for the Another contribution of this paper is to propose a robust GMM imputation method, which attributes The experiments conducted in this paper conﬁrmed that using additional Sentinel-1 (S1) features An application to the detection of anomalous crop development in presence of missing data was also Further investigations will be conducted to determine whether other regularizations could be applied reconstruct more efﬁciently the various VI, since interesting results were obtained for the reconstruction of NDVI time series [59,63]. Funding: no. 2018/1349). This document is the results of the research project funded by TerraNIS SAS. and ANRT (convention CIFRE