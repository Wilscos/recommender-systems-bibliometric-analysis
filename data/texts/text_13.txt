<title>Chao Cheng, Donna Spiegelman, and Fan Li</title> <title>Estimating the natural indirect eﬀect and the mediation proportion via the product method</title> <title>arXiv:2108.08417v1  [stat.ME]  19 Aug 2021</title> for point and variance estimation discussed in this paper. <title>1 Introduction</title> Biomedical and epidemiological studies evaluating the impact of exposure on health outcomes have received considerable attention in recent years. In addition to estimating the total eﬀect of the exposure on the disease outcome, it is also of interest to explore potential pathways and mechanisms underlying these exposuredisease relationships. An important tool for exploring these pathways is mediation analysis [ ], which decomposes the total eﬀect (TE) of the exposure into two components, a natural indirect eﬀect (NIE) through a pre-speciﬁed intermediate variable (i.e., the mediator) and a natural direct eﬀect (NDE) whose impact derives solely from the exposure. Formal deﬁnitions of NIE and NDE were ﬁrst given in ] under a causal framework. The NIE suggests how much we could exploit the exposure-disease mechanism through potential interventions targeting the mediator, especially in cases when it is diﬃcult to manipulate the exposure [5]. In mediation analysis, researchers sometimes calculate the ratio of the NIE and the TE to capture the relative importance of the mediator in explaining the pathway through which the exposure has an eﬀect on the outcome [ ]. This ratio is called mediation proportion (MP) or equivalently, the proportional mediated . There has been an increasing number of epidemiological studies that report the MP to explain the exposure-disease mechanism when conducting mediation analysis 10 11 12 ], and some of these studies include only a small to moderate sample size not exceeding 1000. Given the increasing use of MP, a comprehensive evaluation of the ﬁnite-sample operating characteristics of the point and interval estimators for MP is needed to better inform practice. Many statistical methods have been developed to identify and estimate the natural indirect eﬀect from observational data, including but not limited to the nonparametric approach [ 13 14 ], the weighting-based semiparametric approach [ 15 16 17 ], as well as the parametric outcome regression approach [ 18 19 20 ]. This paper will focus on the parametric outcome regression approach. The parametric outcome regression approach includes two major variants, the diﬀerence method 20 21 ] and the product method ]. The diﬀerence method evaluates two regression models for the outcome with and without conditioning on the mediator, whereas the product method evaluates a regression model for the outcome conditional on the exposure and mediator and another regression model for the mediator conditional on the exposure. When both the outcome and mediator variables are continuous and the ordinary least-squares is used to estimate regression model parameters, the diﬀerence method and product method are algebraically equivalent [ 18 ] for estimating the mediation eﬀects. With a binary outcome or a binary mediator, however, the product method generally does not coincide with the diﬀerence method, considered in our study as compared to several prior studies [ 30 31 27 18 32 24, 33, 28], across the four common data types. The remainder of this paper is organized as follows. In Section 2, we describe the product method to obtain the point and interval estimators of NIE and MP in the aforementioned four cases with diﬀerent data types. In Section 3, we describe our Monte Carlo simulation study that investigates the performance of the point and interval estimators for NIE and MP, and report our ﬁndings. To illustrate the product method, we study in Section 4 how much the eﬀect of an anti-retroviral delivery intervention on 12-month retention is mediated by the 6-month visit adherence in the MaxART study [ 34 ]. Section 5 concludes with a brief discussion. <title>2 Mediation analysis via the product method</title> <title>2.1 Mediation measures and the product method</title> Assume that we have an outcome of interest, , an exposure, , and a mediator, , where each variable can be continuous or binary. We also observe , a vector of covariates, associated with outcome and measured before the exposure, some of which may be confounders of the estimated exposure-outcome association and/or the mediator-outcome association. A directed acyclic graph illustrating the causal relationship between those variables is shown in Figure 1. We are interested in identifying two causal eﬀects, the NIE ad NDE. To identify these causal eﬀects, we will follow the counterfactual framework used in the classic causal inference literature [ ]. Speciﬁcally, we will follow the notation in [ 20 ] and deﬁne and as the outcome and mediator , respectively, that would have been observed when setting 𝑋 = 𝑥 . Similarly, let be the value of outcome that would have been observed when setting 𝑋 = 𝑥 and 𝑀 = 𝑚. Based on classical counterfactual frameworks, we make the following assumptions. First is the consistency assumption, which assumes that the potential outcome and potential mediator equal their respective observed variables and if we set 𝑋 = 𝑥 35 ]. Similarly, we also require that equals if 𝑋 = 𝑥 and 𝑀 = 𝑚 are observed [ 36 ]. The second is the composition assumption, which requires that = 𝑌 , i.e., the potential outcome where 𝑋 = 𝑥 is equal to the potential outcome when 𝑋 = 𝑥 and is set to its value corresponding to when 𝑋 = 𝑥 35 ]. In order to identify NIE and NDE, we also require several identiﬁcation assumptions in relation to confounding, including (A.1) ⊥⊥ 𝑋|𝑊 , (A.2) ⊥⊥ 𝑀 |𝑊 , 𝑋 , (A.3) ⊥⊥ 𝑋|𝑊 , and (A.4) ⊥⊥ 𝑀 |𝑊 for all , and . That is, (A.1)–(A.3) assume that the exposure-outcome, mediator-outcome, and exposure-mediator relationships are not confounded conditional on covariates (A.4) is sometimes termed cross-world independence, which stresses that none of the confounders in the mediator-outcome relationship can be aﬀected by exposure 𝑋 [29]. Under this framework, when changing the exposure levels from to conditional on 𝑊 = 𝑤 , Nevo et al. [ 20 ] deﬁned the NIE and NDE on a -function scale: NIE(𝑥 , 𝑥|𝑤) = 𝑔 𝐸[𝑌 |𝑊 = 𝑤] − 𝑔 𝐸[𝑌 |𝑊 = 𝑤] (1) NDE(𝑥 , 𝑥|𝑤) = 𝑔 𝐸[𝑌 |𝑊 = 𝑤] − 𝑔 𝐸[𝑌 |𝑊 = 𝑤] where 𝑔(.) is a pre-speciﬁed monotone function. In this article, 𝑔(.) is set to the link function of the model for conditional mean , which will be discussed later. Given (1), the TE is deﬁned as summation of NIE and NDE, that is, TE(𝑥 , 𝑥|𝑤) = 𝑔 𝐸[𝑌 |𝑊 = 𝑤] − 𝑔 𝐸[𝑌 |𝑊 = 𝑤] Finally, the MP is given by the ratio of NIE and TE. The above mediation measures are derived while ﬁxing to while changing the exposure level from to , and therefore are conditional causal parameters. Alternatively, deﬁnitions of mediation measures have been proposed by averaging over the distribution of . As discussed in [ 13 14 ], under assumptions (A.1)– (A.4), the NIE, NDE, and TE are given by NIE(𝑥 , 𝑥) = 𝐸[𝑌 ] − 𝐸[𝑌 NDE(𝑥 , 𝑥) = 𝐸[𝑌 ] − 𝐸[𝑌 , and TE(𝑥 , 𝑥) = 𝐸[𝑌 ] − 𝐸[𝑌 respectively. Estimation and inference for the marginal mediation measures has been discussed in [ 14 37 15 ], based on nonparametric or semiparametric models for the outcome and mediator, as commonly appear in practice, and will not be pursued here. The focuse of this paper is estimation and inference mediation measures conditional on 𝑊 = 𝑤, as shown in (1). We now introduce the product method for estimating those mediation eﬀects. Speciﬁcally, we assume the following conditional mean model for the outcome ( ), (2) . Mediation analyses in the presence of mediator–exposure interaction eﬀects are studied elsewhere, for example, [ 26 36 27 ]. Researchers can empirically verify this assumption in their data before applying these methods. In addition to the outcome model (2), the product method additionally requires ﬁtting the following model for the mediator: where represents the association between the exposure to the mediator conditional on the eﬀects of the covariates, is a link function, which can be a identity function and a logistic function when the mediator is continuous and binary, respectively. For simplicity of notation but without loss of generality, we assume that the mediator model and the outcome model share the same set of covariates. We can set some elements in or to zero when the covariate sets in the outcome and mediator models are not exactly the same. Next, we provide expressions of the mediation measures under the scenarios of continuous and binary mediator, separately. <title>2.2 Continuous mediator</title> NDE =𝛽 (𝑥 − 𝑥 )+ both of which involve one-dimensional logistic-normal integrals that do not have closed-form solutions. Gaynor et al. (2019) [ 27 ] uses a probit function to approximate the logistic function in the integral and obtained closed-form expressions for the mediation measures (Table 2). However, the probit approximation tends to be inaccurate as the outcome prevalence deviates from 50%, as discussed in [27] and Web Appendix A. Instead of using probit function to approximate the logisticnormal integrals, we consider in this paper the Gauss-Hermite Quadrature (GHQ) approach [39] to numerically calculate the integrals. Provided the outcome is rare, we can approximate the NIE, NDE, and TE as (𝑥 − 𝑥 (𝑥 − 𝑥 , and (𝛽 + 𝛽 )(𝑥 − 𝑥 , respectively, as given by 36 26 ]. It follows that MP ≈ . Here we can obtain simple and closedform expressions for the mediation measures because the logistic link function in model (2) approximates a log link function, and the log binomial model is collapsible. Therefore, the logistic-normal integrals in the mediation expressions can be approximated by the log-normal integrals that have closed-form solutions 36 ]. In Web Appendix A, we provide more details on the validity of the approximate expressions when the outcome is rare. In order to distinguish the approximate expressions under a rare outcome assumption from the exact expressions, we write those approximate mediation measures as NIE NDE TE , and MP respectively. <title>2.3 Binary Mediator</title> In this section, we describe the product method estimators when is a binary variable, based on the following logistic regression model for 𝑀: and NDE = 𝛽 (𝑥 − 𝑥 , as shown in [ ]. As a result, the mediation proportion is NIE given by MP = NDE+NIE Finally, consider a binary mediator and a binary outcome (Case #4), where we ﬁt the mediator model (7) and outcome model (2) with logistic link functions. Then, as long as the identiﬁcation assumptions (A.1)–(A.4) hold and (2) and (7) are correctly speciﬁed, the NIE and NDE on a log odds ratio scale is given by [28, 29]: where 𝜂(𝑥, 𝑤) = exp(𝛽 + 𝛽 𝑥 + 𝛽 𝑤) . Given NIE and NDE, the MP is given by NIE . If the outcome is rare, the following approximate NIE and NDE have NIE+NDE been widely used [2]: (1 + 𝜅(𝑥 , 𝑤))(1 + 𝑒 𝜅(𝑥, 𝑤)) NIE = log (1 + 𝜅(𝑥, 𝑤))(1 + 𝑒 𝜅(𝑥 , 𝑤)) NIE and NDE = 𝛽 (𝑥 − 𝑥 . As a result, MP . When the NIE outcome is rare, we provide an explanation that the approximate expressions are valid by exploiting the similarity between the logistic and log link functions (see Web Appendix B). <title>2.4 Point and interval estimates for NIE and MP</title> In the previous two sections, we provided expressions for NIE and MP in Cases #1–4, which are functions of the unknown parameters in the outcome model 𝛽 = [𝛽 , 𝛽 , 𝛽 , 𝛽 , and unknown parameters in the mediator model, 𝛾 = [𝛾 , 𝛾 , 𝛾 . Exact mediation expressions for mediation measures in Case #3 also involve the variance of the error term in the mediator model (7) . Let denote all unknown parameters used in the expressions of NIE and MP, which is [𝛽 , 𝛾 , 𝜎 for the exact expressions in Case #3 and [𝛽 , 𝛾 for other cases. Hereafter, we will rewrite the expressions of NIE and MP as N I E (𝜃) and M P (𝜃), respectively, to emphasize that those expressions are functions of 𝜃. In practice, the coeﬃcients in the outcome model, , can be obtained by solving the following generalized estimating equation (GEE) [40]: we also need to estimate the covariances between , and ^𝜎 . However, as we state below, these asymptotic covariances are 0 since the estimating equations are asymptotically uncorrelated. We formalize this result below. Result 1. Estimators 𝛽, 𝛾, and ^𝜎 obtained by solving 𝑈(𝛽) = 0, 𝑈 (𝛾) = 0, and 𝑈(𝜎 ) = 0 are asymptotically uncorrelated and have zero asymptotic covariances. of NIE and MP is obtained through the multivariate delta method [42]: Var( NIE) = and Var( MP) = can be computed by normal approximation as NIE − 1.96 × Var( NIE), NIE + 1.96 × Var( NIE) and MP − 1.96 × Var( MP), MP + 1.96 × Var( MP) respectively. Alternatively, the nonparametric percentile bootstrap approach [ 43 44 ] can be used to approximate the empirical distributions of NIE by resampling the dataset with replacement and re-estimating all model parameters. The values for NIE are then calculated for each bootstrap dataset. This step of resampling and calculating NIE is repeated for a large of times (e.g., 1,000 times), and then the bootstrap distribution of NIE is obtained from the collection of estimates based on resampled datasets. Finally, the percentile bootstrap approach employs the 2.5% and 97.5% percentiles of the bootstrap sample distribution to obtain a 95% conﬁdence interval of NIE. Similarly, the percentile bootstrap approach can be used to obtain a 95% conﬁdence interval of MP. When implementing the product method, several studies 22 23 24 25 ] suggested using the bootstrap approach to calculate conﬁdence intervals for the mediation measures, because the ﬁnite-sample distribution of the mediation measure estimators, especially the MP estimator, can be skewed and may not be well approximated by the normal distribution. In what follows, we will compare the empirical performance between the closed-form sandwich conﬁdence interval estimator and the bootstrap interval estimator, and assess when each approach provides accurate empirical coverage for all 4 Cases. <title>3 Simulation study</title> We conducted simulation studies under a range of scenarios likely to be encountered in practice to assess the performance of the point and interval estimators of NIE and MP. We considered the four data types introduced earlier. We considered 4 levels of sample sizes at 150, 500, 1,000, and 5,000 for the continuous outcome cases (Cases #1 and #2). With a baseline outcome prevalence of 3%, to obtain 15, 30, 150, 600 expected disease cases, we considered sample sizes of 500, 1,000, 5,000, 20,000 for the binary outcome scenarios (Cases #3 and #4). For each data type and sample size, we considered the exposure ( ) as a binary variable and for simplicity assumed that there were no confounders in both the mediator and outcome models. When the outcome was continuous, we set TE ∈ (0.25, 0.5, 1) , indicating small, medium and large total eﬀects; otherwise, we set the TE to (log(1.2), log(1.5), log (2)) . For each value of TE, we considered MP ∈ (0.05, 0.2, 0.5) . All the mediation measures are deﬁned for a change in from 0 to 1. We conducted a factorial design of all combinations of TEs, MPs, and sample sizes. For each set of these factors, 5,000 replications were performed. The exact parameter constellations are summarized below. Case #1, continuous outcome and continuous mediator. We ﬁrst generated the exposure 𝑋 ∼ Bernoulli(0.5) . Then, we simulated the mediator 𝑀 ∼ 𝑁(𝛾 + 𝛾 𝑋, 1) , where = 0 was chosen to 0.408, corresponding to the exposure-mediator correlation, Corr(𝑋, 𝑀 ) = 0.2 . Finally, given and , we simulated 𝑌 ∼ 𝑁(𝛽 +𝛽 𝑋+𝛽 𝑀, 1) , where was ﬁxed as 0. We let = (1−MP)×TE MP×TE and based on the relationships that NDE = (1 − MP) × TE = 𝛽 and NIE = MP × TE = 𝛽 Case #2, continuous outcome and binary mediator. First, we simulated 𝑋 ∼ Bernoulli(0.5) . Then, we generated conditional on by the logistic regression logit(𝑃 (𝑀 = 1|𝑋)) = 𝛾 +𝛾 . Noting that = log we chose the values of such that the baseline prevalence of the mediator 𝑃 (𝑀 = 1|𝑋 = 0) = 0.2 . Similar to Case #1, we chose = 0.903 to give an exposuremediator correlation 0.2 . Finally, we simulated 𝑌 ∼ 𝑁(𝛽 + 𝛽 𝑋 + 𝛽 𝑀, 1) , where = 0 = (1 − MP) × TE from the diﬁnition NDE = (1 − MP) × TE = , and = MP × TE/ by noticing MP × TE = NIE = Case #3, binary outcome and continuous mediator. We ﬁrst generated and using the same procedure in Case #1. Now, given and , we used the following logistic regression model to simulate 𝑌 , 12 Cheng, Spiegelman and Li Since = log , we selected so the baseline outcome prevalence was 3%. Then, we selected and by numerically solving the system of equations MP × TE = N I E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 and (1 − MP) × TE = N D E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 , where N I E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 and N D E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 refer to the exact expressions of NIE and NDE, given in (5) and (6). Case #4, binary outcome and binary mediator. We ﬁrst generated and using the same procedure in Case #2, then generated the outcome using the logistic regression model (10). The values of and were obtained as follows. We chose such that the baseline outcome prevalence is around 3%. We then chose and by solving the system of equations MP × TE = N I E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 and (1 − MP) × TE = N DE (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 , where N I E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 and N D E (𝛽 , 𝛽 , 𝛽 , 𝛾 , 𝛾 refer to the exact expressions of NIE and NDE, given in (8) and (9). For each data type, we obtained NIE and MP by solving the estimating equations in Section 2.4, variance estimates of NIE and MP by the multivariate delta method, and 95% conﬁdence intervals of NIE and MP by the multivariate delta method and percentile bootstrap approach. We did not use the bootstrap approach for the sample size of 20,000 in Cases #3 and #4, due to the computational cost of performing the number of bootstrapping samples with a large dataset across 5,000 replications. With a binary outcome, we ﬁrst evaluated the performance of the estimators based on the approximate expressions (i.e., NIE and MP ), and compared the performance between the approximate and the exact estimators for the mediation measures by varying the baseline outcome prevalence from 1% to 50%, in Section 3.3. The percent bias (Bias(%)) was used to evaluate the accuracy of the point estimates of NIE and MP. It was calculated as the median bias relative to the true value over 5,000 replications. We employed the “median” rather than the “average” value over all the replications to avoid the undue inﬂuence of outliers on the results when the sample sizes were not large. The variance ratio was deﬁned as the the ratio between the median of the estimated variance and the empirical variance, and is used to determined the accuracy of the variance estimator obtained by the multivariate delta method. The accuracy of the interval estimator is determined by calculating the empirical coverage rate (CR) of 95% conﬁdence interval across 5,000 replications. The simulation results for the point, variance and interval estimates of NIE and MP under the four data types are shown in Table 3 (Case #1), Web Table 1 (Case #2), Web Table 2 (Case #3) and Web Table 3 (Case #4), respectively. Detailed ﬁndings from the simulation study are reported below. <title>3.1 Estimation of NIE</title> When the outcome is continuous, the point estimates of NIE generally had minimal bias for sample sizes equal or greater than 500, for all values of TE and MP considered. When the sample was as small as 150, the NIE point estimates had relatively small bias (percent bias within ±10% ) as long as MP ≥ 0.2 and TE ≥ 0.5 With binary outcome, however, the point estimates did not show suﬃciently small percent bias until the sample size was 1,000, as shown in Web Table 2 (Case #3) and Web Table 3 (Case #4). When the outcome was relatively rare and sample size was not large, there was not enough data to accurately estimate the NIE by the product method. In Case #3 (Web Table 2), we also observed that the percent bias of NIE was notable when TE= log(2) and MP= 0.5 even when the sample size was 20,000, indicating that with a rare outcome, bias persisted when TE and MP were also large. The variance ratio of the NIE under all data types and sample sizes were very close to 1, indicating that the variance estimator derived by the multivariate delta method was accurate. Compared to the multivariate delta method, the bootstrap provided more accurate NIE interval estimates especially when the sample size is small. When the outcome was continuous, the bootstrap coverage rates were close to or greater than 95% even when the sample size was 150. In general, both the bootstrap and the multivariate delta method had conﬁdence interval coverage rates very close to the nominal value when the sample size 500, except for the scenario when both TE and MP were large in Case #3, in which case both methods exhibited lower coverage rates than nominal as sample size increased. This is because the rare outcome assumption may be inadequate and so the resulting bias of NIE are more pronounced with a larger sample size. Overall, these ﬁndings suggested that the multivariate delta method is a valid approach for estimating the variance and conﬁdence intervals for the NIE when the sample size is at least 500 with a continuous outcome. For the cases of binary outcome, we also evaluated the performance of the NIE estimates based on the exact expressions (i.e., NIE ). The results are shown in Web Tables 2 and 3 for Cases #3 and #4, respectively. As long as the sample sizes are greater than or equal to 1,000, the estimator based on the exact expressions consistently carried small percent bias and nominal coverage rate. <title>3.2 Estimation of MP</title> In contrast to the NIE estimates, the point estimates of MP often diverged from the true MP values with smaller sample sizes. When the outcome was binary, the percent bias in MP was usually larger than 30% for sample sizes 1,000, and sometimes even larger than 70% for sample size 500, as shown in Web Table 2 (Case #3) and Web Table 3 (Case #4). The MP point estimates were more stable with a continuous outcome, in which case the bias is negligible when the sample size was at least 500. For the binary outcome scenarios, the MP percent bias was not close to 0 until the sample size was 5,000 or the number of cases 200. For all data types, the percent bias of MP appears larger when the TE is small. For the same TE, a smaller percent bias occurred when the MP was larger. The variance estimators of MP obtained from the multivariate delta method were smaller than their corresponding empirical variances, and this phenomenon became more noticeable with small sample sizes and a small TE. In general, the multivariate delta method provided accurate variance estimators when the sample size was at least 500 for the continuous outcome scenarios. When the outcome was binary, the multivariate delta method only provided accurate variance estimators when the sample size was at least 5000 and TE ≥ log(1.5). Similar to the NIE interval estimates, the bootstrap provided more accurate MP interval estimates than the multivariate delta method, especially with smaller sample sizes, because the distribution of MP with small sample sizes can deviate from normality, which was assumed in the multivariate delta method. For all data types and sample sizes, the bootstrap approach generally had coverage rates higher than 95% and began to provide close to nominal coverage rates for sample size of 500 for scenarios with continuous outcome and 5,000 for the scenarios with binary outcome. On the other hand, the multivariate delta method did not provide accurate conﬁdence intervals for smaller sample sizes, and its coverage rates sometimes dropped below 80% in some settings with a binary outcome. With a continuous outcome, a sample size of 1,000 was needed for the multivariate delta method to provide satisfactory interval estimates, whereas the sample size requirement for the binary outcome scenarios was substantially larger. As shown in Web Table 2 (Case #3) and Web Table 3 (Case #4), the multivariate delta method provided satisfactory coverage rates when TE ≥ log (1 .5) and sample size ≥ 5, 000 with a binary outcome. With a the small TE (TE = log(1.2) ), a sample size of at least 20,000 will be needed for the multivariate delta method to provide MP interval estimates with nominal coverage. The performance of the delta method was also sensitive to the magnitude of TE. When the TE was small, the MP conﬁdence interval tended to be much wider than it should be when the MP was also small, but tends to be narrower than it should be for larger MP. <title>3.3 The Impact of Outcome Prevalence with a Binary Outcome</title> We conducted additional simulations to compare the mediation analyses based on the approximate expressions and exact expressions ( NIE v.s. NIE and MP v.s. MP ) when the baseline outcome prevalence was varied from 1% to 50%. We considered TE ∈ {log(1.2), log(2)} , MP ∈ {0.1, 0.5} and a large sample size of 20,000 to alleviate concerns on small-sample biases. Figure 2 and Web Figure 1 present the results for MP and NIE estimates, respectively, for the binary outcome and binary mediator scenario (i.e., Case #4). The estimates based on the exact causal mediation expressions, MP and NIE provided accurate point and interval estimates when the outcome prevalence > 1% When TE = log(1.2) and the baseline outcome prevalence was 1%, MP and NIE showed signiﬁcant negative percent bias, as the number of cases (about 200) were quite small. The NIE and MP estimates based on the approximate expressions did not generally exhibit satisfactory performance when the outcome prevalence was high. Speciﬁcally, when TE > log(1.2) , the percent bias of MP diverged from 0 and the coverage rate of MP by the delta method substantially decreased from 95%. Similarly, NIE was also quite diﬀerent from its true value when the baseline outcome prevalence ≥ 10% (See Web Figure 1). With a binary outcome and continuous mediator (Case #3), MP and NIE provided accurate point and interval estimates among all levels of baseline outcome prevalence, as shown in Web Figures 2 and 3. The estimator MP also provided very robust point and interval estimates (Web Figure 2) for the common outcome scenarios, where its percent bias was less than 1% among all TEs, MPs and outcome prevalences considered. However, the performance of NIE was sensitive to the baseline prevalence and the magnitude of MP. For example, when MP=0.5, the percent bias of NIE increased as baseline outcome prevalence increased, and the conﬁdence interval coverage rates rapidly declined. When the true MP=0.1, the percent bias of NIE was negligible over the range of outcome prevalences considered. <title>3.4 Normality Assumption in Case #3</title> process for Case #3, except that we simulated 𝑀 = 𝛾 + 𝛾 𝑋 + 𝜖 , where follows a gamma distribution. Speciﬁcally, we let 𝜖 ∼ , where follows a gamma Var(𝑏) distribution with density 𝑓(𝑏) = 𝑏 > 0 ), and are shape and scale parameters. We subtract with its expectation 𝐸[𝑏] = 𝑘𝜃 and then divide it by its standard deviation 𝑘𝜃 in order to ﬁx the mean and variance of at 0 and 1, matching the ﬁrst two moments of the standard normal distribution. Here, we chose 𝑘 = (2/𝑠) and 𝜃 = 𝑠/2 such that the coeﬃcient of skewness of 𝜖 was 𝑠. We choose to be 1, 1.5 and 2, representing diﬀerent degrees of skewness, and then still use our exact NIE and MP estimator based on (5) and (6) , and the corresponding approximate estimators for analysis. The simulation results are presented in Web Table 4. We also included a scenario that follows a standard normal distribution as a benchmark. We observed that both the exact and approximate method are robust with regard to violations of normality assumption, where all the point and variance estimators and conﬁdence interval coverage rates are comparable across the two data generating processes. This ﬁnding suggests that our exact NIE and MP estimators based on (5) and (6) are insensitive to moderate skewness of the outcome distribution, even though the derivation assumes normality. <title>4 Application to the MaxART study</title> mediation measures at the mode of each model covariate, these measures could also be calculated at other values of the covariates as well. Results are given in Table 4. In Scenario I, the steptime-adjusted model, we found that the intervention was protective against 12-month non-retention, with odds ratios of 0.23 and 0.55 for TE and NIE respectively. Because the 95% conﬁdence intervals, either by the delta method or bootstrap, for both parameters excluded the null, we conclude that both eﬀects were signiﬁcantly diﬀerent from zero. The steptimeadjusted MP was 40.8% (95% CI by delta method: (0.27, 0.54)), implying that over 40% of the intervention eﬀect was mediated by 6-month visit adherence. In multivariate-adjusted analyses (Scenario II), stronger NIE and TE eﬀects were obtained, corresponding to odds ratios of 0.08 and 0.38, respectively and the multivariate-adjusted MP estimate was also around 40%. The bootstrap and multivariate conﬁdence intervals were very close in this analysis, although the width of the bootstrap conﬁdence interval was slightly smaller than that using the delta method variance for NIE and TE, but slightly larger than the delta method for MP. Because the outcome prevalence in the MaxART study is around 23%, the above analysis based on the rare outcome approximation may be biased, as suggested by our simulation study. Thus, we repeated the mediation analysis using the exact expressions given in Table 2. Generally speaking, the results of the mediation analysis accounting for common outcome prevalence were similar to those obtained using the rare outcome approximation. In both the steptime-adjusted model and the multivariate-adjusted model, the adjusted TE were slightly weaker than previous results assuming a rare outcome (steptime-adjusted TE = 0.24 and multivariateadjusted TE = 0.10 on the odds ratio scale, compared to 0.23 and 0.08, respectively). As a result, MP slightly increased in the adjusted analyses (steptime-adjust ed MP = 44% , multivariate-adjusted MP = 42% ), compared to 41% and 40%, respectively, with the rare outcome approximation. In summary, for both the results based on and not based on the rare disease assumption, over 40% of the intervention eﬀect on the 12-month retention in care was mediated by 6-month visit adherence. <title>5 Discussion</title> under-coverage, especially in binary outcome scenarios. In many epidemiological studies, when there is reason to delieve that the NIE or NDE is not close to zero, a relatively smaller sample size may be adequate for obtaining valid point and interval estimates of the MP. For example, when the outcome is binary, we suggest that a sample size ≥ 20, 000 and number of cases ≥ 500 is needed for the multivariate delta method to obtain satisfactory MP conﬁdence intervals with close to nominal coverage rate. If there is reason to believe that the TE is not too small (TE ≥ log(1.5) ), we found that the product method could accurately estimate MP with a sample size of at least 5000 and number of cases at least 150. In the binary outcome scenarios (Cases #3 and #4), expressions of NIE and MP deﬁned on a log odds ratio scale have been commonly used in biomedical and epidemiological studies [ 47 48 49 ]. Those expressions can be extended to include a log link function in the outcome model (2) and bypass the rare outcome assumption, and the corresponding mediation measure expressions can be deﬁned on a log risk ratio scale. Based on the logistic outcome model, our simulation study suggests that, when the outcome prevalence was less than 5%, the rare outcome assumption worked well for NIE and MP . When the outcome prevalence 5% and with a binary mediator (Case #4), the percent bias of NIE and MP can be substantial and the exact expressions are recommended. However, with a binary outcome and continuous mediator (Case #3), we found that MP always provides satisfactory point and interval estimates even when the outcome was common. Our simulation study has several limitations and future work is needed to supplement the conclusions in this manuscript. For simplicity, our simulation study did not include confounders. However, because epidemiological studies need to adjust for all potential confounding factors to obtain valid results, future research is needed to examine the product method in the presence of multiple confounders. In addition, when the outcome is binary, the mediation measures can be deﬁned on the odds ratio scale [ ]. Web Appendix D shows the relationship between mediation measures deﬁned on a log odds ratio scale and odds ratio scale. In summary, we have found that asymptotic inference performs well for the product method in sample sizes typically found in epidemiology and public health settings. In addition, for common binary outcomes, exact expressions are needed to obtain unbiased estimates and strategies for point and variance estimation have been provided here. <title>Web Material</title> Acknowledgment: This work was funded in part by NIH grant DP1ES025459. <title>References</title> [1] Reuben M Baron and David A Kenny. The moderator–mediator variable distinction in social psychological research: Conceptual, strategic, and statistical considerations. Journal of Personality and Social Psychology , 51(6):1173, 1986. [2] Tyler VanderWeele. Explanation in causal inference: methods for mediation and interaction. Oxford University Press, 2015. [3] James M Robins and Sander Greenland. Identiﬁability and exchangeability for direct and indirect eﬀects. Epidemiology, pages 143–155, 1992. [4] Judea Pearl. Direct and indirect eﬀects. In Proceedings of the Seventeenth Conference on Uncertainty in Artiﬁcial Intelligence , UAI’01, page 411–420, San Francisco, CA, USA, 2001. Morgan Kaufmann Publishers Inc. [5] Richard Barﬁeld, Jincheng Shen, Allan C Just, Pantel S Vokonas, Joel Schwartz, Andrea A Baccarelli, Tyler J VanderWeele, and Xihong Lin. Testing for the indirect eﬀect under the null for genome-wide mediation analyses. Genetic Epidemiology, 41(8):824–833, 2017. [6] Tyler J VanderWeele. Policy-relevant proportions for direct eﬀects. Epidemiology, 24(1):175, 2013. [7] Ionut Bebu, Barbara H Braﬀett, Rodica Pop-Busui, Trevor J Orchard, David M Nathan, and John M Lachin. The relationship of blood glucose with cardiovascular disease is mediated over time by traditional risk factors in type 1 diabetes: the DCCT/EDIC study. Diabetologia, 60(10):2084–2091, 2017. [8] Benjamin Bowe, Yan Xie, Yan Yan, Hong Xian, and Ziyad Al-Aly. Diabetes minimally mediated the association between pm 2.5 air pollution and kidney outcomes. Scientiﬁc Reports, 10(1):1–9, 2020. [9] Chia-Huang Chang, Yu-Fang Huang, Pei-Wei Wang, Chun-Hao Lai, Li-Wei Huang, Hsin-Chang Chen, Meng-Han Lin, Winnie Yang, I-Fang Mao, and Mei-Lien Chen. Associations between prenatal exposure to bisphenol a and neonatal outcomes in a taiwanese cohort study: Mediated through oxidative stress? Chemosphere, 226:290–297, 2019. [10] Lihong Huang, Yongyue Wei, Sipeng Shen, Qianwen Shi, Jianling Bai, Jin Li, Shukui Qin, Hao Yu, and Feng Chen. Therapeutic eﬀect of apatinib on overall survival is mediated by prolonged progression-free survival in advanced gastric cancer patients. Oncotarget, 8(17):29346, 2017. [11] Seth C Inzaule, Cissy M Kityo, Margaret Siwale, Alani Sulaimon Akanmu, Maureen Wellington, Marleen de Jager, Prudence Ive, Kishor Mandaliya, Wendy Stevens, T Sonia Boender, et al. Previous antiretroviral drug use compromises standard ﬁrst-line hiv therapy and is mediated through drugresistance. Scientiﬁc Reports, 8(1):1–7, 2018. [12] Samantha E Parker, Brent R Collett, Matthew L Speltz, and Martha M Werler. Prenatal smoking and childhood behavior problems: is the association mediated by birth weight? Journal of Developmental Origins of Health and Disease, 7(3):273, 2016. [13] Kosuke Imai, Luke Keele, and Dustin Tingley. A general approach to causal mediation analysis. Psychological Methods, 15(4):309, 2010. [14] Kosuke Imai, Luke Keele, and Teppei Yamamoto. Identiﬁcation, inference and sensitivity analysis for causal mediation eﬀects. Statistical Science , pages 51–71, 2010. [15] Eric J Tchetgen Tchetgen and Ilya Shpitser. Semiparametric theory for causal mediation analysis: eﬃciency bounds, multiple robustness, and sensitivity analysis. Annals of Statistics, 40(3):1816, 2012. [16] Eric J Tchetgen Tchetgen and Ilya Shpitser. Estimation of a semiparametric natural direct eﬀect model incorporating baseline covariates. Biometrika 101(4):849–864, 2014. [17] Martin Huber, Michael Lechner, and Anthony Strittmatter. Direct and indirect eﬀects of training vouchers for the unemployed. 2015. [18] David P MacKinnon, Ghulam Warsi, and James H Dwyer. A simulation study of mediated eﬀect measures. Multivariate Behavioral Research , 30(1):41–62, 1995. [19] Tyler J VanderWeele. Mediation analysis: a practitioner’s guide. Annual Review of Public Health, 37:17–32, 2016. [20] Daniel Nevo, Xiaomei Liao, and Donna Spiegelman. Estimation and inference for the mediation proportion. The International Journal of Biostatistics , 13(2), 2017. [21] Zhichao Jiang and Tyler J VanderWeele. When is the diﬀerence method conservative for assessing mediation? American Journal of Epidemiology 182(2):105–108, 2015. [22] Kenneth A Bollen and Robert Stine. Direct and indirect eﬀects: Classical and bootstrap estimates of variability. Sociological Methodology , pages 115–140, 1990. mediation, interventions and composition. Statistics and its Interface , 2(4):457– 468, 2009. [36] Tyler J VanderWeele and Stijn Vansteelandt. Odds ratios for mediation analysis for a dichotomous outcome. American Journal of Epidemiology 172(12):1339–1348, 2010. [37] Judea Pearl. The causal mediation formula—a guide to the assessment of pathways and mechanisms. Prevention Science, 13(4):426–436, 2012. [38] Donna Spiegelman and Tyler J VanderWeele. Evaluating public health interventions: 6. modeling ratios or diﬀerences? let the data tell us. American journal of public health, 107(7):1087–1091, 2017. [39] Qing Liu and Donald A Pierce. A note on gauss—hermite quadrature. Biometrika, 81(3):624–629, 1994. [40] Kung-Yee Liang and Scott L Zeger. Longitudinal data analysis using generalized linear models. Biometrika, 73(1):13–22, 1986. [41] You-Gan Wang and Vincent Carey. Working correlation structure misspeciﬁcation, estimation and covariate design: implications for generalised estimating equations performance. Biometrika, 90(1):29–41, 2003. [42] Gary W Oehlert. A note on the delta method. The American Statistician 46(1):27–29, 1992. [43] Anthony Christopher Davison and David Victor Hinkley. Bootstrap methods and their application. Number 1. Cambridge university press, 1997. [44] Bradley Efron and Robert J Tibshirani. An introduction to the bootstrap CRC press, 1994. [45] Fiona J Walsh, Till Bärnighausen, Wim Delva, Yvette Fleming, Gavin Khumalo, Charlotte L Lejeune, Sikhathele Mazibuko, Charmaine Khudzie Mlambo, Ria Reis, Donna Spiegelman, et al. Impact of early initiation versus national standard of care of antiretroviral therapy in swaziland’s public sector health system: study protocol for a stepped-wedge randomized trial. Trials , 18(1):1–10, 2017. [46] Rolf HH Groenwold, Ian R White, A Rogier T Donders, James R Carpenter, Douglas G Altman, and Karel GM Moons. Missing covariate data in clinical research: when and when not to use the missing-indicator method for analysis. CMAJ, 184(11):1265–1269, 2012. Esben Agerbo, Patrick F Sullivan, Bjarni J Vilhjalmsson, Carsten B Pedersen, [47] Ole Mors, Anders D Børglum, David M Hougaard, Mads V Hollegaard, Sandra Meier, Manuel Mattheisen, et al. Polygenic risk score, parental socioeconomic status, family history of psychiatric disorders, and the risk for schizophrenia: a danish population-based study and meta-analysis. JAMA Psychiatry 72(7):635–641, 2015. [48] Payam Dadvand, Bart Ostro, Francesc Figueras, Maria Foraster, Xavier Basagaña, Antònia Valentín, David Martinez, Rob Beelen, Marta Cirach, Gerard Hoek, et al. Residential proximity to major roads and term low birth weight: the roles of air pollution, heat, noise, and road-adjacent trees. Epidemiology, pages 518–525, 2014. [49] InterAct Consortium robert. scott@ mrc-epid. cam. ac. uk. The link between family history and risk of type 2 diabetes is not explained by anthropometric, lifestyle or genetic risk factors: the epic-interact study. Diabetologia , 56:60–69, 2013. <title>Appendix A: Instructions for the mediateP package</title> The main function of the "mediateP" package is mediate() , which provides the mediation analysis results. It can be called with, The function has 14 arguments. These are data= (Required) The name of the dataset. outcome= (Required) Name of the outcome variable, which should be either a continuous or binary datatype. mediator= (Required) Name of the mediator variable, which should be either a continuous or binary datatype. exposure= (Required) Name of the exposure variable, which should be either a continuous or binary datatype. binary.outcome= (Required) If the outcome is binary, set to 1. If the outcome is continuous, set to 0. The default value is 0. binary.mediator= (Required) If the mediator is binary, set to 1. If the mediator is continuous, set to 0. The default value is 0. covariate.outcome= A vector of names showing the confounding variables used in the outcome model. The default value is NULL , which represents no confounding variables. We only accepted continuous and binary confounding variables, if one confounding variable is categorical, please set it to a series of binary variables in advance. covariate.mediator= A vector of names showing the confounding variables used in the mediator model. The default value is NULL , which represents no confounding variables. We only accepted continuous and binary confounding variables, if one confounding variable is categorical, please set it to a series of binary variables in advance. x0= (Required) The baseline exposure level (i.e., 𝑥 ). The default value is 0. x1= (Required) The new exposure level (i.e., 𝑥). The default value is 1. c.outcome= A vector of numbers representing the conditional level of the confounding variables in the outcome model. The default value is a vector of 0. c.mediator= A vector of numbers representing the conditional level of the confounding variables in the mediator model. The default value is a vector of 0. boot= If a percentile bootstrap conﬁdence interval needed to be added, set to 1. Otherwise, set to 0. The default value is 0. R= (Required if boot=1 ) The number of replications when apply the percentile bootstrap method to calculate the conﬁdence interval. The default value is 2,000. More illustrative examples under other datatypes can be found by using the syntax help(mediate). 28 REFERENCES Note: The , and denote the bias, variance, conﬁdence interval, and hypothesis testing, respectively. If one of those appears in one cell, it indicates that this operating characteristic has been covered in this literature. In Cases #3 and #4, Approx. Exact , and P.A. denote the approximate expression, exact expression, and the probit approximation expression, respectively (See Table 2 for their speciﬁc formulas). 30 REFERENCES 32 REFERENCES Note: All the mediation measures, including NIE, TE, and MP, are deﬁned on a log odds ratio scale for the intervention in change from SoC to EAAA, conditional on the most frequent level of the confounding variables. S.E. denotes the standard error of the point estimates, which is calculated by the multivariate delta method. We implemented the delta method and bootstrap method with 1,000 replications to calculate the 95% conﬁdence interval (95% CI) of each mediation measure.