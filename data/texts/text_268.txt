<title>Ensemble-variational assimilation of statistical data in large eddy simulation</title> <title>arXiv:2109.12295v1  [physics.flu-dyn]  25 Sep 2021</title> experiments to enhance the ﬁdelity of RANS or LES predictions through data assimilation techniques [10]. Generally speaking, data assimilation enables the merging of experimental and numerical approaches and to overcome their inherent limitations, namely the scarcity of experimental data and the uncertainties in modeling and in the inputs of simulations [11]. Incidentally, as an alternative to DNS [12–18], recent studies have explored the possibilities of relying on LES for ﬂow reconstruction/state estimation through data assimilation [19–22]. However, contrary to RANS where a number of studies exploited data assimilation to adjust turbulence models [23–29], the potential of data assimilation to enhance LES modeling has not been investigated to a similar extent, with very few exceptions [20, 30]. In [20], adjoint-based data assimilation [31] was adopted to optimize a spatially-varying coeﬃcient in the location uncertainty model [32] based on synthetic particle image velocimetry (PIV)-like measurements of the ﬂow past a cylinder at Re = 3900. In a more usual framework in terms of LES formulation [30], adjoint-based optimization was used to adjust a deep neural network that represents the divergence of the subgrid tensor relying on ﬁltered velocity ﬁelds obtained by DNS of freely decaying isotropic turbulence. In data assimilation, a cost function is deﬁned as the sum of the squared discrepancies between observations and a numerical estimation. While the adjoint technique, which was employed in the above studies, is eﬃcient at evaluating the gradient of the cost function with respect to high-dimensional control vectors, i.e. the quantities being optimized, it generally requires signiﬁcant resources to implement and to use. This is particularly true for unsteady problems, because the storage of the forward ﬂow solution is required for the backward-in-time integration of the adjoint model over the whole considered time window [18, 33]. The computational burden is thus very large for 3D ﬂows, which is perhaps at the origin of the short time-window considered in [20] and of the restriction of the the assimilation to pairs of consecutive instants in [30]. As an alternative to adjoint-based optimization, we propose use of stochastic data assimilation to infer corrections to subgrid models for LES; speciﬁcally, we adopt ensemble-based variational data assimilation (EnVar) [15, 34–40]. In the EnVar approach, the data assimilation problem is still formulated as the minimization of a cost function that measures the discrepancies between available observations and a numerical approach. Instead of relying on an adjoint model, however, the minimization is performed based on an ensemble representation of the considered control vector. The EnVar approach may thus be considered as merging the robustness of variational techniques with the ease of implementation of more usual ensemble-based approaches such as the ensemble Kalman ﬁlter [41]. An EnVar-based methodology for the optimization of subgrid models will be introduced and assessed in canonical turbulent channel ﬂow [42, 43]. Building on the popular Smagorinsky model [44], the developed data assimilation procedure will be used to infer corrections to this baseline model, and to obtain what we term data-assimilated LES (DA-LES) predictions. Contrary to previous studies [20, 30] where detailed instantaneous velocity ﬁelds were employed, we here investigate the possibility of relying on more limited data, namely statistical quantities. In other words, instead of targeting the reproduction of a speciﬁc spatio-temporal ﬂow realization through LES, we here aim to optimize the Smagorinsky model in order to accurately recover reference statistics for turbulent channel ﬂows. Two types of data assimilation experiments will be performed in this study. We will ﬁrst consider ﬁltered statistical quantities, such as the mean of the subgrid tensor, as observations to adjust the Smagorinsky model. In this case, we attempt to improve the performance of LES in a manner similar to a priori testing [3, 45]. This approach does not fully take into account the impact of discretization on LES predictions [46–48]. The importance of numerical methods in LES is well established, and was reaﬃrmed in recent studies that applied deep learning to subgrid modeling [30, 49]: calibrating a subgrid model without taking into account the speciﬁc discretization likely leads to poor performance of the actual LES solver. In a second set of experiments, more commonly available statistics such as the mean ﬂow and/or the Reynolds stresses will be employed as observations. Such time-averaged quantities are more representative of actual measurements that can be generated from experiments and that are of direct interest for industrial applications. These data assimilation experiments take into account the implementation of the LES fully, including discretization, and enhance LES predictions according to a posteriori testing. Our observation data are obtained from independent DNS, but can equally be from experimental measurements. In addition the data assimilation technique itself and the type of considered observations, another important aspect of the present methodology is the choice of the correction to the subgrid model. This choice has to be related to the nature of the observations in order to ensure the well-posedness of the data assimilation problem. The most ideal and detailed correction could consist of adding a spatial- and time-dependent term to the divergence of the subgrid tensor, which would oﬀer maximal ﬂexibility to address the functional deﬁciencies of the subgrid model. However, as discussed in [20], even if instantaneous ﬁeld data are available, the very large dimension of such a correction would make its identiﬁcation through data assimilation computationally expensive. In addition, translating the result to a predictive engineering approach would remain challenging. Considering more constrained corrections, a natural choice in the case of the Smagorinsky model is to optimize the so-called Smagorinsky coeﬃcient C . Since in the case of turbulent channel ﬂow statistical inhomogeneity occurs in the wall-normal direction y only, data assimilation may be formulated as identifying an optimal proﬁle C (y) given reference statistics. However, this choice can not overcome all limitations of the Smagorinsky model. In particular, as suggested by [50, 51] and conﬁrmed in the present study, it may be of interest to have the ability to independently adjust the dissipation of resolved mean and turbulent kinetic energies to improve the estimation of both ﬁrst- and second-order statistics. Partly inspired by recent studies on the application of data assimilation to RANS modeling [29], we consider the introduction of a steady forcing term σ(y) in the momentum equations which allows a separate adjustment of the mean of the subgrid tensor, and thus of the predicted mean ﬂow. It will be conﬁrmed in the present study that the simultaneous consideration of the coeﬃcient C (y) and of the forcing σ(y) as control vectors in the data assimilation procedure indeed provides an eﬃcient correction to the Smagorinsky model in order to accurately reproduce statistical quantities of interest. In §II, the characteristics of the present LES solver are ﬁrst provided and the diﬀerent subgrid models that are adopted in this study are speciﬁed. The Smagorinsky model forms the baseline model in the data assimilation procedure. In addition, the dynamic model [52, 53] and a mixed model based on the scale-similarity hypothesis [54] will be used to further benchmark the proposed methodology. The design of an appropriate correction form to the Smagorinsky model is also discussed in this section. The proposed EnVar data assimilation approach for optimizing subgrid models is detailed in §III, with a particular emphasis on ensemble generation. The DA-LES method is then ﬁrst applied in §IV considering ﬁltered statistics as observations. Through the corresponding data assimilation experiments, the sensitivity of the LES predictions to changes in the coeﬃcient C (y) is evaluated, along with the impact of discretization errors and the limitations of adjusting C (y) alone. In §V, the DA-LES procedure is further assessed using statistical observations that are directly accessible from experiments, i.e. unﬁltered data. Variations in the grid resolution and Reynolds number are carried out to conﬁrm the eﬃcacy and robustness of the proposed procedure. Finally, conclusions are provided in §VI. where the ﬂuid density has been normalized by its constant reference value, p is the ﬁltered pressure ﬁeld, ν is the constant ﬂuid kinematic viscosity, S refers to the resolved strain-rate tensor. The subgrid tensor, τ = u −u includes the interactions between resolved and subgrid scales and has to be closed in order to solve (3). The diﬀerent subgrid models for τ that will be considered in this study are discussed in §II.2. The computational domain to solve (3) is a three-dimensional box with streamwise, wall-normal and spanwise extents equal to 2πδ, 2δ and πδ, respectively, where δ is the channel half height. Periodic boundary conditions are imposed in the streamwise and spanwise directions, while the bottom and top walls correspond to no-slip surfaces. The friction Reynolds number Re = u δ/ν, where u is the friction velocity, will be set to either Re = 590 or Re = 1,000 in this study. Equation (3) is solved in a ﬁnite-volume framework using a fractional step algorithm [55]; advection terms are discretized using a second-order Adams-Bashforth scheme and the viscous terms, including the eddy-viscosity part of the subgrid models discussed in §II.2, are treated implicitly using Crank-Nicolson. This numerical method was extensively validated in previous studies [16, 56, 57]. The grid is uniform in the streamwise (x) and spanwise (z) directions, while a hyperbolic stretching is used for the wall-normal coordinate (y). Various resolutions will be considered and are detailed in table I. Quantities are reported in non-dimensional form using wall scaling. A superscript ∗ indicates that a reference friction velocity u from DNS is adopted, while a superscript + is used when u is obtained from the individual LES calculations. The ﬁrst grid DNS590 will be used to perform direct numerical simulation (DNS) at Re = 590 from which reference ﬁltered quantities such as the subgrid tensor will be evaluated. Reference statistics for Re = 1,000 are obtained from the Johns Hopkins Turbulence Databases [58]. For the LES, two grids will be used when targeting Re = 590. First, a relatively ﬁne grid (LES590f) will be employed, which corresponds to standard recommendations for wall-resolved LES [3, 59], namely ∆x = 50 and ∆z = 20, to satisfactorily capture energetic large-scale phenomena in the buﬀer layer. In addition, this grid is appropriately reﬁned close to the walls with the ﬁrst oﬀ-wall grid point located at y = 0.5. The consideration of a coarser grid (LES590c) in the streamwise and spanwise directions will provide further assessment TABLE I: Summary of the diﬀerent grids adopted in this study, including the target Re , number of grid points and spatial resolution in every direction. of the data assimilation procedure of §III. While the minimum requirements for LES grids suggested in the literature are not unique, the spanwise resolution of grid LES590c in particular is below most recommendations [3, 60]. The calculations at Re = 1,000 are performed on grid LES1000 which corresponds to the same spatial resolution in wall units as the coarse grid LES590c. The form of C in (5), which is here a function of the wall-normal coordinate only, enforces an asymptotic cubic behavior for the eddy viscosity at the walls [1]. It involves the constant C , which may be chosen as ∼ 0.2 from the consideration of isotropic turbulence. The cutoﬀ scale ∆ corresponds to the cubic root of the volume of a mesh cell at the corresponding wall-normal location [61]. The Smagorinsky model (4)-(5) will be the baseline subgrid model in the following data assimilation experiments. where the notation · refers to the application of the second ﬁlter, and h·i denotes averaging along the homogeneous directions. The cutoﬀ scale ∆(y) which is associated to the second level of ﬁltering is chosen as ∆(y) = (2∆x∆y(y)2∆z) This second ﬁltering is performed by applying a top-hat ﬁlter that is approximated by Simpson’s quadrature rule. where C is an adjustable constant that weights the scale-similarity contribution in the mixed model (8) and may be evaluated as ∼ 1. The eddy-viscosity part in (8) corresponds to the Smagorinsky model (4)-(5). The constant C in (5) is decreased to 0.141 for the mixed model in order to emphasize the importance of the scale-similarity contribution relatively to the eddy-viscosity part. The second level of ﬁltering that is denoted by · and used to evaluate the scale-similarity contribution is chosen as the same one that is considered for the dynamic model in (6)-(7). The dynamic and mixed models will help in the assessment of the performance of the calibrated Smagorinsky model (4)-(5) through the methodology described in §III. In such comparisons, the dynamic model will be regarded as the best choice of C according to the Germano identity, and the mixed model is supposed to be better correlated with the true subgrid scale tensor and allows backward energy transfers [2, 54]. We aim to improve the predictions of LES through adjustments of the Smagorinsky model (4)-(5) that rely on the data assimilation methodology that will be detailed in §III. Speciﬁcally, we target the correct estimation of usual statistical quantities such as the mean ﬂow and the Reynolds stresses. The scalar C appears as a leading candidate for adjustment of the Smagorinsky model. However, an important consideration is whether adjusting C alone is suﬃcient to accurately predict both mean and second-order statistical quantities. This may be investigated through the consideration of the subgrid dissipation, namely the energy drain from resolved to subgrid scales, whose correct estimation is generally the main goal in functional modeling approaches for LES [3]. In the framework of wall turbulence, it was proposed in [50, 51] to split the mean subgrid dissipation ε according to = − = ε + ε , ε = −hτ , ε = − . (9) In (9), ε quantiﬁes the dissipation of mean resolved kinetic energy hu ihu i through interactions with the subgrid scales, while ε is its counterpart for the ﬂuctuating, or turbulent resolved kinetic energy hu i. A correct evaluation of ε and ε may help to ensure the ﬁdelity of the predicted mean ﬂow and second-order statistics, respectively. Figure 1 reports these two dissipation rates from the various subgrid models in §II.2 at Re = 590 using the grid LES590c in table I. These LES predictions are compared with the results of a DNS that is performed on the grid DNS590 and ﬁltered in the homogeneous directions with a top-hat ﬁlter. Comparisons between the Smagorinsky and dynamic models may help in assessing the inﬂuence of the coeﬃcient C on ε and ε . In the near-wall region (y < 50) and slightly beyond, the dynamic model predicts a value for C that is signiﬁcantly lower than the proﬁle (5) chosen for the Smagorinsky model. As a result, the subgrid dissipation rates that are predicted by the dynamic model are overall reduced compared to the Smagorinsky model. The latter provides a satisfactory estimation of the subgrid dissipation of mean kinetic energy ε , while this same dissipation rate is signiﬁcantly underestimated by the dynamic model. The converse is true for the prediction of the subgrid dissipation of turbulent kinetic energy , which is more accurately predicted by the dynamic model and is overestimated with the Smagorinsky model. Accordingly, the results in ﬁgure 1 suggest that it may be diﬃcult to identify an optimal proﬁle for C that would correctly estimate both ε and ε , and thus both the mean ﬂow and second-order statistics. These results are in accordance with the discussion in [51]. Note that, similarly, the mixed model only matches one, but not both ε and that are predicted from the ﬁltered DNS. Its estimation of ε is satisfactory; While its prediction of ε is poor, it has the desirable feature of reproducing a non-monotic behavior close to the wall, which originates from the ability of the mixed model to reproduce backward energy transfers that occur around y = 10. The above discussion motivates the consideration of additional features of Smagorinsky-like models to adjust. Speciﬁcally, such features must enable independent control of the mean and the ﬂuctuations of the subgrid tensor , which are involved in ε and ε , respectively. We here choose to continue to directly adjust the ﬂuctuations of FIG. 1: Smagorinsky coeﬃcient C and subgrid dissipations ε and ε in (9) evaluated using the Smagorinsky model ( ), the dynamic model ( ), the mixed model ( ) and ﬁltered DNS ( ) at Re = 590. Grid LES590c is used for the LES calculations. ∂u ∂p ∂S ∂τ dσ (u ) = − + 2ν , (10) ∂t ∂x ∂x ∂x ∂x dy where the supplementary stationary contribution (y) acts only on the (mean) streamwise velocity. Introducing σ alters the mean of the subgrid tensor according to hτ i → hτ i + σ. We will thus rely on the coeﬃcient C and/or the forcing σ to optimize LES predictions through the data assimilation procedure that is described in §III. The ﬁrst term reﬂects the knowledge on the control vector prior to the consideration of the observations in the form of an estimate γ . At the beginning of the data assimilation procedure, the estimate γ corresponds to the standard Smagorinsky model in §II.2.1, i.e. using C as given in equation (5) and σ = 0. This estimate will be then updated in the iterative procedure that is detailed below and summarized in Algorithm 1. This contribution to the cost also includes the covariance matrix B which is associated to γ , with the notation k•k = • •. The second term in (11) quantiﬁes the discrepancies between the LES predictions and the considered observations m with covariance matrix R. The operator h maps the control vector space to the observation space. In the present case, it includes the LES computation and the extraction of the statistical quantities to compare with m. If observation locations did not coincide with grid points, h would also include an evaluation/interpolation scheme from observation to grid point locations. The methodology to minimize the cost function J is described in III.2, while the choice of the covariance matrices B and R is discussed in III.3 along with other data assimilation parameters. where U is a random mean-preserving orthonormal matrix. If this process is repeated N iterations, the total computational cost that is associated to the data assimilation procedure can be evaluated as N = N ×(N + 1) LES calculations. The whole procedure is summarized in Algorithm 1. where s (y ) is the standard deviation at the wall-normal location y of a quantity b which refers to either C or σ. The consideration of C instead of C was preferred because the former is the eﬀective coeﬃcient that determines the intensity of the Smagorinsky model (4). The standard deviation is chosen as s (y ) = |b (y )|, where b refers to the ﬁrst-guess value for b. Since the ﬁrst guess of the forcing σ is σ = 0, the value of hτ i is added to b (y for that term. It may be noticed that this choice for s (y ) corresponds to a relatively large level of uncertainty. Signiﬁcantly increasing this standard deviation would result in realizations of γ that correspond to variations of the same order of magnitude or higher than the ﬁrst-guess γ itself, which is not desirable in terms of numerical stability and convergence of the data assimilation procedure. In order to take into account the wall-normal change in the lengthscale associated with variations in the ﬂow statistics, in particular the mean ﬂow, the squared exponential in (22) does not directly involve y but a transformed variable f (y) = log (y ). The term l in (22) may thus be interpreted as a correlation length in logarithmic scale, and is chosen as unity. Preliminary tests conﬁrmed that this value was appropriate to obtain smooth realizations of γ, while variations around the latter did not entail signiﬁcant changes in the outcome of the data assimilation procedure. In the case where both C and σ are included in γ, they are considered as independent random variables, i.e. cross-correlations between these quantities are set to zero. where Einstein summation convention does not apply in the second equality. The diagonal mass matrix M accounts for the discretization in the wall-normal direction. Equation (27) amounts to a statement that the observation term in the cost function can be reduced by two orders of magnitude, at which point it becomes commensurate with the initial variance which models measurement noise. Preliminary tests conﬁrmed that this was appropriate to match the observations m, while still ensuring that the prior term is non-negligible and eﬀectively regularizing. An important parameter is the size N of the ensemble of simulations that are performed in the EnVar approach. While it is desirable to set N as small as possible due to computational cost, N should be suﬃciently large to capture the dominant directions of uncertainties in the control-vector space. It is suggested from previous studies [15] that EnVar techniques may be eﬃcient even when the dimension of the control vector is large compared the size of the ensemble by a ratio of the order of 10 to 1,000. In the present case, the dimension of the control vector is at most 2N = 640 for the grid LES1000. Accordingly, following [15, 36–40], ensembles of sizes N = 20 are suﬃciently large. As will be discussed in §V.4, N = 10 may be adopted. However, N = 20 was selected to ensure convergence of the data assimilation procedure and the robustness of the reported results. One last parameter is  , which determines the size of the POD basis in (16) and is set to 0.999. This choice retains a vast majority of the most energetic modes, while still removing highly oscillatory and unphysical ones. TABLE II: Summary of the data assimilation experiments that are performed in this study. For each case, the table reports the friction Reynolds number Re , the control vector γ, the grid designation (see table I for resolution), the observations m, the number of iterations N , and the total number of LES N = N × (N + 1) when = 20. Cases 5, 5c and 6 are also revisited in §V.4 with alternative data assimilation parameters (N = 10 and = 1, so N = 11), and in §V.5. therefore in the spirit of a priori testing [3]. In contrast, in §V data assimilation will be performed with observations of statistical quantities such as the mean ﬂow or the Reynolds stresses, and thus will provide a posteriori assessment of the enhancement to LES predictions. We ﬁrst consider the data assimilation experiment denoted case 1 in table II. As in the majority of the calculations, the targeted friction Reynolds number is Re = 590. We here rely on the ﬁnest LES grid in table I (LES590f) for this value of Re . The aim of this ﬁrst data assimilation experiment is to improve the prediction of the mean subgrid stress tensor. As discussed in §II.3, only the mean of the subgrid shear stress τ can directly aﬀect the mean ﬂow U, which may also be inferred from the governing equation for U obtained by averaging (10), ∆b(y ∆C (y ' g(b(y ), C (y )) . (30) |b(y )| |C (y )| FIG. 2: Control vector and ﬂow statistics of case 1 for DNS ( ), the Smagorinsky model ( ) and for DA-LES , from thin to thick for increasing iteration of the data assimilation procedure). FIG. 3: Statistics of the ﬁrst ensemble of case 1: (a) standard deviation s of a quantity b normalized by its magnitude at the same y-location where b refers to C ( ), hτ i ( ), hu i ( ) or U ( ); (b)-(e) nondimensional gradient g(b(y ), C (y )) in (29) where b refers to C (b), (−hτ i) (c), (−hu i) (d) or U (e). the near-wall region below y = 30 may be signiﬁcantly impacted by variations in C , and only if the latter occur in the range 30 ≤ y ≤ 150. This result and its consequences will be revisited during discussions of the data assimilation experiments. FIG. 4: Control vector and ﬂow statistics of case 2 for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). large C is indicative of the inadequacy of considering the reference hτ i as the sole objective of the data assimilation procedure while only adjusting C . This view is conﬁrmed by the examination of ﬁgures 2c-2d where we report the mean ﬂow and the mean resolved shear stress proﬁles. The improvement in terms of hτ i for DA-LES has been obtained at the expense of a deterioration in the predicted mean ﬂow, which is signiﬁcantly underestimated in the viscous wall region, while it was correctly evaluated by the standard Smagorinsky model. The large increase in C has induced a similar enhancement in the dissipation of resolved turbulent kinetic energy ε in (9), inducing a decrease in (−hu i) and thus in U close to the wall. It can also be noted based on ﬁgure 2c that the mean ﬂow has barely been altered above y = 30 despite the large variations in C relative to its ﬁrst-guess proﬁle. All these results are in accordance with the discussion of ﬁgure 3. Equations (31) and (32) indicate that by targeting hτ i in the data assimilation problem, it is not possible to simultaneously improve the prediction of the other terms in the governing equation for the mean ﬂow (28). This point is in accordance with previous discussions on the sensitivity of the LES statistics with respect to changes in C and the fact that hu i and U are relatively well predicted by the standard Smagorinsky model, in particular close to the wall. The present data assimilation has thus only found the best compromise between an accurate prediction of hτ i and a correct estimation of the other terms in the mean ﬂow equation (28). The present diﬃculty in correctly reproducing multiple statistical quantities when only adjusting C seems somewhat analogous to ﬁndings in [29] in the context of data assimilation with RANS models when preserving the Boussinesq hypothesis. In that case, the authors noted that the considered model correction may be too conservative and prevents reaching many possible ﬂow states, making a correct ﬁnely-detailed estimation of the observed reference ﬂow diﬃcult. In a similar way, in the present context, correctly estimating the diﬀerent contributions in the mean-ﬂow equation (28) requires more ﬂexibility in the adjustment of the subgrid model than oﬀered by variations in the coeﬃcient C alone. FIG. 5: Control vector and ﬂow statistics of case 3 for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). improved compared to the use of the Smagorinsky model, and the remaining discrepancies are larger than in the previous case, which can be attributed to the increase in discretization errors that are induced by the use of a coarser grid. However, one has to remain cautious when interpreting this trend due to the non-monotonic decrease of discretization errors in simulations of turbulent channel ﬂows [59]. The results of data assimilation experiments 3 and 3c still suggest that rather than improving the estimation of the subgrid tensor, it is more beneﬁcial to directly target statistical quantities of interest. In doing so, discretization errors would be fully taken into account during the assimilation procedure, and the LES is directly optimized for accurate prediction of the target statistics. This approach is the subject of §V. FIG. 6: Control vector and ﬂow statistics of case 3c for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). positive values above y = 40. This height roughly coincides with the region where the subgrid model does not have a large inﬂuence on U, and also where discrepancies between the true mean ﬂow and its prediction by the standard Smagorinsky model are signiﬁcant. Figure 7d conﬁrms that this correction to the mean of the subgrid shear stress hτ i is almost negligible close to the wall, and starts to move away from the Smagorinsky proﬁle and even from the reference one at the beginning of the log layer. The impact of the assimilated forcing σ is also reﬂected in the resolved shear stress hu i which is reported in ﬁgure 7e, with a large overestimation of its magnitude in the same region. On the other hand, the total shear stress hu i, which is more of interest here, is accurately predicted by DA-LES in accordance with the mean-ﬂow equation (28), as illustrated in ﬁgure 7f. While the emphasis was previously placed on the correct estimation of the mean ﬂow and other quantities that feature in its governing equation, we now turn to the Reynolds normal stresses from experiment 4 (ﬁgure 8). Contrary to previous results, non-dimensionalization is here based on the respective friction velocities of the various LES calculations, rather than the reference DNS, in order to facilitate comparisons and the distinction between results. Close to the wall, the data assimilation procedure is beneﬁcial in correcting the initially overestimated component hu i and underestimated hv i and hw i (ﬁgures 8a-8c). However, above y ∼ 60, the intensity of these components is signiﬁcantly overestimated by DA-LES, which mirrors the elevated proﬁle of the resolved shear stress in ﬁgure 7e. The productions of resolved and total kinetic kinetic energy are plotted in ﬁgure 9a, where the dashdotted blue line corresponds to present case 4. Due to the large over-estimation of −hu i, the production P −hu idU/dy of resolved turbulent kinetic energy hu i is signiﬁcantly over-estimated, compared to the standard Smagorinsky model. Nonetheless, the production P = −hu idU/dy of total turbulent kinetic energy is satisfactorily predicted by DA-LES which signiﬁcantly corrects the estimation by the Smagorinsky model. It is however not necessarily fair to compare the reference full Reynolds stresses with those obtained from LES, as we here rely on the Smagorinsky model form (4) which does not model the trace of the subgrid tensor τ (see §II.2.1) and thus prevents an unambiguous estimation of the subgrid turbulent kinetic energy [71]. As such, a comparison with the deviatoric part of Reynolds stress tensor, which is denoted by the superscript d, is provided in ﬁgures 8d-8f. Despite the perceived overestimation of the turbulent kinetic energy, DA-LES signiﬁcantly improves the estimation of the deviatoric part of the Reynolds stress tensor compared to the Smagorinsky model over the whole channel height. FIG. 7: Control vector and ﬂow statistics of case 4 for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). The consideration of dU/dy as the sole observed quantity in the data assimilation procedure thus appears suﬃcient to already enhance the predicted degree of anisotropy of the ﬂow. However, it might still be desirable to prevent the overly large increase in the production P of resolved turbulent kinetic energy reported in ﬁgure 9a. We now consider the data assimilation experiment 5, which diﬀers from the previous one in two respects: Firstly, the Reynolds stress hu i is included with the mean-ﬂow gradient in the observations m. This is mainly motivated by the above discussion and to better control the production P . Secondly, the control vector γ includes both the forcing σ and the coeﬃcient C , the latter being reintroduced to better tackle the consideration of hu i as one of the observed quantities. The ﬁnal assimilated state is obtained through two main iterations of the data assimilation procedure, and the corresponding results are reported in ﬁgures 9-11 and 13. Figure 9a shows that including the observation of the Reynolds stress component hu i in the data assimilation has indeed mitigated the increase in the production P of resolved kinetic energy compared to case 4. The adjustment of P with respect to the Smagorinsky model even allows DA-LES to roughly recover the reference DNS proﬁle in the present case. In addition, as in case 4, the production P of total turbulent kinetic energy is accurately predicted by DA-LES (ﬁgure 9b). In addition to comparisons with statistics from the reference DNS and the standard Smagorinsky model, the present DA-LES is also compared to results from the dynamic and mixed models in ﬁgures 10-11. The assimilated control vector γ is reported in ﬁgures 10a-10b, and shows that the amplitude of the optimal forcing σ is signiﬁcantly reduced relative to case 4 (ﬁgure 7b). While the inﬂuence of σ on the resolved shear stress h i was previously noted, the present lower value of σ at the start of the log layer leads to a better estimation of the production P of resolved turbulent kinetic energy. The coeﬃcient C is only mildly altered by the data assimilation procedure compared to the standard Smagorinsky model, in particular with a small increase around y = 50. Such localized peak is also qualitatively observed in the dynamic model at a similar location, although the corresponding values signiﬁcantly diﬀer. FIG. 8: Second-order statistics of case 4 for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). FIG. 9: Production of (a) resolved and (b) total turbulent kinetic energy for DNS ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES of cases 4 ( ) and 5 ( ). Results in (a) are normalized by P , which refers to the production of resolved turbulent kinetic energy as predicted by the Smagorinsky model. Figure 10c indicates that among all considered subgrid models, only DA-LES satisfactorily predicts the mean velocity U over the whole channel height. The standard Smagorinsky, dynamic and mixed models predict an erroneous proﬁle for U above the start of the log layer. These mean-ﬂow proﬁles would actually collapse close to the channel center if normalized using the same reference friction velocity. This result further underscores the lack of inﬂuence of the subgrid model in this region as discussed in §IV.1, which is here observed even with the mixed model whose functional form signiﬁcantly diﬀers from the Smagorinsky and dynamic models. FIG. 11: Second-order statistics of case 5 for DNS ( ), the dynamic model ( ), the mixed model ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). FIG. 12: Control vector and ﬂow statistics of case 5c for DNS ( ), the dynamic model ( ), the mixed model ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). TABLE III: Error on the spanwise spectrum e in (33) for the Smagorinsky and ﬁnal DA-LES calculations of cases 5 and 5c. than total ones (e.g. hu i), as the diﬀerence between the two becomes appreciable. The ﬁnal data assimilation experiment is case 6, where the target friction Reynolds number is Re = 1,000. The setup is otherwise similar to case 5c: the employed grid (LES1000) has the same relatively low resolution in wall units, the control vector γ is formed by both C (y) and σ(y), and the observations include the mean ﬂow gradient dU/dy and the Reynolds stress hu i. These reference statistics are extracted from the Johns Hopkins Turbulence Databases [58]. Figure 14 reports results for the ﬁnal assimilated state, which has been obtained in two main iterations of the data assimilation procedure, along with the predictions obtained with the considered baseline subgrid models. It appears from ﬁgure 14a that the value of the coeﬃcient C has been notably increased compared with the ﬁrstguess Smagorinsky proﬁle (5) around y = 50 through the assimilation of the observations. This increase in C also compared with case 5c (ﬁgure 12a), is also observed in the proﬁle that is predicted by the dynamic model. As in previous cases in this section, DA-LES accurately recovers the reference mean ﬂow in ﬁgure 14c. In addition, as reported in ﬁgures 14e-14f, the diagonal components of the deviatoric part of the Reynolds stress tensor are poorly predicted by all baseline models, while DA-LES provides a large improvement compared with these proﬁles over the 22 FIG. 13: One-dimensional spanwise spectra of the resolved streamwise velocity ﬂuctuations E (k ) of cases 5 and 5c at y = 19 and y = 59. DNS ( ); Smagorinsky model ( ); DA-LES ( ). whole channel height. These results demonstrate the robustness of the present data assimilation methodology for the considered Re . Since Re = 1,000 may be considered as a lower bound above which low-Reynolds-number eﬀects in turbulent channel ﬂows are mitigated, and as most features of the considered statistical quantities should exhibit mild (∝ log(Re )) variations with increasing Re [72, 73], the data assimilation procedure is expected to perform satisfactorily at higher Reynolds numbers than considered herein. FIG. 14: Control vector and ﬂow statistics of case 6 for DNS ( ), the dynamic model ( ), the mixed model ( ), the Smagorinsky model ( ) and for ﬁnal DA-LES ( ). In addition to results from LES that have already been discussed in the previous sections, table IV reports error indicators for two new sets of LES, which are also illustrated in ﬁgure 15 for cases 5, 5c and 6. The ﬁrst set is referred to as no-model simulations, namely LES without a subgrid model, or implicit LES. These calculations are computationally cheap and indirectly help to demonstrate the inﬂuence of the subgrid model in LES (see §IV.1). The other new results in table IV and ﬁgure 15 are from DA-LES, and examine the eﬀect of reducing the number of ensemble members and iterations of the data assimilation Algorithm 1. Speciﬁcally, we perform DA-LES with = 10 ensemble members and only N = 1 iteration of Algorithm 1, and therefore N = N ×(N + 1) = 11 LES calculations. For comparison, the previous results for cases 5, 5c and 6 (§V.2-V.3) were obtained using N = 20 and N = 2, and therefore N = 42 LES computations. Those results along with the ﬁrst-guess Smagorinsky curves are also reproduced in ﬁgure 15. TABLE IV: Errors in (34)-(35) and CPU time for LES calculations in cases 5 (Re = 590, ﬁne grid LES590f), 5c (Re = 590, coarse grid LES590c) and 6 (Re = 1,000, coarse grid LES1000). measure masks the local inaccuracy in important dynamical regions. In addition, the no-model computation yields the most inaccurate prediction of the mean ﬂow. Taken all together, the results of the baseline LES computations conﬁrm the diﬃculty in identifying one model that consistently outperforms the others. Table IV also conﬁrms the superiority of DA-LES, which systematically outperforms the other models in the estimation of both the mean ﬂow and turbulence anisotropy. For cases 5, 5c and 6, using the baseline models yields errors in the mean ﬂow, e , at least 1.5 folds, and often 4 or more folds, those from DA-LES. Concerning the diagonal components of the deviatoric part of the Reynolds stress tensor, the assimilation procedure overall halves the errors , in particular compared to the standard Smagorinsky model which is the ﬁrst guess of the DA-LES procedure. This applies to both the assimilated states that are obtained through 11 and 42 LES calculations. While in §V.2-V.3 results were obtained using 42 LES calculations to ensure the convergence of the data assimilation procedure, it appears that approximately 10 computations are suﬃcient in order to achieve large improvements with respect to the baseline model. Increasing the number of ensemble members and/or of iterations of the data assimilation procedure brings only marginal further improvements. This is well illustrated by ﬁgure 15, where the results for the assimilated states obtained through 11 or 42 calculations are very similar. The computational cost in terms of CPU time T is also reported in table IV. No-model calculations set the lowest computational cost for a given conﬁguration. Simulations based on the Smagorinsky model are associated with an increase by ∼ 10% in computational cost for the present implementation, while the dynamic and mixed models correspond to an increase by ∼ 20% due to the explicit ﬁltering operations (see §II.2). The cost of DA-LES is equivalent to that for N Smagorinsky calculations (here N = 11 or N = 42). The variations in the computational cost between cases 5, 5c and 6 reﬂect the scaling T ∝ N and the changes in the total number of grid points N between cases, while the number of time steps to collect converged statistical results was kept constant for all calculations. The DA-LES predictions using N ∼ O(10) outperform baseline models. The associated computational cost should be viewed in context. Firstly, this cost is less than that associated with other data-assimilation techniques including adjoint- and ensemble-methods, as demonstrated in previous studies from ocean and atmospheric sciences [10, 41] and aerodynamic applications [12, 14, 15]. Furthermore, performing on the order of 10 LES remains signiﬁcantly more aﬀordable than a single DNS. In the latter, the total number of grid points N is typically between 10 and 10 larger than for LES, or more [50, 76]. Assuming that the number of required time steps scales as ∝ (N [60], this results in a computational cost that is 10 to 10 larger for DNS than for LES, which is veriﬁed with the present code. Assuming that O(10) computations are performed for DA-LES, the computational cost remains at least 10 or 10 times smaller than that required for a single DNS. FIG. 15: Flow statistics of cases 5, 5c and 6 for DNS ( ), no-model calculations ( ), the Smagorinsky model ( ) and DA-LES results obtained through N = 11 ( ) or N = 42 ( ). FIG. 16: Ratio between the standard deviation at the end of the data assimilation procedure s and at its beginning for a quantity b that refers either to the coeﬃcient C ( ) or the forcing σ ( ) for cases 5 (a), 5c (b) and 6 (c). computational cost remains T /T ∝ Re with a > 0; for the herein quoted Re dependence, a = 0.6. As a result, the present data assimilation approach remains signiﬁcantly less expensive than DNS at higher Reynolds numbers, by one or more orders of magnitude. As emphasized in §III.2, the present data assimilation methodology not only provides an assimilated state, but also the associated uncertainties, or posterior statistics, which are quantiﬁed through the covariance matrix P in (20). While these posterior statistics have been previously exploited to design new ensembles in the iterative procedure summarized in Algorithm 1, they are here considered to assess the quality and accuracy in the ﬁnal assimilated control vectors that have been obtained in data assimilation experiments 5, 5c and 6 (N = 42). In these three cases, γ is formed by the coeﬃcient C and the forcing σ, while the observations are the mean-ﬂow gradient dU/dy and the Reynolds stress hu i. The conﬁdence in the retrieved control parameters can be quantiﬁed by the associated standard deviations s (y) evaluated at the end of the data assimilation procedure, where b refers to either C or σ. However, as the absolute values of these posterior statistics are inherently dependent on the choice of the prior statistics, which are quantiﬁed by the covariance matrix B in (22), it is more informative to consider the ratio s /s instead, where s refers to the prior standard deviation of b. This ratio thus captures the reduction in the uncertainties in the control vector through the data assimilation procedure, and is reported in ﬁgure 16 for cases 5, 5c and 6. In all three experiments, the uncertainty in the coeﬃcient C is signiﬁcantly decreased only in relatively narrow region around y = 50. This location coincides with the region where variations in C have the largest impact on the ﬂow statistics as discussed in §IV.1. In contrast, elsewhere the ratio s /s remains close to unity in particular at the channel center. This suggests that the alterations in C by the data assimilation procedure should be interpreted cautiously in this region, in the sense that the assimilated proﬁles C (y) remains uncertain. In particular, the signiﬁcant decrease in beyond y = 200 in case 5c (ﬁgure 12a) might not be meaningful, in accordance with the fact that the sensitivity analysis of §IV.1 suggests that variations in C at the channel center barely have an inﬂuence on the ﬂow. Only the increase in C around y = 50 by the data assimilation procedure, which is observed in the three cases, should be considered as a robust feature. It should also be noted that this adjustment is somewhat in agreement with the prediction of C (y) by the dynamic model, in particular in cases 5c (ﬁgure 12a) and 6 (ﬁgure 14a). In comparison, the assimilated forcing σ(y) is generally evaluated with signiﬁcantly lower uncertainty. This reﬂects the ability of σ to directly correct the mean ﬂow. The adjustment of C remains useful to independently tune the subgrid dissipation ε of resolved turbulent kinetic energy and to improve the prediction of second-order statistics. leads to the introduction of one-dimensional adjustable quantities, the consideration of more elaborate settings would require the deﬁnition of two- or three-dimensional correction forms. While this would lead to a signiﬁcant increase in the size of the control vector in the data assimilation procedure, previous studies [15] have illustrated the robustness of the EnVar approach. On the other hand, the present results do not particularly encourage the consideration of other baseline subgrid models in the data assimilation procedure. Instead, a more promising alternative that should facilitate both the use of coarser grids and the consideration of higher Reynolds number ﬂows is the extension of the present methodology to wall modeling [78, 79]. The authors acknowledge ﬁnancial support from the Oﬃce of Naval Research (N00014-20-1-2715, N00014-21-12375). Computational resources were provided by the Maryland Advanced Research Computing Center (MARCC).