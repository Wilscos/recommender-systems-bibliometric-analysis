IMT School for Advanced Studies, AXES Research Unit, Lucca, 55100, Italy federico.nutarelli@imtlucca.it This work applies Matrix Completion (MC) – a class of machine-learning methods commonly used in the context of recommendation systems – to analyze economic complexity. MC is applied to reconstruct the Revealed Comparative Advantage (RCA) matrix, whose elements express the relative advantage of countries in given classes of products, as evidenced by yearly trade ﬂows. A high-accuracy binary classiﬁer is derived from the application of MC, with the aim of discriminating between elements of the RCA matrix that are, respectively, higher or lower than one. We introduce a novel Matrix cOmpletion iNdex of Economic complexitY (MONEY) based on MC, which is related to the predictability of countries’ RCA (the lower the predictability, the higher the complexity). Differently from previously-developed indices of economic complexity, the MONEY index takes into account the various singular vectors of the matrix reconstructed by MC, whereas other indices are based only on one/two eigenvectors of a suitable symmetric matrix, derived from the RCA matrix. Finally, MC is compared with a state-of-the-art economic complexity index (GENEPY). We show that the false positive rate per country of a binary classiﬁer constructed starting from the average entry-wise output of MC can be used as a proxy of GENEPY. Keywords: Economic complexity, revealed comparative advantage, matrix completion, nuclear norm regularization, GENEPY Since the early 2000s, building metrics for measuring economic complexity has been a set goal. Starting from the Economic Complexity Index (ECI) developed by Hidalgo and Hausmann (2009) growth theories often shrank internal socio-economic dynamics of countries through strict assumptions, restricting the analysis to a small subset of pre-determined factors. Unlike traditional growth theories, economic complexity measures are based on a data-driven approach and are generally agnostic about the determinants of countries’ competitiveness. For instance, the ECI seeks to explain the knowledge accumulated by a country and expressed in all the economic activities present in that country. More and more reﬁned measures of economic complexity have become available in the last few years. In a recent review, Hidalgo (2021) relatedness, whereas the second concerns economic complexity metrics, which apply dimensionality reduction techniques based, e.g., on Singular Value Decomposition (SVD). Metrics of relatedness measure the afﬁnity between an activity and a location, while methods related to dimensionality reduction search for the best combination of factors explaining the structure of a given specialization matrix. According to the principle of relatedness, the probability that a location p(e.g., a sector) is inﬂuenced by the presence of related activities in that location. This poses, however, deeper questions about the role played by similar countries in determining the likelihood that the location Furthermore, while the principle of relatedness attempts to model the probability of entering an activity it does not provide hints about whether concept of production function – a function connecting economic inputs to outputs – and economic complexity via the SVD factorization of a suitable specialization matrix explain the structure of 2021) matrix with its transpose. Usually, scholars select one of the ﬁrst two eigenvectors (i.e., the ones associated with the two largest eigenvalues) because it carries out the maximum amount of information. Recently, Sciarra et al. (2020) information coming from the ﬁrst two eigenvectors into a unique index called GENeralised Economic comPlexitY (GENEPY). Nevertheless, it is worth noticing that, by doing this, the other eigenvectors are neglected and, together with them, further information which could potentially better explain economic complexity. Therefore, it looks reasonable to explore a suitable way to carefully select some other most informative eigenvectors beyond the ﬁrst two. This paper exploits a class of machine-learning methods called Matrix Completion (MC) to consider the information provided by a suitable number of eigenvectors of the specialization matrix. The main idea is to adopt MC to infer information about the Relative Comparative Advantage (RCA), or disadvantage, of a country in a given trade category of products. Such information , i.e. the truncated SVD of the matrix. These are also the leading eigenvectors of the product of the specialization is collected, for each year, in a matrix, products examined (at a given aggregation level). In formulas, one has where D In the paper, MC is applied several times (starting from different training subsets of suitably discretized RCA values associated with several countries and products, excluding originally cand products a soft-thresholded SVD, which selects each time – via a suitable regularization technique – the subset of most informative singular values and corresponding singular vectors. The predictions provided by MC are then exploited to construct two surrogate incidence matrices, one of which is used to compute a novel index of economic complexity, and the other one is used as an input to the GENEPY algorithm (Sciarra et al., 2020) the complexity of countries; (ii) it deﬁnes a novel index of economic complexity based on MC; (iii) it builds up a comparison with a state-of-the-art index of economic complexity (GENEPY), revealing a high correlation between the output of GENEPY when it is applied to the original incidence matrix and the false positive rate of a binary classiﬁer derived by the repeated application of MC. The results of our analysis show that MC performs well in estimating the RCA of countries. Supported by the high quality predictions of MC, we propose a novel Matrix cOmpletion iNdex of Economic complexitY (MONEY) for countries, which exploits the accuracy of their RCA predictions derived from the repeated applications of MC. Such accuracy is expressed in terms of a suitably weighted Area Under the Curve (AUC), one for each country examined. The MONEY index ranks countries according to their predictability, taking into account also the complexity of the products. Speciﬁcally, the larger the AUC for a speciﬁc country and the larger the average with respect to a subset of the products of that country of the MC performance in estimating the discretized RCA values of country-product pairs, the less complex that country. Using MC to construct the proposed index helps to solve the shortcoming of GENEPY, i.e., the fact that, differently from MC, GENEPY takes into account only the information coming from two eigenvectors. Moreover, the GENEPY index computed using the MC surrogate incidence matrix reveals interesting discrepancies in terms of economic complexity with respect to the original GENEPY, i.e., the one calculated starting from the incidence matrix associated with the observed multiple years of data (see the Supplemental), we ﬁnd a strong and signiﬁcant positive correlation between the false positive rate of the binary classiﬁer derived from thresholding the average output of MC and the original GENEPY index. In this work, we apply Matrix Completion (MC) techniques to study economic complexity. This class of machine-learning methods has been popularized by the so-called Netﬂix competition (see the Appendix for further details on MC and Hastie et al. 2015 revealed competitive advantage (RCA) of countries in completing a partially observed matrix suitable trade-off between the reconstruction error of the known portion of that matrix and a penalty term, which penalizes a high nuclear norm of the reconstructed (or completed) matrix. This is formulated via the following optimization problem where matrix validation method), and to the Appendix for further technical details on the optimization problem (2) and on the algorithm we used to solve it. While MC has already found many applications in many ﬁelds (e.g., movie recommendation, sensor engineering, econometrics), is the return in international dollars of the exports of the product p by country c. The work contributes to the literature on economic complexity in three ways: (i) it applies for the ﬁrst time MC to assess , Alfakih et al. 2000, and Cai et al. 2010for some of its applications). This paper uses MC to estimate the expected minimize12(A− Z)+ λ kZk Ωis a training subset of pairs of indices(c, p)corresponding to positions of known entries of the partially observed A ∈ R,Z ∈ Ris the completed matrix (to be optimized),λ ≥ 0is a regularization constant (chosen by a suitable to the best of our knowledge, this is the ﬁrst time it is used to analyze economic complexity. More precisely, we applied MC to deﬁne a novel complexity index to be compared with state-of-the-art complexity indices. In our application of MC to economic complexity, the MC optimization problem (2) was solved several times by a speciﬁc algorithm previously developed for that purpose (named Soft Impute regularization parameter of the incidence matrix by changing a suitable threshold. This allowed to build up performance measures that compose the MONEY index (see Section 3 for details). On the other hand, \GENEPY following, we describe our approach of applying MC to the reconstruction of the were aggregated at the constructed the matrix For the sake of brevity, we refer to the MC application to the deﬁnition of a measure of complexity of the countries. To get a measure of complexity of the products, it is enough to replace the matrix some related results). For the matrixA ∈ R(whereC = 119is the number of countries, andP = 1243is the number of products), the MC optimization problem (2) was solvedN = 1000times by the Soft Impute algorithm, based on various choices for the training/validation/test sets (and, as already mentioned, for the regularization parameter λ ). For each such repetitionn = 1, ...,N, the sets above were constructed as follows. First, a (pseudo)random permutation of the rows ofAwas generated. Then, a subsetSof these rows was considered, by including in it the ﬁrst row in the permutation and the successive s% ' 25% rows. In this way, the resulting number of elements of the set Swas |S| = 30. Next, for each row inS, its elements belonging to all the groups except group "0" were obscured independently with probabilityp= 0.3. The (indices ot the) remaining entries of the matrixA(excluding the ones belonging to the group "0") formed the training set (denoted byΩ). The obscured entries in one of the|S|rows (say, rowh ∈ {1,. . . ,|S|}) formed the test set (denoted byΩ), whereas the obscured entries in the remaining|S| − 1rows formed the validation set (denoted by Ω). For each repetitionn, the generation of the validation and test sets from the setSwas made|S|times, each time with a different selection of the rowhassociated with the test set (and, as a consequence, also of the|S| − 1rows associated with the validation set). Hence, the same training set was associated with|S|different pairs of validation and test sets. In this way, for each choice ofSand of the regularization parameterλ, the MC optimization problem (2) was solved once instead of|S|times, thus improving the computational efﬁciency. Finally, by construction, each time there was no overlap between the training, validation, and test sets. To avoid overﬁtting, for each choice of the training setΩ, the optimization problem (2) was solved for30choicesλ forλ, exponentially distributed asλ= 2fork = 1, . . .,30. The resulting completed and post-processed matrix was indicated asZ. Then, for eachλand each of the|S|selections of the validation sets associated with the same training set, the Root Mean Square Error (RMSE) of matrix reconstruction on that validation set was computed as then the choiceλminimizingRMSEfork = 1, . . .,30was found. Finally, the RMSE of matrix reconstruction on the related test set was computed in correspondence of the so-obtained optimal value λas For each choice ofnandh, the MC predictions contained in the matrixZwere used to build a binary classiﬁer. More precisely, each time an elementAof the matrixAwas in the test set, such element was attributed to the class0 (corresponding to the case0 ≤ RCA < 1) when its MC prediction fromZwas lower than0, otherwise it was attributed In order to assess the prediction capability of the binary classiﬁer associated with MC (see Step 5 above), for each row (country) respectively, of the true negative/true positive examples in all the test sets associated with that row (where the "negative class" refers to the class 0 associated with 0 ≤ RCA < 1, and the "positive class" to the class 1 associated with RCA ≥ 1). In this section, we introduce our proposed economic complexity index, called Matrix cOmpletion iNdex of Economic complexitY (MONEY), whose construction is based on MC. classiﬁer for each country by combining the corresponding row of of the resulting MC classiﬁcations at the level of each country. First, for the binary classiﬁer associated with each country, a Receiver Operating Characteristic (ROC) curve The corresponding Area Under the Curve (AUC) the belonging to the same row of the original incidence matrix from indices as the originally each country. The idea now is to exploit the a measure of complexity of such countries, based on the predictability of the corresponding rows. Speciﬁcally, countries with lower however, does not capture the reasons why MC performed poorly (or, vice versa, adequately). As an example, consider the three following hypothetical scenarios. Assume that MC performs poorly on a country when its true RCA was smaller than product to the class 1 (corresponding to the caseRCA ≥ 1). Finally, the average classiﬁcation of the elementA(with respect to all the test sets to which that element belonged) was indicated asA∈ [0,1], whereas its most frequent classiﬁcation (either 0or1) was indicated asˆA. A random assignment between0and1was made to deal with ties. In the (unlikely) case the element Aappeared in none of the test sets, both AandˆAwere chosen to be equal to 0. Similarly, a second MC surrogateˆM∈ Rof the incidence matrix M was deﬁned as follows: Finally,Mwas combined with several thresholds from 0 to 1 in the ﬁrst part of the construction of the proposed MONEY index (see Section 3 for details). Instead,ˆMwas provided as input to the GENEPY algorithm (replacing the original incidence matrix M). In this way, a counterfactual GENEPY index, indicated as\GENEPY, was generated. A, we also computed the false positive ratef prand the false negative ratef nras the average classiﬁcation error frequency, The MONEY index is built starting from the matrixMintroduced in Section 2. It is based on constructing a binary c-th row of the matrixMare compared with a threshold to construct the associated binary classiﬁer. The elements 0to1, using a step size equal to0.01. All the elements ofMare used as dataset, except the ones having the same AUCmay be considered as more complex, being harder for MC to predict their RCA entries. TheAUCalone, p(Scenario 1). Consider now the two following similar scenarios for which, for the same productpand the same country and it attributed either correctly (Scenario 2) or incorrectly (Scenario 3) It is reasonable to suppose that, all other things being equal, the country Scenario 1 is more complex than the same country to which MC assigned RCA ≥ 1 for the product p in Scenarios 2 and 3. In fact, while in Scenario 2, MC could have been driven to predict, for country presence of several RCA entries larger than or equal to 1 for the other countries, this is not the case for Scenario 1. Scenario 3 is more unlikely to occur, since, as it is shown later in Section 4.1 and in the Supplemental, MC has typically a quite satisfying prediction capability in its speciﬁc application to the more complex than the other countries, since MC is wrongly attributing RCA ≥ 1 to p, for all such countries. The example above suggests us that, by adopting the as equally complex in Scenarios 1, 2 and 3 (assuming the we propose a reﬁned complexity measure, based on weighting the complexity measure is that not only less predictable countries (according to MC) are more complex, but one should also take into account the product dimension when comparing the MC predictions obtained for different countries, controlling for the quality of each prediction. More precisely, it is proposed to associate a weight such a way that the predictable). In more details, the proposed complexity measure is constructed as follows. 1. First, the MC analysis made for the countries is repeated for the products, still referring to the same year. This is obtained 3. At this point, for each product p and each threshold t, one computes the quantity 5. Finally, the MONEY index for each country c is computed as: 4.1 Global performance of matrix completion In the following, the diagnostic ability of MC is illustrated. Likewise in Section 3, the matrix threshold to construct a binary classiﬁer (in this case, however, differently from Section 3, the threshold did not depend on the country). The discrimination threshold was varied from used as dataset, except the ones having the same indices as the originally NaN values in the provided by the corresponding elements of the original incidence matrix M. Fig. 1 shows the resulting ROC curve. Similarly, ROC c, MC performs poorly on the countrycby attributingRCA ≥ 1to the productpwhen its true RCA was smaller than1, simply by replacing at the beginning of the analysis theRCAmatrix with its transpose. Analogously, the matricesˆM andMare replaced by similarly constructed matrices(ˆM)and(M). In particular, each element of the latter matrix represents the average MC prediction for the corresponding product-country pair. Then, a thresholdtis applied to the elements of the matrix(M). For each value of that threshold, one constructs a matrixM∈ {0,1}, being each entry of it equal to1whenever the corresponding element in the matrix (M)is higher than or equal to t, otherwise being it equal to 0. f tot:= f pr×NP+ N beingf prthe false positive ratio for the classiﬁcations associated with that product (determined by the comparison betweenMandM, restricted to the entries associated with that product) andthe proportion of entries with trueRCA < 1with respect to all the entries associated with that product (i.e.,119). Besides, the averagef totoff tot with respect to t is computed. In other words, for each countryc, the weightwis the average off totwith respect to all the productspfor which one predicts RCA ≥ 1 through the surrogate incidence matrix (ˆM). MONEY:= 1 − w× AUC curves (see Section 3) for a random sample of countries are displayed in Fig. 2. Figure 1. Global ROC curve constructed starting from the matrix M passing through the origin with slope 1. Figure 2. ROC stands for the line passing through the origin with slope 1. As it is evident from Figs. 1 and 2, MC performed quite well on average both globally and for developed countries such as Japan, United States and Germany. Its performance was poorer (though still above the baseline) for countries that either provided less information on their trade ﬂows or whose trade ﬂows were extremely volatile (i.e., they alternated between products with extremely high RCA values and products with very low RCA values). Speciﬁcally, countries. Nonetheless, the average performance of MC over all the countries was high as depicted by the AUC reported in Fig. 1, which turned out to be about 0.81 for the binary classiﬁer described in Step 5 of Section 2. As a further check, since the positive and negative labels were unbalanced in the original dataset (speciﬁcally, entries with RCA < 1 turned out to be 0.75. Figs.3a-3b display the original incidence matrix hand, their similarity conﬁrms the good MC prediction performance at a global level. On the other hand, their differences could be attributed to the high complexity of speciﬁc country/product pairs being predicted. In other words, there may be a discrepancy between the actual RCA value of a country/product pair and its potential RCA value, predicted by MC on the basis of similar country/product pairs. represented almost the 70% of the entire dataset), we also applied the Balanced Accuracy (BACC) index, which obtained at the HS-4 level of product aggregation. The two matrices display similar but not identical entries. On one 4.2 Results related to the MONEY index In this section we report the ranking of countries in terms of economic complexity as expressed by the MONEY index introduced in Section 3. In particular, we represent the countries according to their MONEY index (Fig. 4a), then we compare the obtained ranking with the one expressed by GENEPY (Fig.4b). In Fig.4a, countries are colored according to their MONEY values (normalized between 0 and 1), which are proportional to the shade of blue. In particular, the color map ranges from the least complex countries c (colored in white) to the most complex ones (colored in dark blue). (a) Countries colored according to the MONEY index. Countries in darker shades of blue are associated with a lower MONEY, hence they are considered more complex. Countries colored in grey are not considered in the analysis. Figure 4. the corresponding values of the GENEPY index for the same year and the same level of aggregation. It is worth observing that both the GENEPY and the proposed MONEY index arise from the attempt to reconstruct (in a different way for each method) a matrix related to trade ﬂows. In the case of GENEPY, the matrix is a proximity matrix derived from the incidence matrix a nonlinear least-square estimate based on the components of the ﬁrst two (normalized) eigenvectors of that matrix. Then, a successive evaluation on how the quality of the estimate changes by dropping speciﬁc components of such eigenvectors (the ones associated with a given country) is made. In our case, the matrix Then, MC is applied several times to the matrix attempt to uncover a “latent” similarity between countries, which can be useful for the prediction of whether their RCA entries are lower than based relies only on two eigenvectors of number of left-singular/right-singular vectors to build the reconstructed matrix, for each application of MC. The choice of the (a) Original incidence matrix M at the HS-4 level.(b) Surrogate incidence matrixˆMat the HS-4 level. Values of the MONEY index for the year 2018 at the HS-4 level of aggregation and their differences with respect to number of such pairs is made automatically by the adopted validation procedure. Moreover, a ﬁnal evaluation of the quality of the reconstruction is made, by considering several test sets, on which the provided by Tab. 1, which reports the number of G19+5 each among the GENEPY, ratio is obtained in correspondence of the proposed MONEY index. Additional robustness checks related to the MONEY index computed in years different than 2018 are reported in the Supplemental. Table 1. the GENEPY, 4.3 Differences in the GENEPY indices based on the original incidence matrix M and on Fig. 5a represents the GENEPY index computed based on the original incidence matrix as in Fig.4a. It is worth noticing that the GENEPY value computed based on the incidence matrix value based on its surrogate in terms of the complexity of the countries, conﬁrming the satisfactory prediction capability of MC for the speciﬁc learning task. Nevertheless, one can also notice that the two complexities differ in some countries. Such differences may be ascribed to surpluses/deﬁcits of the actual complexities of such countries (i.e., the ones measured by GENEPY based on the original incidence matrix based on the surrogate incidence matrix To quantify the correlation between the GENEPY rankings computed based on Kendall rank correlation coefﬁcient null hypothesis of independence between GENEPY and (a) Countries colored according to the GENEPY index computed starting from the original incidence matrix M at the HS-4 level of aggregation. Figure 5. Original GENEPY values for countries for the year 2018 at the HS-4 level of aggregation, and their comparison with their It is worth noticing that, with a few exceptions (China, France, Italy, UK and Germany) the more complex the country according to GENEPY, the higher the difference between GENEPY and f pr generated by GENEPY (τ Number of G19+5 countries in the top 20, 30 and 40 positions for the year 2018, computed according to each among \GENEPYvalues. Countries colored in grey are not considered in the analysis. for each country considered in the analysis, which turned out to produce a ranking of countries quite similar to the one Figure 6. False positive rate f pr level HS-4. In the present work, we applied Matrix Completion (MC) to investigate in various ways the economic complexity of countries. First, we assessed a quite high accuracy of the MC predictions, when MC was applied to reconstruct the Revealed Comparative Advantage (RCA) matrix, which is at the basis of the construction of several existing economic complexity indices (see the Appendix). Then, we proposed the Matrix cOmpletion iNdex of Economic complexitY (MONEY), based on the predictability of the RCA entries associated with different countries. As an additional contribution, we combined MC with a recently-developed economic complexity index (GENEPY), to assess the expected economic complexity of countries. In the work, MC was exploited to infer the expected discretized RCA of a country employed is based on a soft-thresholded SVD. This, combined with the MC validation phase, allows to select automatically a suitable number of singular vectors to be used to reconstruct the discretized economic complexity indices, the information extracted is not restricted to the ﬁrst two singular vectors. The results of our analysis highlighted a generally quite good performance of MC in discerning country-product pairs with RCA values greater than or equal to the critical threshold of 1, denoting the competitiveness of were summarized by reporting the global ROC curve and comparing the heat-map of the true incidence matrix of its MC surrogate matrix we developed the MONEY index taking into account both the predictive performance of MC for each country (as measured by itsAUC the algorithm ﬁrst to the incidence matrix derived directly from the original On average, such discrepancies were higher for more complex countries according to the original GENEPY index. ) and the product dimension. In other words, when constructing that index, eachAUCwas weighted by the average of f tot’s with respect to a subset of products associated with the speciﬁc country. As a further step, we applied the GENEPY . This allowed us to directly compare the values of the two GENEPY indices, thus assessing their potential discrepancies.