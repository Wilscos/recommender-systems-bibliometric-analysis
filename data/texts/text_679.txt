Filling missing data in cloud-covered areas of satellite imaging is an important task to improve data quantity and quality for enhanced earth observation. Traditional cloud ﬁlling studies focused on continuous numerical data such as temperature and cyanobacterial concentration in the open ocean. Cloud data ﬁlling issues in coastal imaging is far less studied because of the complex landscape. Inspired by the success of data imputation methods in recommender systems that are designed for online shopping, the present study explored their application to satellite cloud data ﬁlling tasks. A numerical experiment was designed and conducted for a LandSat dataset with a range of synthetic cloud covers to examine the performance of diﬀerent data ﬁlling schemes. The recommender system-inspired matrix factorization algorithm called Funk-SVD showed superior performance in computational accuracy and eﬃciency for the task of recovering landscape types in a complex coastal area than the traditional data ﬁlling scheme of DINEOF (Data Interpolating Empirical Orthogonal Functions) and the deep learning method of Datawig. The new method achieved the best ﬁlling accuracy and reached a speed comparable to DINEOF and much faster than deep learning. A theoretical framework was created to analyze the error propagation in DINEOF and found the algorithm needs to be modiﬁed to converge to the ground truth. The present study showed that Funk-SVD has great potential to enhance cloud data ﬁlling performance and connects the ﬁelds of recommender systems and cloud ﬁlling to promote the improvement and sharing of useful algorithms. © 2011 Published by Elsevier Ltd. Keywords: Data Filling, Data Imputation, Matrix Factorization, Deep Learning, Recommender System continuous and wide observation of the earth’s surface. A remarkable example is the series of LandSat missions, which captures the imagery of global land conditions and dynamics every 14 days since July 1972 [1]. However, the application of the obtained data is limited, especially in the coastal area where signiﬁcant cloud cover presents. The cloud cover reduces the spatial-temporal availability of earth observation, causes the problem of data gap and noise, and poses challenges in earth surface analysis. helpful to improve earth observation. For example, a recent study found that applying cloud ﬁlling schemes can improve the accuracy of the mean algal concentration estimate by 50% to 80% [2]. The principle of cloud data ﬁlling algorithms is to predict the earth surface dynamics blocked by cloud covers in remote sensing using the cloud-free After decades of development, satellite-based sensing technologies now provide exciting opportunities to make Several data processing schemes have been developed to ﬁll cloud data gaps and they are demonstrated, in general, data available at other times or locations, e.g., the data of the cloud-covered area obtained at the cloud-free time or the data of the neighboring cloud-free locations at the time of the cloud cover. The most widely used scheme is probably DINEOF (Data-Interpolating Empirical Orthogonal Functions) [3]. Based on the feature of Empirical Orthogonal Functions that the leading modes of the observation data represent low-frequency large-scale structures, DINEOF truncates the lower-ranked, local and high-frequency modes to interpolate the missing data. This method has been widely applied to ﬁll cloud data in various ﬁelds [4, 3, 5, 6, 7, 8, 9, 10]. Geostatistical interpolation is another common approach to ﬁll cloud data gaps [11], which leverages the statistical features of the available part of the dataset to estimate the missing values. For example, Saulquin et al. [12] developed a Kriging algorithm to provide a gapfree global Chlorophyll a data product for Copernicus, the European Union’s earth observation program. Recently, machine learning methods, e.g., self-organizing maps (SOMs) [13] and random forests [14, 15], are becoming popular in data ﬁlling applications and shown to improve the data ﬁlling accuracy. A comparison among the popular methods for Chlorophyll a concentration in the open ocean showed that the machine learning methods are superior than the statistical methods [2]. load of the machine learning-based algorithms is still heavy – the intensive training could consume signiﬁcant computational resources. Second, the fast-algorithms such as the matrix decomposition algorithms often have low accuracy, which limits their application in the area of complex landscapes. Third, most existing studies have focused on the application for the open ocean and continuous numerical variables, while limited experience has been gained about the issue of cloud cover in coastal areas where land and ocean meet to form complex landscapes involving categorical data such as the landscape type. recommender systems. Recommender systems and the algorithms behind them have stimulated the rise of e-service platforms such as Alibaba, Flipkart, Netﬂix, etc. Leveraging the large number of customers’ records, these platforms are able to provide accurate and customized recommendation of new products or services to their customers to aid the decision making [16]: similar users are assumed to share the preference for similar products or services. Following this argument, data imputation is used to predict how much a user likes a potential product or service even though the user has never tried it. For example, in Figure 1, User b has never purchased Product 4 and hence there has been no data about how much User b would rate Product 4. Using data imputation schemes, the platform could estimate the unknown rating using other similar users’ ratings for Product 4 or User b’s past ratings for other products similar to Product 4. This process essentially ﬁlls the data gap in the matrix with information available from the rest of the matrix. We recognize that the task is similar to cloud ﬁlling – if a pixel is covered by cloud, it becomes a data gap and one could ﬁll the missing element by interpolating using the rest of the matrix. Recognizing the similarity between the two tasks (Figure 1), the proved algorithm in recommender systems can be extended to solve the cloud ﬁlling problem. In this study, a proven recommender system algorithm is explored in the task of ﬁlling cloud data gaps and compared with other cloud ﬁlling algorithms to examine its performance. However, the present cloud data ﬁlling schemes are still unsatisfactory in applications. First, the computational The present study proposes a new cloud ﬁlling scheme inspired by the success of data imputation methods in Training and Testing Data to train and test the proposed cloud ﬁlling scheme. The landscape was classiﬁed into a variety of types following the United States Geological Survey (USGS)’s product – Dynamic Water Surface Extent (DWSE) [17]. The percentage of land, water, wetland, and cloud and noise pixels in each frame is shown in Figure 2a. It shows that the cloud and noise percentage is up to 50.4% and the average water percentage is around 70%. The area of land and wetland could signiﬁcantly vary between frames. Three sample snapshots are shown in Figure 2b and they reﬂect the high complexity of the training data. Large temporal variation of the landscape is observed in the training data, which is contributed by the seasonal and other hydrological/oceanographic factors. Simple interpolation schemes could not ﬁll the missing data for such a challenging dataset with high nonlinearity. as the ground truth to create synthetic cloud data for testing. Synthetic clouds copied from other time or locations are pasted to the ground truth frame so that random, but realistic-looking, synthetic clouds were created as the cloud covers. These examples with a wide range of cloud-cover rates (blocking rates) are used to test the performance of various schemes (the ﬁrst column of Figure 3). The training and ground truth data are available online [18]. An image database of 258 frames derived from LandSat missions for a small area in the Delaware Bay is selected A frame of the landscape imaging (Figure 3) originally free of cloud and not included in the training data is used Methods each with the size of m × n, is ﬂattened to a vector and they are stacked to form a matrix X represents an image (N = m × n). Every element of the matrix represents the landscape type of the location, and thus, forms an orderly categorical dataset. Integers are used to reﬂect the order of the data – water, wetland, and land are labeled as 1, 2, and 3. The pixels covered by clouds are labeled as NaN (Not-a-number) to distinguish them from the available data. which is an EOF-based cloud data ﬁlling scheme and has been widely applied in analyzing ocean data. In this method, a matrix, K others are denoted zeros, i.e. where U are the spatial modes, Σ is a diagonal matrix containing the singular values, and V are the spatial modes. the truncated matrix, where σ is a small number. called Datawig, which has been proved to be highly eﬀective in data imputation. In this scheme, a column, X contains a missing data is ﬁrst spotted. Then, the columns that have complete data, network model f (X), where X error. The trained function is next used to predict the missing values. This procedure is repeated until all the missing values are imputated [19]. on his blog [20]. This scheme is designed to approximate the data matrix by the product of two lower rank matrices [21, 22], i.e. A minimization scheme is employed to approximate every available element in the matrix of X magnitude of the latent vectors p where p regularization. To perform the cloud ﬁlling task, we arrange the imaging data into the matrix form: a series of M satellite images, Three popular cloud ﬁlling schemes were tested and compared in the present study. The ﬁrst scheme is DINEOF, To start the operation, all the missing elements in the matrix are replaced by zeros and we name this new matrix . An iteration scheme is applied following the steps below: 1) The matrix is decomposed by SVD 3) Update the missing elements in the original matrix by the new elements at the missing places extracted from The iteration is repeated until the convergence is reached, i.e. The second scheme is the emerging machine-learning based scheme. We selected a popular deep learning model contains the rows of available data in Column Xandby is used to compare with Xto examine the training The third scheme is the new, recommender system-inspired method called Funk-SVD published by Simon Funk and qare the columns of Pand Qand λ is the hyperparameter to tune the relative weight of the The accuracy of the imputation is deﬁned as the F1 score of the imputated image comparing to the ground truth. Results algorithm – Datawig [19]. Figure 3 shows that DINEOF was able to recover the missing data at the low blocking rates but the accuracy quickly decreases with the increase of the blocking rate, whereas Datawig was able to recover the data even at the high blocking rates, but the recovered landscape is noisy. The proposed Funk-SVD method showed remarkable performance — the recovered landscape compares well with the ground truth (the blocking rate of 0) and it remains the coherence of the natural landscape. The F1 scores of the diﬀerent methods are compared in Figure 4a and the Funk-SVD method is found better than the deep learning method and signiﬁcantly outperformed the traditional DINEOF method. In addition, Funk-SVD could achieve a high ﬁlling accuracy even with high blocking rates. Although the accuracy of the deep learning and Funk-SVD is similar, the Funk-SVD method used much less computational time (Figure 4b), which was in the order of 30 seconds – the deep learning method involves extensive training, requiring four cores of the CPU to run for multiple days. The results show that the proposed Funk-SVD method is able to ﬁll the cloud data with high accuracy and eﬃciency and has a potential to improve the current practice. Discussion our numerical experiment shows that this benchmark method has diﬃculty to handle complex and categorical data, which is a common situation in the coastal area. Here, a theoretical analysis is performed to explore the reason behind The new method of cloud data imputation is compared with the traditional DINEOF method and the deep learning DINEOF is a widely applied, and probably the most popular, cloud ﬁlling algorithm used in remote sensing, but the under-performance of the method. First, the truncation process can be described as the operation to remain k leading modes in the SVD decomposition, The original matrix can be seen as the ground truth modiﬁed by an error matrix ∆X Here, the dimension notation M × N is omitted for brevity. in the iterative operations to converge to the true value, X. This analysis is consistent with the observation in Figure 3 that DINOEF could lead to large errors in the ﬁnal result. The other two methods compared in this study involves minimizing the diﬀerence between the result and the original matrix and they can restrain the growth of the error to a limit. Nevertheless, the current framework of the error propagation provides an opportunity and a tool to invent new algorithms to improve mode decomposition based algorithms. tion to inform the data imputation. The present numerical experiment re-arranged the image to a vector and stacked the vectors to a matrix. This re-arrangement may lead to the loss of the temporal spatial relationship of the original matrix. Speciﬁcally, the horizontal neighboring relationship between pixels was remained but the vertical neighboring relationship was disconnected. This vertical relationship might be still recovered in the latent space for certain methods, but may be lost in deep learning methods which don’t consider the position of the pixels. In addition, the revisit frequency of 14 days may not reﬂect the short processes such as tidal cycles, but it can still capture the long processes such as the seasonal and annual variation of the earth surface’s dynamics. Such dynamics information might be harnessed in the emerging mode decomposition methods such as Dynamic Mode Decomposition [23], which has been shown eﬀective in coastal process analysis [24, 25] and can potentially improve the existing methods. paper is the data type. The landscape data prepared by the USGS follows a predetermined spectrum analysis rule. In this rule, diﬀerent bands of the satellite imaging are used to classify pixels into diﬀerent landscape types. Although the obtained data is categorical, they have an order arranged following the wetness of the landscape, i.e. water-wetlandland. Strictly speaking, the EOF-based methods are not fully appropriate to be applied to categorical data and hence the comparison with other methods might be unfair, but we found those methods still could produce reasonable results because of the data order – the categorical data can be treated as continuous and a rounding scheme can be used to convert the continuous numerical data into the orderly categorical data. While the deep learning method doesn’t have this diﬃculty, because the algorithm can be designed to handle categorical data. Conclusion imaging in a coastal area. Three cloud ﬁlling schemes were compared including the benchmark method of DINEOF, a deep learning algorithm of Datawig, and a recommender system-inspired algorithm of Funk-SVD. Substituting this expression into Equation 4, we can obtain the general expression of the iteration, Combining the iteration scheme of Eqs. 1-4, we can obtain the general formula for the iteration step of p, This error propagation analysis of Equation 12 indicates that DINEOF cannot ensure the reduction of the error ∆X Another potential area to improve the existing algorithms is to explore the use of temporal and spatial informa- An important factor that could aﬀect the performance of the algorithms but has not been fully discussed in the A numerical experiment was conducted to explore the algorithms to ﬁll the cloud data of satellite-based landscape accuracy is the best among the three compared schemes and the computational speed is similar to DINEOF but much faster than Datawig. The deep learning method of Datawig could reach the similar level of accuracy but need a training time two order longer than Funk-SVD. Funk-SVD is also found capable to recover sparse dataset, which is a common situation found in recommender systems. accumulate unwanted error in the iteration procedure. This theoretical analysis has a potential to inspire the design of the next eﬃcient and accurate data imputation algorithm to improve both cloud ﬁlling and recommender system tasks. Transportation through the Center of Advanced Infrastructure Technology. The author would like to thank Ms. Katherine Fang for assisting the preparation of the satellite data for the analysis. We discovered that Funk-SVD achieved the best accuracy with high eﬃciency of computational resources: the A theoretical framework was developed to analyze the traditional DINEOF method and found the method could The author acknowledges the funding support by the Rutgers EOAS seeding grant and the US Department of