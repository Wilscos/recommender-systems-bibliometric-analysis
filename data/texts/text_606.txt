Department of Applied Mathematics and Theoretical Physics, University of Cambridge, Wilberforce Road, Cambridge, CB3 0WA, UK Department of Physics, Imperial College London, Blackett Laboratory, Prince Consort Road, London SW7 2AZ, UK Department of Physics, Engineering Physics and Astronomy, Queen’s University, Kingston ON K7L 3N6, Canada Arthur B. McDonald Canadian Astroparticle Physics Research Institute, Kingston ON K7L 3N6, Canada Perimeter Institute for Theoretical Physics, Waterloo ON N2L 2Y5, Canada School of Mathematics and Physics, The University of Queensland, St. Lucia, Brisbane, QLD 4072, Australia E-mail: hmb61@cam.ac.uk, siyam-ans@hotmail.co.uk, aaron.vincent@queensu.ca, pat.scott@uq.edu.au conductor of heat. Small ADM-induced changes in a star’s temperature gradient are known to alter neutrino ﬂuxes and asteroseismological signatures, erase convective cores and modify a star’s main sequence lifetime. The Sun’s proximity to us makes it an ideal laboratory for studying these eﬀects. However, the two formalisms commonly used to parametrize such heat transport were developed over 30 years ago, and calibrated with a single set of simulations. What’s more, both are based on assumptions that break down at the Knudsen transition, where heat transport is maximized. We construct a Monte Carlo simulation to exactly solve the Boltzmann collision equation, determining the steady-state distribution and luminosity carried in stars by ADM with cross sections that depend on velocity and momentum. We ﬁnd that, although the established (Gould & Raﬀelt) formalism based on local thermal equilibrium does well for constant cross sections, the isothermal (Spergel & Press) method actually performs better across all models with a simple, universal rescaling function. Based on simulation results, we provide recommendations on the parametrization of DM heat transport in stellar evolution models. Despite the abundance of gravitational evidence supporting the presence of dark matter (DM) in the Universe, its fundamental nature and properties remain unknown [1–3]. If DM is able to interact with particles of the Standard Model (SM), for example via a weak-scale crosssection for elastic scattering with quarks, it could lose enough kinetic energy in collisions with nuclei to be gravitationally captured by astrophysical bodies such as the Sun and other stars [4–6]. As long as the accumulated population of DM is not depleted by self-annihilation, evaporation or decay, trapped DM oﬀers an alternative channel for macroscopic energy transport in the interiors of stars [7–10]. Such Asymmetric (A)DM particles can absorb energy in elastic interactions with nuclei near the core, and release it via collisions in the cooler outer layers. If a suﬃcient population of DM is able to accumulate in the star, the resulting heat redistribution can produce measurable modiﬁcations to the stellar structure and neutrino ﬂuxes [11–23]. Heat transport by DM in stars is described by a Boltzmann Collision Equation (BCE), which depends on the microscopic details of the DM-nucleon interactions, the local gravitational potential φ(r) and the temperature T (r), density and composition of the stellar plasma. The thermal behaviour of a captured DM population is commonly described by the Knudsen number i.e. the ratio of the mean inter-scattering distance l star r eﬃciency in terms of this parameter in Fig. 1. Approximate analytic solutions to the BCE have been obtained in the two limiting cases. In the Knudsen regime of large mean free paths (K  1), Spergel & Press (SP) [8] modeled the DM as an isothermal heat bath, with heat transfer occurring due to the diﬀerence between the DM temperature and that of the local plasma temperature T (r). In this regime, transport is limited by the weak interaction cross section, and scales as K [10] developed a Local Thermal Equilibrium (LTE)-based perturbative solution, modeling transport as caused by a dipolar perturbation to a local (T distribution, with the perturbation linear in l short inter-scattering distance, and scales as K. Both formalisms allow for general velocity or momentum-dependent interactions, but only constant cross sections were studied at the time. These two regimes intersect at the Knudsen transition at K ' 1/3, which has remained analytically intractable. In the Sun, this happens for DM-nucleon cross sections σ about 10 to test these formalisms, using a simple setup in which the Sun is modelled as sphere of constant density with a linear temperature gradient. In the Knudsen regime, they found that the SP method overestimated transport by a factor of approximately two. In contrast, the GR solution performed well in the LTE limit, but required an additional ad-hoc “radial suppression” to deal with the breakdown of the dipole approximation as r → 0. Ref. [10] also found that predicted luminosities could match simulation results across the Knudsen transition, given a constant rescaling depending only on K. Following this work, the GR solution, modiﬁed with radial and Knudsen corrections (as formalized in e.g. [25]), became the accepted method for correctly modelling heat transport, though SP has been extensively used because of its relative simplicity. Stellar simulations including heat transport by ADM, modelled using both GR and SP approaches, show that it may aﬀect Hertzsprung-Russel (HR) diagram trajectories and extend the main sequence lifetimes of stars [26–28], aﬀect asteroseismology [29], the luminosity of giant stars [30] and the shape of the neutrino spectrum from the Sun [31]. DM-mediated energy transport may also provide a means to alleviate the current tension between precision measurements of solar observables and their predictions from theoretical Standard Solar Models (SSMs) [18–23]. Known as the solar abundance problem [32–34], this constitutes a more than 6σ mismatch between theory and observation. Refs. [16, 35] have further noted that nonstandard DM-nucleus interactions could yield measurable helioseismological eﬀects whilst remaining beyond the reach of terrestrial direct detection experiments. As such experiments are sensitive only to the high-velocity tail of the DM halo’s phase space distribution, they may be blind to important phenomenological eﬀects at low velocity or momentum transfer. Ref. [35] extended the GR formalism to include velocity and momentum-dependent cross sections. Using these results, Refs. [21–23] showed that some non-constant DM-nucleon , which is set by T (r) and φ(r). We provide a schematic illustration of the transport Figure 1: Schematic diagram showing the eﬃciency of heat transport in stars by a weakly interacting particle, as a function of the Knudsen number K. The two thermal conduction schemes commonly used to model heat transport are illustrated on either side. These rely on asymptotic behaviour with K to obtain analytic solutions to the Boltzmann Collision Equation (2.1). The left of the ﬁgure shows the Local Thermal Equilibrium (LTE) regime, modelled by Gould & Raﬀelt (GR, [10]). The DM and plasma have the same temperature proﬁle, and conduction takes place via a small dipole correction to the DM’s Maxwell-Boltzmann distribution. Conduction is limited by the mean free path, and scales as l side of the ﬁgure shows the Knudsen regime where the mean free path is large, modelled by Spergel & Press (SP, [8]) using an isothermal DM distribution in thermal contact with the plasma. Conduction is limited by the interaction strength, and scales with the cross section σ ∝ K via empirical calibration with simulations like those performed in this work. cross sections could yield changes in helioseismological observables that lead to a strong improvement over the SSM in terms of agreement with observations. Although promising, the results of [35] have never been veriﬁed by direct simulations. Given the empirical corrections required to model heat transport for constant cross sections, it remains a possibility that the approach does not generalize well to non-constant cross sections— and indeed, we will ﬁnd this to be the case. This leads to a more important concern regarding how heat transport is currently modeled. The GR approach is built on the assumption of local thermal equilibrium, and indeed locality is required at every step in deriving their solutions. However, cross sections that remain allowed by direct detection experiments (see e.g. [36]) are well into the Knudsen regime. To- . The Knudsen transition region in the centre of the ﬁgure can only be modelled date, it has remained unclear whether the GR radial and Knudsen corrections work well deep into the Knudsen regime, especially in more realistic stellar environments than the initial toy model considered in Ref. [24]. Given that more than three decades have passed since the simulations of Gould & Raﬀelt, more modern and extensive simulations are long overdue. Our aim in this work is thus to carry out a ﬁrst-principles Monte Carlo simulation of energy transport in a star by DM with both constant and non-trivial couplings to the SM, i.e. depending on momentum transfer q or relative velocity v Gould & Raﬀelt, and in a more realistic stellar environment using a real Solar model, directly testing the predictions of the SP and GR approaches against simulation results. We restrict ourselves to scattering with a single nuclear species, equivalent to spin-dependent interactions with hydrogen. Following these extensive simulations, we ﬁnd that heat transport turns out to be most robustly described by a modiﬁed version of the isothermal SP transport scheme. We begin in Section 2 by reviewing the physics of DM in the Sun, and the details of the SP and GR formalisms for describing its impact on solar energy transport. We give the details of our Monte Carlo simulations in Section 3 and present our results in Section 4. Section 5 provides an updated, Monte Carlo-calibrated formalism that appears to accurately describe heat transport across all regimes, for constant and non-constant interaction cross sections, and across very diﬀerent stellar structures. We summarise and conclude in Section 6. DM heat transport can aﬀect stellar structure, observable via asteroseismology, stellar trajectories on the HR diagram, as well as main sequence stellar lifetimes. The closest, and easiest to study star is the Sun: the temperature, density and composition of the solar core can be probed using neutrino ﬂux measurements and helioseismology. The ﬂux of provides a particularly stringent constraint on the core temperature T to T in the Sun. By inverting the frequencies of oscillations observed at the solar surface, precision determinations can be made of the sound speed proﬁle, surface helium abundance and boundary of the convective zone [37]. Early SSMs agreed with the solar observables, but this is no longer the case. Upgrades from 1D hydrostatic to 3D hydrodynamic atmospheric models combined with improvements to the modelling of non-LTE line formation led to signiﬁcant reductions in the solar metal content and thus the Z/X SSM calibration point [32, 38–47]. Whilst the consistency with observational neutrino ﬂuxes was maintained, this revision brought the SSM into sharp contradiction with helioseismological observables [33]. With the potential to reduce the core temperature and density of the Sun, conduction by gravitationally trapped DM has been suggested as a possible solution to this problem [18–23]. The potential impact of DM on stellar interiors can be predicted by incorporating DM capture and transport into evolutionary stellar models. To do this, quantitative descriptions of both of these processes are required. For DM to become trapped in a star, collisions with stellar nuclei must result in suﬃcient momentum transfer to bring the DM velocity below the local escape velocity v not reproduce the details of DM capture in stars, referring the interested reader to Ref. with β ∼ 20–25. Helioseismology refers to the study of pressure wave propagation [22] for a treatment of capture of generalised velocity and momentum-dependent DM, and Ref. [48] for the corresponding treatment in terms of non-relativistic DM-nucleon eﬀective operators. When interaction rates are high, capture via multiple interactions must be taken into account, either via a ﬁnite optical depth [49] or by including multiple-scatter events [50]. In order for DM to accumulate to levels at which the eﬀects of additional energy transport become observable, the capture rate must dominate over annihilation and evaporation. For annihilation to be suppressed, the captured dark matter must posess some degree of asymmetry, either in its abundance (as in ADM), or in its interactions [51]. The evaporation rate depends on the DM mass, stellar mass, interaction type and cross section [49, 52]. In practice, as long as the DM mass is higher than the evaporation threshold (m in the Sun), evaporation can be neglected altogether. In this paper, we are only concerned with understanding the process of conductive energy transport, so we do not consider the eﬀects of annihilation or evaporation, though the latter will be included in our simulations for self-consistency. The capture rate becomes saturated if the total scattering cross-section reaches the crosssectional area of the Sun (times a gravitational focussing factor), such that all incident DM is captured. This so-called geometric limit translates into a maximum possible solar DM population N Based on the local density of DM in the Milky Way, the maximum number of DM particles that could have accumulated in the Sun to date is less than about 1 per 10 The impacts of a given DM population on a star can be fully described by the radial proﬁle of its number density n and/or decay L DM phase space distribution, F (v, r, t) [10], where v is the DM velocity. The evolution of F for a diﬀuse, weakly interacting species in the dense solar interior is formally governed by the Boltzmann collision equation (BCE) [10, 35] where l senting the impact of diﬀusion and gravity and C is the collision operator, which encodes microscopic scattering events. The length l number of interactions per unit length. It depends on the interaction cross-section σ number density n where the sum is over all species with which the DM interacts, and the angular brackets denote the thermal average (i.e. over the nuclear velocity distribution). C depends on both the kinematic form of the DM-nucleus interaction and the distribution of target nuclei, and needs to be explicitly constructed for a given interaction law [35]. As the population of DM is diﬀuse, DM-DM scattering events can be neglected relative to scattering is the typical inter-scattering length, D is a diﬀerential (Liouville) operator reprefrom solar nuclei, and C is linear [10, 53]. It is typically assumed that the collisional timescale is signiﬁcantly shorter than that on which the solar structure changes, such that C is time-independent and F = F (v, r) is stationary [10]. DM-mediated energy transport can be broadly divided into two regimes, depending on the strength with which DM couples to the solar nuclei. These can be conveniently distinguished via the Knudsen number (Eq. 1.1). Note in particular that l temperature, and is thus a function of radius r. We will follow the convention of deﬁning K at the centre of the star: K = l radius at which the distribution of DM conﬁned to an isothermal, constant-density sphere with the same temparture T where m outlined in Sec. 1 and Fig. 1, the two extremal regimes are thus: 1. The Knudsen, non-local or isothermal limit, where K  1. The enhancement provided 2. The conduction or Local Thermal Equilibrium (LTE) limit, where K  1. The compar- Optimal transport occurs at the so-called Knudsen transition between these regimes, where transport is both non-local and eﬃcient. This occurs in the Sun for constant cross sections of σ spin-independent interactions. In the remainder of this section we provide the details of the existing formalisms used to describe these two regimes, and summarise existing numerical results aimed at linking them. In the non-local regime K 1, the DM population eﬀectively has a single temperature T which represents the average stellar temperature sampled by the DM in its interactions in the star, weighted by the radius-dependent collision rates. This situation was ﬁrst modeled by Spergel and Press [8], and relies on three assumptions: 1) the phase space distribution is Maxwellian, 2) the velocity distribution has a single constant temperature T and 3) the distribution is locally isotropic. In other words, F (v, r, t) solves the collisionless BCE, DF = 0: where N the total DM population N The energy transferred per unit time per unit stellar mass is [8] is the DM mass and kand G are the Boltzmann and gravitational constants. As by longer inter-scattering distances is countered by a reduction in collision eﬃciency. Heat conduction is proportional to the cross section σ ∼ l. atively strong DM-nucleus couplings result in a high collisional frequency, but suppress inter-scattering distances, meaning heat cannot be transported far. Conduction is proportional to the mean free path l∼ σ. ∼ 10cm, and σ∼ 10cm, in the respective cases of spin-dependent and is a normalisation constant, set by demanding that the integrated density matches where v and u are respectively the DM and nuclear velocities, and the average energy transferred per collision is Here the angle ϑ between the incoming DM and nuclear velocity vectors is given by u · v ≡ uv cos ϑ and where θ derived the form of (2.5) where σ through the luminosity condition: i.e. that the DM is neither a net source nor a net sink of energy. We may generalize this formalism to account for velocity and momentum-dependent cross sections. Including a velocity-dependent cross section amounts to including additional factors of |v − u| in the integrand. Eq. (2.5) can then be evaluated as described in Ref. [8], by ﬁrst integrating over all angles except ϑ, and then splitting the ﬁnal velocity integrals into the u −v > 0 and u −v < 0 cases, with the change of variables zdz = −uvd cos ϑ (taking care to avoid typos in the integration limits of Eq. A.5 of [8]). For q-independent cross sections, (1 −Q)σ becomes where µ = m scattering, as we are using the momentum-transfer cross section that eliminates the forwardscattering divergence for q Gould & Raﬀelt [24] have pointed out that all three assumptions in the SP approach (that the DM velocity distribution is uniform, isotropic and Maxwellian) are violated in the case is the scattering angle in the centre of momentum frame. Spergel & Press [8] ﬁrst of DM transport in a star, leading to a formally incorrect solution. In the Knudsen limit, they found that the DM temperature was never perfectly uniform, instead lying somewhere between the DM temperature T T (r). Earlier simulations by Nauenberg [53] concluded that SP overestimated DM luminosity by a factor of ∼ 3; Gould & Raﬀelt reﬁned this factor to ∼ 2. Refs [53, 54] ﬁrst derived expressions for heat transport in the LTE K  1 limit, based on conduction theory. These were found to be inconsistent, and only valid in the small DM mass limit m by Gould and Raﬀelt [10], who solved the BCE by means of a ﬁrst order perturbation expansion of F in the small parameter ε ≡ l purely due to a dipole correction to the locally Maxwellian distribution, they showed that the radial dependence of the DM number density and luminosity can be expressed in terms of dimensionless diﬀusion (α) and conduction (κ) coeﬃcients, as and resulting in a transported energy per unit stellar mass of In this scenario the DM shares the temperature of the local background nuclei, as it is in local thermal equilibrium with them. The quantities α and κ are formally calculated via inversion of the collision operator, and are thus particular to the kinematic form of the DM-nucleus interaction. For interactions with nuclei of a given mass, these quantities are a function of the DM-nucleus mass ratio µ = m values of α and κ must be calculated by taking a weighted average of the contributions of each species, according to their local abundances. This causes α and κ to become functions of radius. Values for α and κ for various µ were computed by Gould & Raﬀelt for the case of constant DM-nucleon cross-sections [10]. This treatment was extended to DM-nucleon couplings with non-trivial kinematic dependences in Ref. [35], where the values of α and κ for cross-sections scaling with various powers of the relative velocity or momentum transfer were computed. 2.1.3 Previous Monte Carlo results and the Knudsen transition Since a formal solution to the full BCE remains elusive, Monte Carlo simulation is the only way to directly verify the approximation schemes described above, and to access the Knudsen transition regime in which both approximations fail. As the BCE is linear in the dilute limit, time-averaging the properties of a single particle is equivalent to computing the instantaneous ensemble averages of the same properties for a population of DM particles [10, 53]. In this way /m 1 [10]. An essentially analytical treatment of the LTE limit was established n(r) = n(0)T (r)T (0)exp−drkT (r)(2.13) the desired number density and luminosity proﬁles can be computed entirely independently of the BCE. This approach was ﬁrst proposed and implemented by Nauenberg [53], and was later employed by Gould and Raﬀelt [10, 24] to investigate DM-mediated energy transport in a simple solar model for the case of constant DM-nucleus couplings. Gould and Raﬀelt found that the luminosity for values of K covering the full range of the Knudsen transition is well-described by the LTE solution, (2.14), with two important modiﬁcations: 1. A Knudsen suppression function f(K) must be used to to suppress the total luminosity 2. A radial suppression factor h(r) must be included, as the LTE solution overestimates These suppression/interpolations factors are well ﬁt by [13, 25] with τ ' 0.4 and K in terms of the LTE and isothermal behaviour as and Given the absence of any analytical framework with which to determine the density and energy transport at the Knudsen transition, these relations represent the only quantitative handle on this regime. Despite having been widely used in the literature, these results, based on a handful of simulations, have remained virtually uninterrogated for over three decades. This is especially important now, as direct detection limits push allowed DM-nucleon cross sections well into the Knudsen regime. Given that the widely-accepted scheme (GR with a Knudsen correction) fundamentally rests on a short mean-free-path approximation that is explicitly broken, the time is ripe to re-examine these results. We thus come to the main goal of this work: to explore in more detail the results of the earlier Monte Carlo simulations, and to update them to include the eﬀects of non-constant interaction cross sections. No such study has ever been completed for momentum or velocity-dependent couplings. In this work we consider DM-nucleon couplings that are either constant, or depend on some power of the momentum q exchanged during interactions, or the DM-nucleon relative velocity found in the K = 0 LTE limit. The same function can also be used to interpolate between the LTE and isothermal density distributions n(r) [25]. the conduction rate near the core. This is expressed succinctly [10]: “Since the energy transported by the WIMPs is generated typically at a distance l“upstream”, all the luminosity at r(r < l) is generated within a sphere of volume (4π/3)r, as opposed to a shell with volume 4πrlfor r  l.” we will focus for simplicity on spin-dependent couplings—which in this context means scattering with hydrogen only. We parameterise the DM-nucleon diﬀerential cross-section in the centre-of-mass frame relative to a reference constant cross-section σ and Eq. (3.1) is therefore isotropic, but Eq. (3.2) retains an implicit angular dependence. The values of v which the reference cross-section is deﬁned. For our realistic simulations, we will choose v= 220 km s a typical recoil energy in terrestrial direct detection experiments. Apart from the standard case of a constant cross-section (n = 0), we consider n ∈ {−1, 1, 2}, all of which arise as the leading-order DM-nucleon coupling in concrete theoretical models. When considering DM in the Sun, it is the DM-nucleus cross-section which governs energy transport. DM-nucleus interactions are typically classiﬁed as spin-dependent (SD, which traditionally refers speciﬁcially to the coupling of DM to nuclear spin), or spin-independent (SI, where the DM couples coherently to every nucleon). In the SI case, the cross-section, to that for scattering with a single nucleon (i.e. a hydrogen nucleus) σ [55] and references therein) and in the SD case, where m proton and neutron subsystems, and J element in the Sun with spin, here we only consider SD interaction of DM with hydrogen. Note that Eq. 3.4 only holds at low q; at large q DM no longer couples coherently to every nucleon, and the cross-section is suppressed. This is characterised by an additional multiplicative, isotope- and momentum-dependent nuclear form factor—or nuclear response function—which accounts for the internal structure of nuclei. We do not consider the nuclear . Though our results should generalise straightforwardly to spin-independent interactions, , for scattering with the inuclear species of mass mand nucleon number Ais related is the proton mass, hSi and hSi are the expectation values of the spins of the response in this paper, as most of the DM scattering events contributing to energy transport in the Sun occur with hydrogen and helium at low momentum transfer. Where scattering from heavier elements does occur, it has been shown that the suppression of the cross-section produced by introducing the form factor is insigniﬁcant at the relevant values of the momentum transfer [35]. Of course, such form factors become much more important in the context of DM capture. Recent work [48, 56] has formalized an equivalent parameterisation, based on non-relativistic eﬀective operators (NREOs), which decompose interactions into a basis of scalar products of the identity, DM spin S of v identiﬁed for spin-1/2 DM have been computed and tabulated in [48], for the 16 most abundant elements in the Sun. In the language of NREOs, the constant SI and SD interactions respectively correspond to O wardly translated to and from the form adopted here (3.1-3.2) via the corresponding DM response functions R(q, v the public Captn’ General code [57]. We simulate energy transport by considering 2-body elastic collisions between a single DM particle and a thermal distribution of nuclei, conﬁned within the simple harmonic oscillator gravitational potential of a uniform sphere of constant density ρ This allows for analytic expressions for the orbits followed by individual particles (Appendix A). We track the DM particle on a collision-by-collision basis, recording its position, velocity and collisional energy transfer. We assume the nuclei to be in local thermal equilibrium, with velocities described by a Maxwell-Boltzmann distribution at a local temperature T (r). We work in a Cartesian coordinate system with origin at the centre of the Sun. Although the realistic mass distribution of the Sun is more complicated, the beneﬁt of having analytical orbits here is substantial, both in terms of computational time and complexity. Given that trapped DM is predicted to cluster in the core of the Sun, where the density is approximately constant, this is not an unreasonable way to model energy transport by DM scattering. Note also that whilst we employ a constant ρ potential experienced by DM particles between scattering events, this is entirely independent of the density proﬁle that we employ for scattering nuclei in the simulation. We will consider two scenarios, one with a constant density of scatterers `a la Gould and Raﬀelt, and one that will include a radially-dependent density distribution n(r). We simulate the random walk of a DM particle undergoing scattering events in the Sun according to the following procedure: 1 Selection of the initial position and velocity orthogonal to q. Nuclear response functions corresponding to each of the 14 operators Using the rejection method, we select the initial height of the DM particle in the Sun from a distribution 2 Determination of the next point of collision where ris the eﬀective scale length of the distribution obtained by evaluating Eq. 2.3 with ρ= ρ. We draw the corresponding angular co-ordinates θ and φ isotropically from uniform distributions. We subsequently draw the three Cartesian components of the initial velocity vector independently from 1D Maxwell-Boltzmann distributions characterised by the local temperature. We found that the results of the simulation were largely independent of the form of the initial sampling distributions, so the assumption of local thermal equilibrium for obtaining the starting velocity does not impact the results. Following each collision, we draw a number of optical depths over which the DM particle will travel before interacting again. We select this number from an exponentially falling distribution proportional to e. The optical depth τ relates a time interval t to the sum of the total rates ωwith which a DM particle of velocity v scatters with the inuclear species, via the diﬀerential equation The rate at which a DM particle of velocity v interacts with particles of number density n(r), each moving with a velocity u, is given by the product of the total interaction cross-section, σ, with the ﬂux, n(r) |v − u|. In the Sun, where the velocities of a given nuclear species follow a distribution f(u; r), the quantity ωis constructed by averaging the rates for each possible u weighted by f(u; r). This leads to the general result that As the nuclei are in LTE, f(u; r) takes the form of a Maxwell-Boltzmann distribution at the local temperature T (r). In general, the total cross-section σdepends on the DMnucleus relative velocity v≡ |v − u|. This is most clearly seen from its relation to the diﬀerential cross-section Whilst we parameterise the diﬀerential cross-sections in terms of vand q, the latter can itself be expressed in terms of vand θ(Eq. 3.3). After integrating over the scattering angle, the total cross-section therefore depends solely on the relative velocity of the colliding particles. For cross-sections proportional to q, the proportionality of the diﬀerential cross-section to (1 − cos θ)arising from Eq. 3.3 causes the total cross-section to diverge at θ= 0. This scattering angle corresponds to forward scattering, which for elastic interactions does not result in momentum transfer. Given that momentum transfer is necessary for energy transport, forward scattering is not of any relevance to this discussion. We thus regulate the divergent behaviour by using the “momentum transfer cross-section” σ, Table 1: The analytical form of the total rate ω with the i and y 3 Selection of a Scattering Nucleus σ ∝ v2σnµv) erf (y) +exp (−y) σ ∝ q) erf (y) +exp (−y) σ ∝ v2σnµv) erf (y) +exp (−y) σ ∝ q) erf (y) +exp (−y) σ ∝ qyerf (y) = |v|/µ. which considers only those interactions that result in momentum transfer [35, 58, 59]. The analytical expressions that we obtain for ωby computing Eq. 3.9 for each speciﬁc DM-nucleus interaction are given in Table 1. We ﬁnd the time corresponding to the desired value of τ by integrating Eq. 3.8 along the DM trajectory using a 5order Runge-Kutta algorithm with an embedded 4order step. This is an iterative technique, which combines 6 evaluations of the integrand at successive times within a small interval δt in two diﬀerent ways to give two independent evaluations of τ(t + δt). The diﬀerence between these evaluations is used to estimate the truncation error and adjust the step size accordingly. As t is increased, τ increases monotonically. We stop iterating when the desired value of τ is reached and interpolate back to ﬁnd the corresponding time value. Once the collision time is known, we obtain the DM position and velocity using Eqs. A.1 and A.2. The probability of interaction with the inuclear species is proportional to ω. This depends on both the velocity of the DM particle and its position. In the simulations that we present here, we only consider spin-dependent scattering on hydrogen; in more general simulations, one would randomly select the nuclear species involved in each individual interaction, with the relative probabilities of diﬀerent species given by their respective interaction rates ω. We randomly generate an incoming velocity vector of the scattering hydrogen nucleus, according to the probability distribution for the local rate of DM interaction with hydrogen. The nuclear velocity u enters this rate calculation both directly via its velocity distribution f(u; r), and also in the DM-nucleus relative speed 4 Perform the Collision in the Centre of mass frame where ϑ is the angle between the incoming velocities v and u of the DM and the nucleus respectively, in the frame of the Sun. The 2D distribution for the nuclear speed and scattering angle thus takes the form where vis deﬁned as2kT/m. Here, the additional factor of ucompared to Eq. 3.9 arises from the conversion of the (three-dimensional) nuclear velocity distribution f(u, r) to the corresponding (one-dimensional) Maxwell-Boltzmann speed distribution. The additional factors of the relative velocity come from the form of the total crosssection. We employ a 2-dimensional rejection technique to draw from this distribution, simultaneously considering candidate values for both u and cos ϑ. These two factors completely specify the DM-nucleus relative velocity. We simulate the DM-nucleus interaction in the centre-of-mass (CoM) frame. The DM velocity t in this frame is related to the velocity v in the solar (lab) frame as where the velocity of the CoM of the system in the solar frame is Energy and momentum conservation require that in CoM frame, the magnitude of each particle’s momentum, and hence speed, are unchanged by the interaction. The remaining two parameters required to describe the outgoing system, namely the polar angles θ and φ through which the DM particle is scattered, are unconstrained, and thus governed by the probabilities of quantum mechanics. The angle θcorresponds to the angle between the incoming and outgoing DM velocity vectors, and is thus referred to as the centre-of-mass scattering angle. The probability distribution for this angle is dictated by the form of the DM-nucleus interaction. The azimuthal angle φ is arbitrary, depending on neither the form of the interaction nor the kinematics. It therefore follows a uniform distribution. To describe a collision in this CoM frame, we ﬁrst construct an orthonormal basis with unit vectors { ˆa, ˆa, ˆa}, taking ˆato be the unit vector in the direction of t. The outgoing velocity of the DM particle tin this frame is thus This is illustrated in Fig. 2. We draw values for θbased on the form of the diﬀerential cross section for a given interaction. In the case of velocity-dependent interactions, the distribution in cos θis simply uniform over the interval [−1, 1]. For q-dependent interactions, the diﬀerential Figure 2: A schematic of the collision in the Centre of Momentum (CoM) frame. The red arrows t and t red, θ scattering. , is the CoM scattering angle. It is deﬁned such that θ= 0 corresponds to forward cross-section can be expressed in terms of the CoM scattering angle via Eq. 3.3. We thus select θfrom a distribution proportional to (1 − cos θ). Once the outgoing velocity has been calculated in the CoM frame, we then transform it back to the lab frame by adding s (which remains constant during the collision). After each collision, we record the position of the DM particle and its outgoing velocity, and use them to determine its new trajectory. We also log the energy transferred to the nucleus, given by the diﬀerence between the DM kinetic energy immediately before and after the collision. We then repeat steps 2 – 4 until the particle has undergone a large number of interactions, typically between 10and 10. In addition to the data that we record at each collision point, we also log the position and velocity of the DM at regular time intervals over the course of the simulation, in order to allow us to construct stationary distributions of relevant properties of the DM If at any point in its trajectory a DM particle reaches the solar surface, it leaves the Sun. If the velocity on exit is less than the surface escape velocity, it does not escape to inﬁnity, but will return at some later time, to participate in further scattering events. Outside the Sun, the orbits of such particles become entirely Keplerian. We use the exit position and velocity of the DM particle to calculate the form of this trajectory, and by ﬁnding its intersection points with the boundary of the Sun, compute the position and velocity at which it will re-enter the Sun. We use the re-entry position and velocity to ﬁnd the new simple-harmonic trajectory of the DM particle, and then continue from Step 2 . We compute the time that the DM particle spends outside the Sun from the ratio of the area of its orbit swept out whilst absent to the total orbital area, and add it to the total simulation time. If the DM particle reaches the boundary of the Sun with a velocity exceeding the surface escape velocity, we terminate the simulation and begin a new one from Step 1 . This corresponds to an evaporation event. We observe a negligible number of such cases throughout our simulations. The luminosity transported by DM to a height r in the Sun is where ρ(r) is the total matter density, and (r) is the energy injected into the stellar plasma by DM scattering, per unit time and mass of solar material. The integrand dL corresponds to the total rate of energy transfer in a spherical shell centred at radius r. To estimate dL from E we compute where t by a single DM particle across the entire shell. The total luminosity at radius r can then be determined by simply extending the shell the entire way from the centre of the Sun to r. To map this result to the expected luminosity for an entire population of DM in the Sun, Eq. (3.18) must be multiplied by ηN and η = N In the latter parts of this paper, we will use the maximum value of the luminosity, i.e. absolute value here is because the luminosity is negative everywhere by convention. Explicitly, we take L luminosity. The standard error on a mean of some quantity x estimated from Monte Carlo simulation can be estimated as population. , the set of energy transfer values in collisions in our simulation, in a given radial bin is the total simulation time. This corresponds to the mean rate of energy transfer ≡ max|L(r)|, as a measure of the transport eﬃciency of a given DM model—the where N is the number of samples used to construct the mean. The standard error on our estimate of the luminosity is therefore where for the error on dL in a shell, the sum extends over all events in the radial bin, and for the error on L(r), over all events at radii less than r. In this section we present the main results of our Monte Carlo simulations. We will focus on two large sets of simulations: 1) an idealized setup identical to what was used by Gould & Raﬀelt, presented in Sec. 4.1, and 2) a realistic setup using realistic DM and nuclear masses, with temperature and density data from a Standard Solar Model, in Sec 4.2. In order to verify our Monte Carlo procedure, we initially study energy transport under the same conditions as Gould & Raﬀelt [10, 24]. Here, we model the star as a uniform sphere of constant density ρ = ρ conducting DM particles. The physical scales of this system follow a simple SI-based unit system, with m kg m above zero everywhere. We note that this, and our corresponding procedure to deal with DM particles leaving and re-entering the Sun, marks the only diﬀerence between our simulation and that produced of Gould & Raﬀelt, who did not any such radial boundary. The solar temperature proﬁle is taken to be a simple linear gradient of the form This is constructed such that r = 1 corresponds to the radius at which T = T (Spergel & Press) DM temperature for this system. Adopting such a simple model is advantageous for three reasons. First, it allows direct comparison to the results of the numerical simulations performed by Gould & Raﬀelt [24]; second, the simple temperature and density proﬁles mean that comparing with the analytical distributions outlined in Section 2.1 is particularly straightforward; and third, the large diﬀerence in length, density and gravitational scales between the idealized and realistic approaches will provide a strong test of the robustness of any heat conduction approximation scheme. To verify this setup, we ﬁrst “switch-oﬀ” the temperature gradient,and follow the evolution of DM in a sphere of nuclei at a uniform temperature T = 1 K. We note that in this speciﬁc situation, r path, which in this instance is constant throughout the Sun. . We take the radius of the Sun to be 2.5 m such that the Solar temperature remains Figure 3: Radial distribution of DM obtained at various Knudsen numbers, for velocityand momentum-independent interactions in a constant density sphere, with a uniform temperature of 1 K (left) and the linear temperature gradient deﬁned in Eq. (4.1) (right). This latter case is what we denote the idealized set-up. The analytic LTE and isothermal proﬁles are shown as solid lines. The function 4πr The distribution obtained for three diﬀerent values of K using our Monte Carlo program is shown in the left hand panel of Fig. 3, demonstrating excellent agreement with the analytical form. As expected, we observe an identical distribution over a wide range of K values. We then turn to simulations in the idealized setup, with a constant density proﬁle and a linear temperature gradient identical to that used by Gould & Raﬀelt [24] as given in Eq. (4.1). For non-uniform temperature proﬁles, the DM radial distribution is dependent on K, with the K  1 and K  1 limits corresponding to the conduction and isothermal regimes respectively. We perform simulations at diﬀerent values of K by varying the interaction parameter σ = 0.1, transport is local and the conduction approximation should be expected to be fairly accurate. Since all of the scattering nuclei are identical in this model, the diﬀusion coeﬃcient α is independent of radius. The analytical expression for the number density (Eq. 2.13) thus simpliﬁes to As the temperature proﬁle applied in this situation is analytic, the integral in equation Eq. (4.3) can be evaluated to give a closed form expression for n As K increases, we observe a smooth transition from the local regime to the isothermal one. The Monte-Carlo distributions for a range of K between 0.1 and 10 are are shown in the right-hand panel of Fig. 3, where the red curve is the theoretically-expected LTE distribution (4.3), and the blue one is the isothermal distribution (2.4). Performing a least-squares ﬁt of α in Eq. (4.3) to the Monte Carlo radial distribution for K=0.1, we ﬁnd α = 2.316±0.005. This is in direct accordance with the value of 2.3190 computed analytically by Gould & Raﬀelt [10] for µ = 1. Figure 4: Radial distribution of DM with non-constant cross sections obtained from idealized simulations (uniform temperature gradient), for K = 0.2. Left: σ ∝ v The expected form of the distribution is shown as a solid line. Fig. 4 shows the distributions obtained for non-constant cross sections with K = 0.2, overlaid with the predicted LTE distribution (2.13) using the values of α computed in Ref. [35], and without the Knudsen-dependent correction f(K) (2.16) applied. The slight departure from the LTE prediction is similar in magnitude to the K = 0.2 constant case seen in the right hand panel of Fig. 3. We now turn to transported heat: Fig. 5 shows the radial luminosity L(r) and energy transport proﬁles for three diﬀerent momentum- and velocity- independent simulations in the idealized (linear temperature gradient) setup. These correspond to transport in the local regime (K = 0.1; blue line), Knudsen transition (K = 0.4; red line), and the non-local/Knudsen regime (K = 2; yellow line). As expected, transport is suppressed in both the LTE limit due to the short mean free path, and the Knudsen limit due to the low interaction rate. The lower K cases are noisier; this is because far more simulation steps are required to adequately sample the full stellar distribution, since l between collisions. Our results for velocity- and momentum-independent interactions are in agreement with Monte Carlo simulations performed by Gould & Raﬀelt [24]. Each red point in Fig. 6 is obtained from a separate simulation at that value of K and shows the maximum luminosity found over 100 radial bins. The solid red line is a cubic spline through the results. Figure 5: Left: Total energy transferred to the nuclei per unit time in 100 radial bins for momentum- and velocity-independent interactions at three diﬀerent Knudsen numbers K, in the idealized simulations. A negative energy corresponds to energy being absorbed by the DM, (removed from the plasma) and positive energy represents energy deposition. Right: luminosity L(r) carried by DM at each radius. Leftwards of the peak corresponds to the conduction regime (where errors are larger for the reasons pointed out above), whereas rightwards of the peak represents the Knudsen limit of non-local transport. We show the results of Gould & Raﬀelt [24], upon which this simulation is based, as black crosses on the same ﬁgure. In doing this, we have converted from the units used for mean-free-path by Gould & Raﬀelt to the Knudsen number. The Gould & Raﬀelt values of luminosity, originally presented in arbitrary units, have all been scaled by the same constant factor to match our normalisation. Radial distributions of luminosity L(r) for DM with velocity- and momentum-independent interactions are shown for three diﬀerent values of K in the left-hand panels of Fig. 7. Results from our Monte Carlo simulations are shown in green. The right-hand panel shows dL/dr, which is proportional to the transported energy per unit volume (2.15). Negative values of dL/dr correspond to heat being removed from the stellar material, whereas positive dL/dr corresponds to heat deposition. The three values of K roughly span the LTE regime (K = 0.2, top), near the Knudsen transition (K = 1, middle), and the Knudsen regime (K = 10, bottom). Dashed and dot-dashed curves in Fig. 7 represent the predicted heat transport under the two heat transport schemes described in Sec. 2.1. The isothermal (Spergel & Figure 6: The transition from the conduction regime to the Knudsen limit. Each red point corresponds to the peak of the radial luminosity L following ∼ 1 × 10 data set. The black points correspond to the results of an identical study by Gould & Raﬀelt [24], scaled to our units. Press; SP) scheme is shown in orange, whereas the LTE (GR) solution, including the f(K) and h(r) Knudsen and radial suppression factors (Eq. 2.16), is shown in magenta. We will return to the solid blue line, labeled “Calibrated SP”, in Sec. 5. Predictably, the GR solution fares well in the LTE regime, but despite the correction factors, tends to overestimate the peak luminosity into and above the Knudsen transition. The SP method, by comparison, is systematically too high by a factor of two in the Knudsen regime (as also noticed by Gould & Raﬀelt [24]), and deviates substantially from the direct simulation in the LTE regime, as conduction begins to scale with K rather than with K identify the radius r goes from being removed at smaller radii to being deposited at larger radii. Fig. 8 is similar to Fig. 7, except that it shows L(r) for K = 1 in every panel, for cross sections that scale as v show n = −1, 1 and 2. The derivatives dL/dr are shown as insets, in the same units as in the right-hand panels of Fig. 7. Predicted curves from each theoretical heat transport scheme are again shown, with each curve appropriately adapted to the diﬀerent cross section models following Eqs. (2.10–2.12) for SP, and using the results of Ref. [35] for GR. The SP behaviour is very similar to the constant case, overestimating transport by a factor of two in the Knudsen regime, and failing to account for local transport for K  1. Some of the GR curves match results relatively well (e.g. q explicit simulations, sometimes over or under-predicting the luminosity by several orders of Figure 7: Transported heat in the idealized simulation (simple harmonic oscillator potential, constant density and linear temperature gradient) for a constant elastic scattering cross section and m & Press [8], Gould & Raﬀelt [10, 25, 35]), as well as the ‘Calibrated SP’ method developed here. Green data points represent results of our Monte Carlo simulations. Cross sections and corresponding Knudsen numbers K are given for each of the three plotted cases. Figure 8: Transported heat in the idealized simulation (simple harmonic oscillator potential, constant density and linear temperature gradient) for elastic scattering cross sections that depend on v magnitude, and generally failing to accurately predict the location of r In order to understand the behaviour of DM energy transport in our simulations, it is instructive to consider the eﬀective DM temperature T where hE erage within each radial bin. Figure 9 shows T numbers K, for n = 0 (constant cross-section). At small K, as expected, the DM temperature closely follows that of the background nuclei, approaching local thermal equilibrium. Here, the DM interacts a suﬃcient number of times to thermalise before it diﬀuses to a region of diﬀerent temperature. As K is increased, the increase in inter-scattering distance causes the eﬀective DM temperature to deviate from that of the nuclei, tending towards a constant temperature corresponding to the statistically-averaged isothermal temperature T can be obtained by solving Eq. 2.9, and for this system, has a value of ∼ 1K. Fig. 9 provides some insight into the level of accuracy that we can expect from our conduction formalism. As K rises above ∼0.2, the average DM temperature departs noticeably from T (r), indicating a breakdown of the conditions behind the GR perturbative expansion of the BCE (2.1). As noted in Ref. [24], T asymptotes to an intermediate value at large K, indicating that the isothermal assumption is never strictly realized. This should not be too surprising, as the isothermal solution f(E) ∝ DF = 0 , whereas T the right-hand side of the BCE. To end this section, we show in Fig. 10 the maximum luminosity across all σ ∝ v models. We ﬁnd that they all show very similar behaviour with K, scaling proportionately to K in the LTE regime, and to K of a dipole-based perturbative solution to the BCE [35], the peak luminosities are very close to one another, suggesting that heat transport is limited by kinematics, and not by the form of the interaction cross section. We also ﬁnd that the Knudsen transition occurs at slightly diﬀerent values of K for each model. This could be because we chose to deﬁne K using the mean inter-scattering distance at r = 0, as velocity dependence introduces an implicit temperature (and therefore radial) dependence to l constant. We now turn to a more realistic setup for our Monte Carlo simulations. We study energy conduction in the Sun using the temperature proﬁle and chemical composition of the present-day AGSS09ph standard solar model [33]. tractable, we keep the simple harmonic oscillator (SHO) gravitational potential, rather than computing it self-consistently from the stellar density. We set the scale of the gravitational potential, ρ amounts to approximately 100 times the average solar density. Because of the high core i is the time-averaged DM kinetic energy, with angled brackets representing an avwith constant Tis the exact solution to the Collisionless Boltzmann Equation Figure 9: Eﬀective temperature T pendent interactions as a function of radius for diﬀerent Knudsen numbers in the idealized simulations. For low K, the DM approaches local thermal equilibrium with the nuclei. At large K, the DM tends towards the isothermal distribution assumed in the Spergel & Press formalism, but never actually reaches it. Figure 10: Maximum transported luminosity in the idealized simulations, with constant stellar density and m for constant dark matter-nucleon cross sections as well as those proportional to v luminosities predicted by the calibrated SP transport scheme (5.1). K . Data points with error bars are results of our simulations, and curves show maximum density, most of the DM in a real star will be localized very near the core. For DM masses greater than ∼ 10 GeV, both the SP and GR distributions predict that 99.9% of the DM is conﬁned below 0.1R luminosity using the true Solar potential is 12% higher, and peaks at 0.43 R 0.41 R DM masses, as the distribution more easily samples higher radii, where the two potentials begin to diﬀer. We will consider DM masses of 5 − 20 GeV. These are above the threshold for evaporation, which is about 4 GeV in the Sun, but should be larger for the potential that we consider here. Although our simulation is capable of dealing with evaporation events, we recorded none in the duration of the realistic study. We again consider scattering with a single isotope, which we model by assuming spin-dependent (SD) scattering (Eq. 3.5) on hydrogen only. In Fig. 11 we show the radial luminosity proﬁles (left) and dL/dr (right) for a selection of constant cross-section values. These range from conduction near the LTE limit (σ 5 × 10 into the Knudsen regime at a cross-section value near to the current experimental limit two theoretical heat transport schemes. The GR method does as well as the idealized setup, remaining within error bars in the LTE regime. In the Knudsen limit, GR overestimates the peak luminosity by only about 10–20%, but fares far worse at large radii, substantially overpredicting the eﬀect of DM heat transport outside the stellar core. In contrast, the SP method behaves much as in the idealized cases, overestimating the luminosity by a factor of ∼2 in the Knudsen limit, and becoming steadily more inaccurate as K decreases. However, the shape predicted by the SP formalism is in better general agreement with the results of the simulations than is the shape predicted by GR. Fig. 12 shows an example for each of the v 8), after being adapted to heat transport by more general nuclear scattering cross-sections the SP formalism provides a very good description of the shape of the luminosity and energy transport curves. The radially and Knudsen-corrected GR scheme fares even worse than in the constant case, underpredicting L(r) by several orders of magnitude for positive n, and overpredicting it for negative n. The maximum luminosity for each model is shown as a function of the reference cross section idealized case, the maximum luminosity achievable is independent of the interaction type. The Knudsen transition occurs at very diﬀerent values of σ of v scattering to K ∼ 1.7 for q section. We ﬁnally show some examples of heat transport with diﬀerent masses in Fig. 14, for the v (left) and q (bottom), the behaviour is largely similar to the m so far: at large K, the SP prediction is too large by about a factor of 2, but the radially and Knudsen-corrected GR prediction is too low by orders of magnitude. for the SHO potential. The two models deviate more from one another for lower cm, K = 0.12), through the transition (σ= 10cm, K = 0.65) and well = 10cm, K = 64 × 10). As in Figs. 7 and 8, we also include predictions from the in Fig. 13, where each data point corresponds to a single realistic simulation. As in the and q. In terms of Knudsen number, the peak locations range from K ∼ 0.1 for v Figure 11: Transported heat in the realistic solar model (simple harmonic oscillator potential, using SSM proﬁles for target density and temperature proﬁles), for a constant elastic scattering cross section, m commonly-used frameworks (Spergel & Press [8], Gould & Raﬀelt [10, 25, 35]), as well as the ‘Calibrated SP’ method developed here. Green data points represent results of our Monte Carlo simulations. Cross sections and corresponding Knudsen numbers K are given for each of the three plotted cases. Figure 12: Transported heat in the realistic solar model (simple harmonic oscillator potential, using SSM proﬁles for target density and temperature proﬁles) for elastic scattering cross sections that depend on v panels, as it overestimates conduction by an order of magnitude. = 10. Line styles are as in Fig. 11. The GR line has been removed from the top Figure 13: Maximum luminosity as a function of σ dependent interacting DM with m mated from Monte Carlo simulations and solid curves are luminosities computed with Eq. (5.1), where the value of K Figure 14: Transported heat in the realistic solar model (simple harmonic oscillator potential, using SSM proﬁles for target density and temperature proﬁles) for elastic scattering cross sections that depend on v Fig. 11. Top: m In the previous section, we examined the heat transported radially by interacting DM particles in two very diﬀerent setups: the idealized constant density sphere with a linear temperature gradient and a scale radius of similar order to the stellar radius, and the realistic case, using a reference SSM, but retaining a harmonic oscillator gravitational potential in order to allow trajectories to be parameterised analytically. In both setups, we found that although the GR scheme was fairly robust for constant cross sections, the shape of the L(r) curve was generally better described for all interaction types by the SP formalism. Based on the above observation, we propose a simple, phenomenologically-calibrated expression for the transported luminosity. This expression works reasonably well across all models (constant, q implement into stellar simulations thanks to the absence of numerical derivatives. We ﬁrst take the Spergel & Press luminosity L to obtain sensible results in the limit K  1. We then apply a modiﬁcation factor in order to obtain the correct scaling of the overall luminosity with K. The bare SP expression scales as L ∝ σ ∝ K instead require that the luminosity scales as L ∝ K. We therefore apply a further correction factor that multiplies the luminosity by K the isothermal behaviour is given by K empirically from our Monte Carlo simulations. The overall expression is then The values of K previously, the deviation from a Knudsen transition at the expected K ∼ 1/3 is likely due to the deﬁnition of K at the centre of the star, which is not necessarily representative of the full radial interaction rate. Predictions using this ‘calibrated SP’ parameterisation are shown with solid blue lines in Figs. 7, 8, 11, 12 and 14. As seen in these ﬁgures, this parameterisation provides a far more accurate prediction of the transported luminosity and deposited energy than either of the existing conduction schemes. It works well in both idealized and realistic setups, and across interaction types and masses. Figs. 10 and 13 respectively show the predicted maximum luminosities for the idealized and realistic setups, using Eq. (5.1) across a large range of K, for all the models that we have considered in this paper. Although this model does not capture the LTE limit all that well in idealized simulations, it provides an excellent description of L in the realistic simulations. We have developed a ﬁrst-principles Monte-Carlo program to investigate energy transport by gravitationally trapped dark matter in stars. We validated the technique for the case of constant DM-nucleus couplings, by comparing to both an earlier numerical study by Gould and Raﬀelt [10], and to analytical predictions for the limiting LTE and Knudsen regimes. The excellent agreement found in both cases provides strong support to our approach. We used our simulation program to provide the ﬁrst numerical study of energy transport by DM particles with non-constant couplings across all regimes of energy transport. We performed simulations in an idealized setup, following the simpliﬁed approach of Ref. [10] with a constant density and linear temperature gradient, and a realistic stellar proﬁle, using a simple harmonic oscillator potential, but with realistic target nuclei densities and temperatures. We compared our results with the predictions of the two existing standard schemes for heat transport: the Spergel & Press (SP) isothermal approximation, and the corrected Gould & Raﬀelt (GR) LTE scheme. Based on our simulations, we provided in Sec. 5 a recommendation for energy transport modelling in future work. We found that both GR and SP correctly predict the radius at which the luminosity carried by DM in stars peaks. In the Knudsen regime (large mean free path, K  1), SP systematically overestimates heat transport by a factor of two. This was also observed by Gould & Raﬀelt [24]; we have been unable to locate the source of this discrepancy in the derivation of the SP formalism, but our prescription builds in a simple factor of 1/2 in our correction factor in order to account for it. The GR diﬀusivity coeﬃcients α(µ) as computed in Ref. [10] and extended to include general interactions [35] accurately predict the radial DM distributions n constant cross sections. Unsurprisingly, GR does well in predicting the luminosity proﬁle in the LTE regime, for constant cross sections. However, when extended to v or q-dependent cross sections as done in Ref. [35], it proves unreliable. Conversely, SP is slightly better at predicting the shape of the energy injection function, especially at radii where heat is deposited, as GR slightly overpredicts the range of heat transport. By performing the collision operator integrals in the isothermal regime for non-constant cross sections in Sec. 2.1.1, and thus generalizing the luminosity computed in Ref. [8], we found that SP continues to robustly reproduce the shape of L(r) for non-constant cross-sections, over the full range of K that we have considered. A short comment on how these conclusions aﬀect previous results by Vincent et al. is in order. As we have shown, the q and v-dependent LTE computations of Ref. [35] implemented in [21– 23] do not correctly capture the magnitude of heat transport, underestimating it for positive n, and overestimating it for negative n. However, the location of the Knudsen peak remains unaﬀected—this can be readily seen via a direct comparison between Fig. 13 and Fig. 2 of Cross section K(idealized simulations) K(realistic simulations) [23]. This suggests that, for positive n, a larger amount of parameter space may be available to address the solar composition problem via transport by asymmetric spin-dependent DM than we previously thought. Conversely, v more quantitative statement will require detailed stellar evolution modeling. We suspect that breakdown of GR is heavily inﬂuenced by the Knudsen correction f(K) and the radial suppression h(r), which were introduced to parameterise the deviations observed in the simulations of Refs. [10, 24]. In particular, the GR approach relies on heat transport being purely dipolar, and the radial suppression attempts to compensate for the breakdown of this approximation near the stellar centre. The approximation also breaks down when transport becomes non-local at K > 1. Even if the majority of the Maxwell-Boltzmann distribution has a low Knudsen number, particles in the tail of the distribution can acquire a long mean free path if σ is proportional to v is by deﬁnition non-local, it is more robust to these considerations. We thus recommend a modiﬁed version of the SP heat transport scheme, given in Eq. (5.1). This ‘calibrated SP’ scheme includes the modiﬁcations for v 2.1.1, as well as a simple Knudsen correction that changes the scaling in the LTE regime and relies on a value of the Knudsen transition K values are tabulated in Tab. 2. The SP approach has the further advantage of being more stable when implemented in stellar evolution codes such as GARSTEC and MESA, due to the ease with which one can obtain analytical derivatives of (r); with GR, one must compute derivatives numerically. We leave a full comparison between the eﬀects of these schemes in such evolution codes for future work [60]. Simulations were performed on cx1 (Helen) at Imperial College London. HB is partially supported by STFC Consolidated HEP grants ST/P000681/1 and ST/T000694/1 and thanks other members of the Cambridge Pheno Working Group for helpful discussions. ACV is supported by the Arthur B. McDonald Canadian Astroparticle Physics Research Institute and NSERC, with equipment funded by the Canada Foundation for Innovation and the Province of Ontario, and housed at the Queen’s Centre for Advanced Computing. Research at Perimeter Institute is supported by the Government of Canada through the Department of Innovation, Science, and Economic Development, and by the Province of Ontario. PS is supported by the Australian Research Council (ARC) under grant FT190100814. Under the potential given by Eq. 3.6, the Cartesian components of the DM position vector independently undergo simple harmonic motion with an angular frequency Ω = Given an initial position and velocity, the DM position and velocity vectors at any later time t (i.e. prior to the next collision) can be expressed as and where the constants A and